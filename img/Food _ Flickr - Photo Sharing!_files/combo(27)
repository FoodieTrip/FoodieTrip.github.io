YUI.add("hermes-template-mobile-photo-page",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return"\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["global-nav-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["mobile-photo-well-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["mobile-photo-engagement-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["mobile-attribution-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["photo-sidebar-actions-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-title-desc-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["mobile-sub-photo-stats-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-comments-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["photo-charm-exif-scrappy-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["mobile-sub-photo-license-privacy-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["sub-photo-tags-tag-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+u((n.outlet||t&&t.outlet||o).call(s,t!=null?t["footer-full-view"]:t,{name:"outlet",hash:{},data:i}))+"\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-photo-page",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-attribution",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'	<a class="avatar person medium no-menu" data-person-nsid="'+f((s=(s=n.nsid||(t!=null?t.nsid:t))!=null?s:u,typeof s===a?s.call(o,{name:"nsid",hash:{},data:i}):s))+'" style="background-image: url('+f((s=(s=n.buddyicon||(t!=null?t.buddyicon:t))!=null?s:u,typeof s===a?s.call(o,{name:"buddyicon",hash:{},data:i}):s))+');" href="/photos/'+f((s=(s=n.pathAlias||(t!=null?t.pathAlias:t))!=null?s:u,typeof s===a?s.call(o,{name:"pathAlias",hash:{},data:i}):s))+'/"></a>\n'},3:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'	<div class="avatar person medium" data-person-nsid="'+f((s=(s=n.nsid||(t!=null?t.nsid:t))!=null?s:u,typeof s===a?s.call(o,{name:"nsid",hash:{},data:i}):s))+'" style="background-image: url('+f((s=(s=n.buddyicon||(t!=null?t.buddyicon:t))!=null?s:u,typeof s===a?s.call(o,{name:"buddyicon",hash:{},data:i}):s))+');"></div>\n'},5:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isPro:t,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:""},6:function(e,t,n,r,i){return'		<a href="/account/upgrade/pro" class="pro-badge-inline">PRO</a>\n'},8:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isPro:t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.noop,data:i}))!=null?s:""},9:function(e,t,n,r,i){return'			<a href="/account/upgrade/pro" class="pro-badge-inline">PRO</a>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return((s=n["if"].call(u,t!=null?t.noMenu:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+"\n"+((s=n.unless.call(u,t!=null?t.isAlbumView:t,{name:"unless",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n<div class="attribution-info">\n\n	<a href="/photos/'+l((o=(o=n.pathAlias||(t!=null?t.pathAlias:t))!=null?o:a,typeof o===f?o.call(u,{name:"pathAlias",hash:{},data:i}):o))+'/" class="owner-name truncate" title="'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{name:t!=null?t.displayname:t,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:i}))+'" data-track="attributionNameClick">'+l((o=(o=n.displayname||(t!=null?t.displayname:t))!=null?o:a,typeof o===f?o.call(u,{name:"displayname",hash:{},data:i}):o))+'</a>\n	<a href="/photos/'+l((o=(o=n.pathAlias||(t!=null?t.pathAlias:t))!=null?o:a,typeof o===f?o.call(u,{name:"pathAlias",hash:{},data:i}):o))+'/" class="owner-name-with-by truncate" title="'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{name:t!=null?t.displayname:t,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:i}))+'" data-track="attributionNameClick">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{user:t!=null?t.displayname:t,intlName:"attribution.BY_USER"},data:i}))+"</a>\n\n	"+l((n.outlet||t&&t.outlet||a).call(u,t!=null?t["follow-view"]:t,{name:"outlet",hash:{},data:i}))+"\n\n"+((s=n["if"].call(u,t!=null?t.isAlbumView:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n</div>\n"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/attribution",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-follow",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showNoButton:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(4,i,0),data:i}))!=null?s:""},2:function(e,t,n,r,i){return""},4:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showUnblockButton:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.program(7,i,0),data:i}))!=null?s:""},5:function(e,t,n,r,i){return"			<button class='follow alt'>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.UNBLOCK"},data:i}))+"</button>\n"},7:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showFollowingButton:t,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(10,i,0),data:i}))!=null?s:""},8:function(e,t,n,r,i){return'				<button class="follow is-following mini"><span class="drop-icon">\u25be</span></button>\n'},10:function(e,t,n,r,i){return'				<button class="follow mini"></button>\n'},12:function(e,t,n,r,i){var s,o=t!=null?t:{};return((s=n["if"].call(o,t!=null?t.isFluid:t,{name:"if",hash:{},fn:e.program(13,i,0),inverse:e.program(23,i,0),data:i}))!=null?s:"")+"	"+((s=n["if"].call(o,t!=null?t.curationEnrollmentStatus:t,{name:"if",hash:{},fn:e.program(30,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},13:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showNoButton:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(14,i,0),data:i}))!=null?s:""},14:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showUnblockButton:t,{name:"if",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:""},15:function(e,t,n,r,i){return"				<button class='follow alt'>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.UNBLOCK"},data:i}))+"</button>\n"},17:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showFollowingButton:t,{name:"if",hash:{},fn:e.program(18,i,0),inverse:e.program(21,i,0),data:i}))!=null?s:""},18:function(e,t,n,r,i){var s,o=t!=null?t:{};return'					<button class="follow is-following '+((s=n["if"].call(o,t!=null?t.isOnDark:t,{name:"if",hash:{},fn:e.program(19,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:t!=null?t.followingIntlKey:t},data:i}))+'<span class="drop-icon">\u25be</span></button>\n'},19:function(e,t,n,r,i){return"white"},21:function(e,t,n,r,i){var s,o=t!=null?t:{};return'					<button class="follow '+((s=n["if"].call(o,t!=null?t.isOnDark:t,{name:"if",hash:{},fn:e.program(19,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(o,{name:"intlMessage",hash:{intlName:t!=null?t.followIntlKey:t},data:i}))+"</button>\n"},23:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showNoButton:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(24,i,0),data:i}))!=null?s:""},24:function(e,t,n,r,i){var s;return'			<span class="relationship">\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.showUnblockButton:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(25,i,0),data:i}))!=null?s:"")+"			</span>\n"},25:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.showFollowingButton:t,{name:"if",hash:{},fn:e.program(26,i,0),inverse:e.program(28,i,0),data:i}))!=null?s:""},26:function(e,t,n,r,i){return"						<button class='unfluid follow is-following ui-button ui-button-icon ui-button-transparent ui-button-dropdown'><span>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.FOLLOWING"},data:i}))+"</span></button>\n"},28:function(e,t,n,r,i){return"						<button class='unfluid follow ui-button ui-button-icon'><span>"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.FOLLOW"},data:i}))+"</span></button>\n"},30:function(e,t,n,r,i){var s;return"<h3 class='curation-enrollment-status'>["+e.escapeExpression((s=(s=n.curationEnrollmentStatus||(t!=null?t.curationEnrollmentStatus:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"curationEnrollmentStatus",hash:{},data:i}):s))+"]</h3>"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.isOnMobile:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(12,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/follow",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-following-dropdown",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return'			<label class = "checked">\n				<input type="checkbox" checked="checked" id="friend-checkbox" />\n'},3:function(e,t,n,r,i){return'			<label>\n				<input type="checkbox" id="friend-checkbox" />\n'},5:function(e,t,n,r,i){return'			<label class="checked">\n				<input type="checkbox" checked="checked" id="family-checkbox" />\n'},7:function(e,t,n,r,i){return'			<label>\n				<input type="checkbox" id="family-checkbox" />\n'},9:function(e,t,n,r,i){return'			<button class="follow unfollow">'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.UNFOLLOW"},data:i}))+"</button>\n"},11:function(e,t,n,r,i){return'			<a href="#"><i class="ui-icon-tiny-unfollow"></i> '+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.UNFOLLOW"},data:i}))+"</a>\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'<ul>\n	<li class="following-friend">\n'+((s=n["if"].call(o,t!=null?t.isFriend:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+"			"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.FRIEND"},data:i}))+'\n		</label>\n	</li>\n	<li class="following-family">\n'+((s=n["if"].call(o,t!=null?t.isFamily:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.program(7,i,0),data:i}))!=null?s:"")+"			"+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"common.FAMILY"},data:i}))+'\n		</label>\n	</li>\n	<li class="divider"></li>\n	<li class="following-unfollow">\n'+((s=n["if"].call(o,t!=null?t.isFluid:t,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.program(11,i,0),data:i}))!=null?s:"")+"	</li>\n</ul>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/following-dropdown",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("relationship-menu-view",function(e,t){var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.disableRefreshOnRelationshipChange=e.disableRefreshOnRelationshipChange,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var e=this,t=e.nsid||{pathAlias:e.pathAlias};return e.appContext.getModel("person-relationship-models",t).then(function(t){e.relationship=t,e.nsid=e.nsid||t.id})},buildContainer:function(){return this.setContainerWithTemplate("following-dropdown",{isFriend:this.relationship.getValue("isFriend"),isFamily:this.relationship.getValue("isFamily"),isFluid:!0}),this},activate:function(){var e=this.get("container"),t=this;return this.registerEventHandler(this.relationship.on("valuesChanged",function(){t.buildContainer()})),this.registerEventHandler(e.delegate("click",function(e){t.handleUnfollowClick(e)},".following-unfollow")),this.registerEventHandler(e.delegate("change",function(e){t.handleFriendChange(e)},".following-friend input")),this.registerEventHandler(e.delegate("change",function(e){t.handleFamilyChange(e)},".following-family input")),this},handleUnfollowClick:function(t){var r=this;t.preventDefault(),this.relationship.getValue("isContact")&&(this.relationship.registry.toggleFollowing(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then(function(){r.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){r.relationship.setValue("isContact",!0),r.buildContainer(),n.error({err:e})}),e.rapidTracker.beacon(this.name,"unfollowButtonClick"),this.fire("onUnfollow"))},handleFriendChange:function(t){var r=this;this.relationship.registry.toggleFriend(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then(function(){r.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){r.relationship.registry.toggleFriend(r.nsid),r.buildContainer(),r.onError(r.intlMessage({intlName:"person.RELATIONSHIP_FRIEND_ERROR"})),n.error({err:e})})},handleFamilyChange:function(t){var r=this;this.relationship.registry.toggleFamily(this.nsid),this.relationship.registry.remoteUpdate(this.nsid).then(function(){r.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){r.relationship.registry.toggleFamily(r.nsid),r.buildContainer(),r.onError(r.intlMessage({intlName:"person.RELATIONSHIP_FAMILY_ERROR"})),n.error({err:e})})}})},"@VERSION@",{requires:["promise","fluid-css","hermes-template-following-dropdown","relationship-menu-css"],langBundles:["common","person"]});
YUI.add("follow-view",function(e,t){var n=require("lib/flog")(t);e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.set("isActiveViewAgnostic",e.isActiveViewAgnostic),this.nsid=e.nsid,this.pathAlias=e.pathAlias,this.realFullscreen=!!e.realFullscreen,this.isFluid=e.isFluid,this.isOnDark=e.isOnDark,this.disableRefreshOnRelationshipChange=e.disableRefreshOnRelationshipChange,this.isOnMobile=e.isOnMobile,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.appContext.flipper.isFlipped("enable-signed-out-cta-test")&&(this.signedOutTest=!0),this},loadState:function(){var e=this,t=e.nsid||{pathAlias:e.pathAlias};return e.appContext.getModel("person-relationship-models",t).then(function(t){e.set("relationship",t),e.nsid=e.nsid||t.id})},buildContainer:function(){var e=this.get("relationship");return this.setContainerWithTemplate("follow",{showNoButton:e.getValue("isMe")||e.getValue("isIgnoredBy"),showUnblockButton:e.getValue("isIgnored"),showFollowingButton:e.getValue("isContact"),signedIn:this.appContext.getViewer().signedIn,isFluid:this.isFluid,isOnMobile:this.isOnMobile,isOnDark:this.isOnDark,followIntlKey:"common.FOLLOW",followingIntlKey:"common.FOLLOWING"}),this},activate:function(){var t=this,r=this.get("container"),i=this.get("relationship"),s,o;return this.isFluid&&!i.getValue("isMe")?this.registerEventHandler(r.delegate("click",function(r){e.rapidTracker.beacon(this.name,"followButtonClick"),s=r.target.hasClass("follow")?r.target:r.target.ancestor(".follow"),t.appContext.getViewer().signedIn?i.getValue("isIgnored")?(i.registry.toggleIgnore(t.nsid),t.disableRefreshOnRelationshipChange?t.buildContainer():t.showBalls(),i.registry.remoteUpdate(t.nsid).then(function(){t.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){i.setValue("isIgnored",!0),t.buildContainer(),n.error({err:e})})):i.getValue("isContact")?(s.addClass("is-open"),o&&o.destroy(),o=new e.Views.FluidDroparound({appContext:t.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,width:140,height:130,observePageResize:!0,anchorOffsetHorizontal:6,anchorElement:s.one(".drop-icon"),subview:new e.Views["relationship-menu-view"]({nsid:t.nsid,pathAlias:t.pathAlias,disableRefreshOnRelationshipChange:t.disableRefreshOnRelationshipChange}),preferLeft:!0}),o.on("closeDroparound",function(){s.removeClass("is-open"),t.fire("subviewViewEvent","isClosed")}),o.show(),t.fire("subviewViewEvent","isOpen"),o.get("subview").on("onUnfollow",function(){o.close(),o.destroy(),t.disableRefreshOnRelationshipChange?t.buildContainer():t.showBalls()})):t.followPerson():t.signInAndRedirectToPerson()},"button.follow")):(r&&r.one("button")&&this.registerEventHandler(r.one("button").on("click",t.handleRelationshipClick,t)),this.get("relationship").getValue("isMe")||this.setupDropdown()),t},followPerson:function(){var t=this,r=this.get("relationship");r.getValue("isContact")||(r.registry.toggleFollowing(this.nsid),t.disableRefreshOnRelationshipChange?this.buildContainer():this.showBalls(),r.registry.remoteUpdate(this.nsid).then(function(){t.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){t.hideBalls(),r.setValue("isContact",!1),t.buildContainer(),n.error({err:e})}))},showBalls:function(){this.balls||(this.balls=e.Node.create(this.templates("flickr-balls")({}))),this.get("container").append(this.balls),this.balls.show(),this.get("container").one(".follow").hide()},hideBalls:function(){this.balls&&(this.balls.remove(),this.get("container").one(".follow").show())},handleRelationshipClick:function(t){var n=this;t.preventDefault(),e.rapidTracker.beacon(this.name,"followButtonClick");var r=this.get("relationship").getValue("isContact");this.appContext.getViewer().signedIn?r===!1?(this.followPerson(),e.rapidTracker.beacon(this.name,"photoAttributionFollowButtonClick")):n.isOnMobile?n.handleUnfollowClick(t):(n.relationshipDropDownDialog.toggle(),e.rapidTracker.beacon(this.name,"photoAttributionFollowMenuClick")):n.isOnMobile?e.use("mobile-actions-helper",function(e){e.MobileActionsHelper.redirectToAppOrStore({os:n.appContext.getUA().os,isWebview:n.appContext.getUA().isWebview,pageURL:"/photos/"+n.nsid,beacon:{name:"mpp_follow_signedout",section:"attribution-view"},viewName:n.name})}):n.signInAndRedirectToPerson()},handleFriendChange:function(t){var r=this;this.get("relationship").registry.toggleFriend(this.nsid),r.disableRefreshOnRelationshipChange||this.showBalls(),this.get("relationship").registry.remoteUpdate(this.nsid).then(function(){r.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){this.hideBalls(),this.get("relationship").registry.toggleFriend(this.nsid),t.target.set("checked",!t.target.get("checked")),this.onError(this.intlMessage({intlName:"person.RELATIONSHIP_FRIEND_ERROR"})),n.error({err:e})}.bind(this)),t.target.get("checked")?t.target.ancestor().addClass("checked"):t.target.ancestor().removeClass("checked")},handleFamilyChange:function(t){var r=this;this.get("relationship").registry.toggleFamily(this.nsid),r.disableRefreshOnRelationshipChange||this.showBalls(),this.get("relationship").registry.remoteUpdate(this.nsid).then(function(){r.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){this.hideBalls(),this.get("relationship").registry.toggleFamily(this.nsid),t.target.set("checked",!t.target.get("checked")),this.onError(this.intlMessage({intlName:"person.RELATIONSHIP_FAMILY_ERROR"})),n.error({err:e})}.bind(this)),t.target.get("checked")?t.target.ancestor().addClass("checked"):t.target.ancestor().removeClass("checked")},handleUnfollowClick:function(t){var r=this;t.preventDefault(),this.get("relationship").registry.toggleFollowing(this.nsid),r.disableRefreshOnRelationshipChange||this.showBalls(),this.isOnMobile||this.relationshipDropDownDialog.toggle(function(){this.toggleFollowingButton(t.target
.ancestor(".relationship").one("button"),this.get("relationship").getValue("isContact"))}.bind(this)),this.get("relationship").registry.remoteUpdate(this.nsid).then(function(){r.disableRefreshOnRelationshipChange||(e.config.win.location=e.config.win.location)},function(e){this.hideBalls(),this.get("relationship").setValue("isContact",!0),this.toggleFollowingButton(t.target.ancestor("button"),!0),n.error({err:e})}.bind(this)),e.rapidTracker.beacon(this.name,"photoAttributionUnfollowButtonClick")},toggleFollowingButton:function(e,t){t?(e.setContent("<span>"+this.intlMessage({intlName:"common.FOLLOWING"})+"</span>"),e.addClass("follow-anim").addClass("is-following"),setTimeout(function(){e.removeClass("follow-anim")},500),e.addClass("ui-button-dropdown")):(e.addClass("unfollow-anim").removeClass("is-following"),setTimeout(function(){e.removeClass("unfollow-anim")},500),e.one("span").setContent(this.intlMessage({intlName:"common.FOLLOW"})),e.removeClass("ui-button-dropdown"))},onError:function(t){var n=new e.Views.FluidModal({appContext:this.appContext,title:this.intlMessage({intlName:"common.ERROR"}),message:t,actionButtonLabel:this.intlMessage({intlName:"common.OK"}),showCancelButton:!1});n.show()},setupDropdown:function(){var t=this,n=t.get("container"),r,i=n.one(".relationship"),s,o=n.one(".relationship button");if(!i)return;s=this.templates("following-dropdown")({isFriend:this.get("relationship").getValue("isFriend"),isFamily:this.get("relationship").getValue("isFamily")}),this.relationshipDropDownDialog=e.Views.dialog.getNewInstance("dialog-tooltip",{content:s,anchorTo:n.one(".relationship"),positioning:!1,parent:this}),this.registerEventHandler(this.relationshipDropDownDialog.on("hide",function(e){o.removeClass("is-open")})),this.registerEventHandler(this.relationshipDropDownDialog.on("show",function(e){o.addClass("is-open")})),this.relationshipDropDownDialog.render(),r=this.relationshipDropDownDialog.get("container"),r.detach("click"),this.registerEventHandler(r.one(".following-unfollow").on("click",this.handleUnfollowClick,this)),this.registerEventHandler(r.one(".following-friend input").on("change",this.handleFriendChange,this)),this.registerEventHandler(r.one(".following-family input").on("change",this.handleFamilyChange,this))},showSignUpModal:function(){var t=this;this.appContext.getModel("person-models",this.nsid).then(function(n){var r=t.pathAlias?e.url("/photos/")+t.pathAlias:e.url("/photos/")+t.nsid,i=t.intlMessage({intlName:"person.JOIN_FLICKR_AND_FOLLOW",person:n.getValue("displayname")}),s=n.getValue("buddyicon"),o;s.displayUrl=s.retina||s.large||s.medium||s.default,o=new e.Views.SignUpModal({appContext:t.appContext,signUpHeaderClass:"avatar person large no-menu no-edit",signUpHeaderImage:s.displayUrl,signUpTitle:t.intlMessage({intlName:"person.SIGN_IN_BEFORE_FOLLOW_TITLE"}),signUpMessage:i,beaconPrefix:"follow"}),o.on("signUpClick",function(n){e.SigninHelper.signUpPendingFollow({id:t.nsid},{postLoginUrl:r})}),o.on("signInClick",function(n){e.SigninHelper.addPendingFollow({id:t.nsid},{postLoginUrl:r})}),o.show()})},signInAndRedirectToPerson:function(){var t=this,n=t.pathAlias?e.url("/photos/")+t.pathAlias:e.url("/photos/")+t.nsid,r=t.intlMessage({intlName:"person.SIGN_IN_BEFORE_FOLLOW_MESSAGE"}),i=t.intlMessage({intlName:"person.SIGN_IN_AND_FOLLOW"}),s=t.intlMessage({intlName:"common.CANCEL"}),o;if(this.signedOutTest)return this.showSignUpModal();o=new e.Views.FluidModal({appContext:t.appContext,title:t.intlMessage({intlName:"person.SIGN_IN_BEFORE_FOLLOW_TITLE"}),htmlMessage:r,actionButtonLabel:i,cancelButtonLabel:s}),o.on("actionClick",function(){e.rapidTracker.beacon(t.name,"followModalSigninClick"),e.SigninHelper.addPendingFollow({id:t.nsid},{postLoginUrl:n})}),o.on("cancelClick",function(n){e.rapidTracker.beacon(t.name,"followModalCancelClick")}),o.show()}})},"@VERSION@",{requires:["flickr-view","hermes-template-follow","follow-css","promise","fluid-droparound-view","fluid-modal-view","signup-modal-view","dialog","hermes-template-following-dropdown","hermes-template-flickr-balls","fluid-balls-css","relationship-menu-view","signin-helper"],optional:["person-models","person-relationship-models"],langBundles:["common","person"]});
YUI.add("attribution-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return this.hideFollowView}}},initializer:function(e){return this.nsid=e.nsid,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.realFullscreen=!!e.realFullscreen,this.hideFollowView=e.hideFollowView?e.hideFollowView:!1,this.isAlbumView=e.isAlbumView,this},loadState:function(){var t=this;return e.Promise.all([t.appContext.getModel("person-models",t.nsid)]).then(function(e){t.set("owner",e[0])})},buildContainer:function(){var e=this.get("owner"),t=this.get("container"),n=e.getValue("pathAlias")||e.getValue("nsid"),r,i=this;return this.albumPhotoListLayoutStyle==="justified"&&t.addClass("justified-album-details-page"),r=e.getValue("buddyicon").large?e.getValue("buddyicon").large:e.getValue("buddyicon")["default"],this.setContainerWithTemplate("attribution",{isPro:i.appContext.flipper.isFlipped("enable-pro-badge")?e.getValue("isPro"):!1,pathAlias:n,buddyicon:r,nsid:e.getValue("nsid"),displayname:e.getValue("displayname"),realFullscreenEnabled:this.realFullscreen&&this.appContext.experiments.fullscreen.getMode(),isAlbumView:this.isAlbumView}),this},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","hermes-template-attribution","photo-attribution-css","promise","follow-view"],optional:["person-models"],langBundles:["attribution"]});
YUI.add("hermes-template-mobile-photo-well",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'	<a class="main-image-wrapper" href="'+l((o=(o=n.videoURL||(t!=null?t.videoURL:t))!=null?o:a,typeof o===f?o.call(u,{name:"videoURL",hash:{},data:i}):o))+'" '+((s=n["if"].call(u,t!=null?t.isServer:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n		<div class="play-wrapper">\n			<svg class="icon icon-play"><use xlink:href="#icon-play"></use></svg>\n		</div>\n\n		<img class="main-image" style="'+((s=n["if"].call(u,t!=null?t.isServer:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+" max-width: 100%; max-height: "+l((o=(o=n.maxHeight||(t!=null?t.maxHeight:t))!=null?o:a,typeof o===f?o.call(u,{name:"maxHeight",hash:{},data:i}):o))+'px;" src="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" onload="registerFirstPhoto(this)" />\n	</a>\n'},2:function(e,t,n,r,i){var s;return' style="max-height: '+e.escapeExpression((s=(s=n.loadHeight||(t!=null?t.loadHeight:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"loadHeight",hash:{},data:i}):s))+'px;"'},4:function(e,t,n,r,i){return"width: 100%; "},6:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'	<div class="main-image-wrapper" '+((s=n["if"].call(u,t!=null?t.isServer:t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n		<img class="main-image img" style="'+((s=n["if"].call(u,t!=null?t.isServer:t,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+' max-width: 100%;" src="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" onload="registerFirstPhoto(this)"/>\n	</div>\n	<div class="main-image-wrapper-underlay"></div>\n	<script>\n	var windowWidth = window.innerWidth;\n	var aspect = '+l((o=(o=n.loadAspect||(t!=null?t.loadAspect:t))!=null?o:a,typeof o===f?o.call(u,{name:"loadAspect",hash:{},data:i}):o))+";\n\n	if (aspect) {\n		document.getElementsByClassName('main-image')[0].style.height = (windowWidth * aspect) + 'px';\n	}\n	</script>\n"},7:function(e,t,n,r,i){var s;return'style="max-height: '+e.escapeExpression((s=(s=n.loadHeight||(t!=null?t.loadHeight:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"loadHeight",hash:{},data:i}):s))+'px;"'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return'\n<a class="loading hide-nav-link prev-photo photo-link" href="#">\n	<div class="arrow-overlay arrow-left">\n		<svg class="tiny icon icon-nav_left prev-photo-icon"><use xlink:href="#icon-nav_left"></use></svg>\n	</div>\n</a>\n\n'+((s=n["if"].call(t!=null?t:{},t!=null?t.isVideo:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(6,i,0),data:i}))!=null?s:"")+'\n\n<a class="loading hide-nav-link next-photo photo-link" href="#">\n	<div class="arrow-overlay arrow-right">\n		<svg class="tiny icon icon-nav_right next-photo-icon"><use xlink:href="#icon-nav_right"></use></svg>\n	</div>\n</a>\n'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-photo-well",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("matrix-math",function(e){e.MatrixMath={iterate:function(t,n,r,i){var s=[],o=t.length,u=t[0].length,a,f;for(a=0;a<o;a++){s[a]=[];if(u)for(f=0;f<u;f++)e.Lang.isArray(n)?s[a][f]=r.call(i,t[a][f],n[a][f]):s[a][f]=r.call(i,t[a][f],n);else e.Lang.isArray(n)?s[a]=r.call(i,t[a],n[a]):s[a]=r.call(i,t[a],n)}return s},add:function(e,t){return this.iterate(e,t,function(e,t){return e+t},this)},subtract:function(e,t){return this.iterate(e,t,function(e,t){return e-t},this)},divide:function(e,t){return this.iterate(e,t,function(e,t){return e/t})},multiply:function(e,t){return this.iterate(e,t,function(e,t){return e*t})},realMultiply:function(e,t){var n=[],r=e.length,i=e[0].length,s,o,u;for(s=0;s<r;s++){n[s]=[];for(o=0;o<i;o++)for(u=0;u<i;u++)n[s][o]+=e[s][u]*t[s][o]}return n},equality:function(e,t){var n=!0;if(e.length!==t.length)return!1;try{this.iterate(e,t,function(e,t){if(e!==t)return n=!1,0})}catch(r){n=!1}return n}}},"@VERSION@",{requires:[],optional:[]});
YUI.add("mrpinchy",function(e){function r(e){var t=e.length,n=0,r=0,i=0;for(i=0;i<t;i++)r+=e[i].pageY,n+=e[i].pageX;return[n/t,r/t]}function i(i){function _(t){E++,T&&T.cancel(),Date.now()-x>180?(E=1,T=e.later(200,this,function(){L.fire("mrpinchy:singletap",t)})):E===2&&(D(),E=0,L.fire("mrpinchy:doubletap"),L.fire("mrpinchy:reset")),x=Date.now()}function D(){s&&(s.setStyles({"-webkit-transition":"-webkit-"+O,"-moz-transition":"-moz-"+O,"-o-transition":"-o-"+O,"-ms-transition":"-ms-"+O,transition:O}),V([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,1,1]],!0),s.setStyle("transform",M)),y=1,d=1}function H(e,t){var n=X(),r;t?r=e:r=y*e,n[0][0]=r,n[1][1]=r,V(n,!0),d=r}function B(e,t,r){var i,s,a,f,l,p,v,m=y*e;i=R(),s=[t[0]-i[0],t[1]-i[1]],a=[c,h],f=n.multiply(a,d),l=n.multiply(a,m),p=n.subtract(l,f),v=n.multiply(n.divide(s,l),p),U([v[0],-v[1]],!0),H(e);if(m>o&&!C||m<u&&!C)C={scale:e,translate:[X()[3][0],X()[3][1]]}}function j(e){if(e.touches&&e.touches.length>1){var t=Math.abs(e.touches[0].pageX-e.touches[1].pageX),n=Math.abs(e.touches[0].pageY-e.touches[1].pageY),r=Math.sqrt(t*t+n*n)/S;return r}return 1}function F(e){if(e.touches.length===2){m||L.fire("mrpinchy:startpinch"),m=1;var t=e.scale;t||(t=j(e)),B(t,r(e.touches))}}function I(e){var t,r,i,s,o,u={top:0,right:0,bottom:0,left:0},a={top:0,right:0,bottom:0,left:0};if(!v)return;var f=g[0]-v[0],l=g[1]-v[1];N&&(t=R(),i=[c,h],r=n.multiply(i,d),s=n.add(t,r),o=n.divide(r,2),o=n.add(o,t),t[1]<N[0][1]&&(a.top=1),t[0]<N[0][0]&&(a.left=1),s[0]>N[1][0]&&(a.right=1),s[1]>N[1][1]&&(a.bottom=1));var m=X();if(a.left||a.right||!N){var y=parseInt(m[3][0],10)+Math.round(f);y&&(m[3][0]=y)}if(a.bottom||a.top||!N)m[3][1]=parseInt(m[3][1],10)+Math.round(l);V(m),v=g,k=null,t[1]>N[0][1]&&a.bottom&&(u.bottom=1),s[1]<N[1][1]&&a.top&&(u.top=1),t[0]>N[0][0]&&a.right&&(u.right=1),s[0]<N[1][0]&&a.left&&(u.left=1),u.bottom&&u.right?k=n.subtract(N[0],p):u.bottom&&u.left?k=n.subtract([N[1][0],N[0][1]],[Math.round((p[0]+c)*d),p[1]]):u.top&&u.right?k=[N[0][0]-p[0],N[1][1]-(p[1]+r[1])]:u.top&&u.left?k=[N[1][0]-(p[0]+r[0]),N[1][1]-(p[1]+r[1])]:u.right?k=[N[0][0]-p[0],parseInt(m[3][1],10)+Math.round(l)]:u.left?k=[Math.round(N[1][0]-p[0]-r[0]),parseInt(m[3][1],10)+Math.round(l)]:u.bottom?k=[parseInt(m[3][0],10)+Math.round(f),Math.round(N[0][1]-p[1])]:u.top&&(k=[parseInt(m[3][0],10)+Math.round(f),N[1][1]-(p[1]+r[1])])}function q(e){w||(e.preventDefault(),P[e.type](e))}function R(){return s.getXY()}function U(e,t){var n=X();t?(n[3][0]-=e[0],n[3][1]+=e[1]):(n[3][0]=e[0],n[3][1]=e[1]),V(n)}function z(){var e=X(),t=[];t.push([e[0][0],e[0][1]]),t.push([e[1][0],e[1][1]]),t.push([e[3][0],e[3][1]]),s&&s.setStyle("transform","matrix( "+t.join(",")+")")}function W(){var e=X();V(e)}function X(){var e,n=[],r=[],i;if(a)return a;i=s.getStyle("transform");if(!i.match(t))return V([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,1,1]],!0),a;e=i.match(t)[1],r=e.replace(/\s/g,"").split(",");var o=0,u;for(var f=0;f<4;f++){u=[];for(var l=0;l<4;l++)u.push(r[o++]);n.push(u)}return a=n,n}function V(e,t){if(!e)return;if(e.length!==4)return;a=e,t&&$()}function $(){var e=a;e&&s&&s.setStyle("transform","matrix3d("+e.join(",")+")")}function J(){return q}function K(){s=null,w=!0}var s=i.node,o=i.maxScale||10,u=i.minScale||.5,a,f,l=s.one(".img"),c=l.get("offsetWidth"),h=l.get("offsetHeight"),p=l.getXY(),d=1,v=[0,0],m=0,g=[0,0],y=1,b=0,w=!1,E=0,S,x=0,T,N,C,k,L=new e.EventTarget,A,O="transform 0.25s ease-out",M=s.getStyle("transform");i.boundingBox?N=i.boundingBox:N=[[0,0],[window.innerWidth,window.innerHeight]],s&&s.setStyles({"-webkit-transform-origin":"0 0","-moz-transform-origin":"0 0","-o-transform-origin":"0 0","-ms-transform-origin":"0 0","transform-origin":"0 0"}),A=s,s&&s.on("webkitTransitionEnd",function(){A.setStyles({"-webkit-transition":"","-moz-transition":"","-o-transition":"","-ms-transition":"",transition:""})});var P={touchstart:function(e){W(),g=r(e.touches),v=g,f=g,e.touches.length===1?b=Date.now():b=0;if(e.touches.length===2){var t=Math.abs(e.touches[0].pageX-e.touches[1].pageX),n=Math.abs(e.touches[0].pageY-e.touches[1].pageY);S=Math.sqrt(t*t+n*n)}},touchmove:function(e){g=r(e.touches),!m&&e.touches.length===1?d!==1&&I(e):e.touches.length===2&&(b=0,F(e)),$()},touchend:function(e){e.touches.length<1&&d!==1?(y=d,b?(Date.now()-b<100&&(_(e),b=0),b=0,k&&(s.setStyles({"-webkit-transition":"-webkit-"+O,"-moz-transition":"-moz-"+O,"-o-transition":"-o-"+O,"-ms-transition":"-ms-"+O,transition:O}),U(k),$(),k=null),L.fire("mrpinchy:endmove")):y>o?(H(o,!0),U(C.translate),d=o,y=o,s.setStyles({"-webkit-transition":"-webkit-"+O,"-moz-transition":"-moz-"+O,"-o-transition":"-o-"+O,"-ms-transition":"-ms-"+O,transition:O}),$(),C=null):y<u&&(H(u,!0),U([0,0]),d=u,y=u,s.setStyles({"-webkit-transition":"-webkit-"+O,"-moz-transition":"-moz-"+O,"-o-transition":"-o-"+O,"-ms-transition":"-ms-"+O,transition:O}),$(),L.fire("mrpinchy:reset",y),D(),C=null),L.fire("mrpinchy:endpinch",y),m=0,z()):d===1&&L.fire("mrpinchy:endpinch",1)}};return L.getTouchHandler=J,L.destroy=K,L.updateBoundingBox=function(e){N=e},L.updateImageSize=function(){c=l.get("offsetWidth"),h=l.get("offsetHeight")},L.resetTransform=function(){D()},L}var t=/matrix3d\(([^\)]+)\)/,n=e.MatrixMath;e.MrPinchy={init:function(e){return new i(e)}}},"@VERSION@",{requires:["matrix-math"],optional:[]});
YUI.add("mobile-photo-well-view",function(e){var t=3,n="https://m.flickr.com/photos/{nsid}/{photoid}/play/",r=500,i=500;e.namespace("Views")[this.name]=e.Base.create("mobile-photo-well-view",e.FlickrView,[],{langBundles:["common"],initializer:function(t){this.photoId=t.photoId,this.context=e.clone(t.context,!0);var n=this.appContext.getUA().os;this.nsid=t.nsid,this.disablePinchZooming=n==="windows",this.isAndroid=n==="android";if(this.context&&this.context.params&&this.context.params.isSharedEntity){var r=this.context.params;this.appContext.setGPCredentials({gp_code:r.gpCode,gp_owner:r.gpOwner,share_code:r.gpCode})}else this.appContext.setGPCredentials(null);return this},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){t.set("photoModel",e)})),e.Promise.all(n)},buildContainer:function(){var s,o,u=this.get("photoModel").getValue("isVideo"),a,f,l,c;if(YUI.Env.isServer)s=r,o=i,a=s/8,f=o/8;else{s=parseInt(e.StorageHelper.getItem("mobile-photo-well-width"),10),o=parseInt(e.StorageHelper.getItem("mobile-photo-well-height"),10);var h=this.getUsableAreaSize(),p=h.actualW,d=h.adjustedH;if(!s||isNaN(s)||s<50)s=p;if(!o||isNaN(o)||o<50)o=d;a=s,f=o}var v=this.get("photoModel").getSizeToFit({width:a,height:f},{cropToFit:!0});return this.set("bestImageSize",v),l=Math.max(v.height/t,o),c=v.height/v.width,this.setContainerWithTemplate("mobile-photo-well",{maxHeight:l,isServer:YUI.Env.isServer,loadAspect:c,loadHeight:c*s,url:v.url,videoURL:n.replace("{nsid}",this.nsid).replace("{photoid}",this.photoId),isVideo:u}),this},activate:function(){var e=this.get("container"),t=e.one(".main-image"),n=e.one(".main-image-wrapper"),r=this.get("photoModel"),i=this.get("photoModel").getValue("isVideo"),s=this;e.all(".photo-link.loading").removeClass("loading"),t.setStyle("width",null),n.setStyle("height",null),this.findBestPhoto(r,t),this.appContext.getViewCounter().queue(this.get("photoModel").getValue("id"),this.appContext.getReferrer()),this.loadAdjacentPhotos();var o=parseInt(n.getComputedStyle("height"),10);return this.get("container").setStyle("height",o+"px"),n.setStyle("position","absolute"),!i&&!this.disablePinchZooming&&this.addPinchy(),window.orientation&&(window.onorientationchange=function(){var e=window.innerWidth,t=window.innerHeight,n=e>t,r=[[0,0],[n?t:e,n?e:t]];s.transform.updateBoundingBox(r),s.transform.updateImageSize()}),this.context&&this.context.modelName&&this.context.params&&this.appContext.getModel(this.context.modelName,this.context.params).then(function(e){if(e)return s.set("contextModel",e),e.getValue("photoContextList").getContext({photoId:s.photoId}).then(function(){var t=-1,n=e.getValue("photoContextList").getList();n.some(function(e,n){return e.id===s.photoId&&(t=n),t>0});if(t>-1){var r,i,o,u,a="/in/"+e.getValue("urlSuffix");t>0&&(r=n[t-1],r&&(o=r.getValue("url")+a)),t<n.length-1&&(i=n[t+1],i&&(u=i.getValue("url")+a)),o&&s.get("container").one(".prev-photo").setAttribute("href",o).removeClass("hide-nav-link"),u&&s.get("container").one(".next-photo").setAttribute("href",u).removeClass("hide-nav-link")}})}),this},addPinchy:function(){var n=window.innerWidth,r=window.innerHeight,i=n>r,s=this.get("container").one(".main-image-wrapper"),o=this.get("container").one(".main-image-wrapper-underlay"),u=[[0,0],[i?r:n,i?n:r]],a=this,f;this.transform=e.MrPinchy.init({node:s,maxScale:i?2:t,minScale:1,boundingBox:u}),f=this.transform.getTouchHandler(),this.largeLoaded=!1,s.on("touchstart",function(t){f(t),a.largeLoaded||(a.largeLoaded=!0,a.findBestPhoto(a.get("photoModel"),s.one(".img"),!0,!0)),a.addZoomTimeout=setTimeout(function(){a.get("container").addClass("zoomed"),s.addClass("zoomed"),e.one("html").setStyle("position","fixed"),o.setStyle("display","block"),setTimeout(function(){o.addClass("show-overlay")},10)},200)}),s.on("touchmove",function(e){f(e)}),s.on("touchend",function(e){f(e)}),s.on("touchcancel",function(e){a.transform.resetTransform(),a.transform.fire("mrpinchy:reset")}),this.transform.on("mrpinchy:reset",function(){clearTimeout(a.addZoomTimeout),a.get("container").removeClass("zoomed"),s.removeClass("zoomed"),e.one("html").setStyle("position",null),o.removeClass("show-overlay"),setTimeout(function(){o.setStyle("display","none")},800)}),this.transform.on("mrpinchy:endpinch",function(t){t===1&&(clearTimeout(a.addZoomTimeout),a.get("container").removeClass("zoomed"),s.removeClass("zoomed"),e.one("html").setStyle("position",null),o.removeClass("show-overlay"),setTimeout(function(){o.setStyle("display","none")},800))})},getUsableAreaSize:function(){var e=window.innerWidth,t=window.innerHeight,n=t-50-50;return this.get("container").ancestor(".show-upsell-banner")&&(n-=50),{actualW:e,actualH:t,adjustedH:n}},findBestPhoto:function(n,r,i,s){var o=this.getUsableAreaSize(),u=o.actualW,a=o.adjustedH,f=n.getSizeToFit({width:i?u*t:u,height:i?a*t:a},{cropToFit:!0});a=Math.min(u/f.width*f.height,o.adjustedH);if(r)r.getAttribute("src")!==f.url&&r.setAttribute("src",f.url),this.set("bestImageSize",f),r.setStyle("height",a),this.get("container").setStyle("height",a),YUI.Env.isServer||(e.StorageHelper.setItem("mobile-photo-well-width",u),e.StorageHelper.setItem("mobile-photo-well-height",o.adjustedH));else{var l=new Image;l.src=f.url}},loadAdjacentPhotos:function(){var e=this.get("prevPhoto"),t=this.get("nextPhoto");t&&this.findBestPhoto(t),e&&this.findBestPhoto(e)}},{ATTRS:{}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-mobile-photo-well","viewport-data","storage-helper","mrpinchy"],langBundles:["common"]});
YUI.add("hermes-template-mobile-photo-engagement",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f=e.escapeExpression;return'			<span class="fave-count-label" style="margin-left: '+f((o=(o=n.faveSvgMargin||(t!=null?t.faveSvgMargin:t))!=null?o:a,typeof o=="function"?o.call(u,{name:"faveSvgMargin",hash:{},data:i}):o))+'px">\n'+((s=n["if"].call(u,(s=t!=null?t.engagement:t)!=null?s.isFaved:s,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(4,i,0),data:i}))!=null?s:"")+"				"+f((n.friendlyNumber||t&&t.friendlyNumber||a).call(u,(s=t!=null?t.engagement:t)!=null?s.faveCount:s,{name:"friendlyNumber",hash:{},data:i}))+"\n			</span>\n"},2:function(e,t,n,r,i){return'					<svg class="icon icon-fave"><use xlink:href="#icon-fave"></use></svg>\n'},4:function(e,t,n,r,i){return'					<svg class="icon icon-fave_hollow"><use xlink:href="#icon-fave_hollow"></use></svg>\n'},6:function(e,t,n,r,i){var s;return'			<span class="fave-count-label" style="margin-left: '+e.escapeExpression((s=(s=n.faveSvgMargin||(t!=null?t.faveSvgMargin:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"faveSvgMargin",hash:{},data:i}):s))+'px">\n				<svg class="icon icon-fave_hollow"><use xlink:href="#icon-fave_hollow"></use></svg>\n				0\n			</span>\n'},8:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f=e.escapeExpression;return'			<span class="comment-count-label" style="margin-left: '+f((o=(o=n.commentSvgMargin||(t!=null?t.commentSvgMargin:t))!=null?o:a,typeof o=="function"?o.call(u,{name:"commentSvgMargin",hash:{},data:i}):o))+'px">\n				<svg class="icon icon-comment_hollow"><use xlink:href="#icon-comment_hollow"></use></svg>\n				'+f((n.friendlyNumber||t&&t.friendlyNumber||a).call(u,(s=t!=null?t.engagement:t)!=null?s.commentCount:s,{name:"friendlyNumber",hash:{},data:i}))+"\n			</span>\n"},10:function(e,t,n,r,i){var s;return'			<span class="comment-count-label" style="margin-left: '+e.escapeExpression((s=(s=n.commentSvgMargin||(t!=null?t.commentSvgMargin:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"commentSvgMargin",hash:{},data:i}):s))+'px">\n				<svg class="icon icon-comment_hollow"><use xlink:href="#icon-comment_hollow"></use></svg>\n			0</span>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'<div class="actions-container">\n	<div class="fave-count">\n'+((s=n["if"].call(o,(s=t!=null?t.engagement:t)!=null?s.faveCount:s,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(6,i,0),data:i}))!=null?s:"")+'	</div>\n\n	<div class="comment-count">\n'+((s=n["if"].call(o,(s=t!=null?t.engagement:t)!=null?s.commentCount:s,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.program(10,i,0),data:i}))!=null?s:"")+'	</div>\n\n	<div class="share-container">\n		<span class="share-container-icon">\n			<svg class="icon icon-share_hollow"><use xlink:href="#icon-share_hollow"></use></svg>\n		</span>\n	</div>\n\n	<div class="vr vr-container">\n		<a href="#" title="'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.IMMERSIFY"},data:i}))+'">\n			<svg class="icon icon-vr_hollow"><use xlink:href="#icon-vr_hollow"></use></svg>\n		</a>\n	</div>\n	'+a((n.outlet||t&&t.outlet||u).call(o,t!=null?t["vr-overlay-view"]:t,{name:"outlet",hash:{},data:i}))+"\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-photo-engagement",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-mobile-share-modal",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'<div class="share">\n	<p>'+a((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"share-modal.SHARE"},data:i}))+'</p>\n\n	<form>\n		<input type="text" value="'+a((s=(s=n.shortUrl||(t!=null?t.shortUrl:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"shortUrl",hash:{},data:i}):s))+'" readonly>\n	</form>\n</div>'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/mobile-share-modal",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-stats-photo",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression,c=e.lambda;return'\n	<div class="photo-stats-basics">\n		<div class="photo-stats-basics-left">\n			<a href="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" class="photo-thumbnail" style="background-image: url('+l((o=(o=n.photoUrl||(t!=null?t.photoUrl:t))!=null?o:a,typeof o===f?o.call(u,{name:"photoUrl",hash:{},data:i}):o))+');"></a>\n			<div class="photo-info">\n				<a href="'+l((o=(o=n.url||(t!=null?t.url:t))!=null?o:a,typeof o===f?o.call(u,{name:"url",hash:{},data:i}):o))+'" class="photo-title truncate">'+l((o=(o=n.title||(t!=null?t.title:t))!=null?o:a,typeof o===f?o.call(u,{name:"title",hash:{},data:i}):o))+'</a>\n				<div class="photo-posted-date">\n'+((s=(n.friendlyDateScrappySubphoto||t&&t.friendlyDateScrappySubphoto||a).call(u,t!=null?t.datePosted:t,false,false,{name:"friendlyDateScrappySubphoto",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+'				</div>\n			</div>\n		</div>\n		<div class="photo-stats-basics-right">\n			<div class="view-count"><i></i> '+l(c((s=t!=null?t.basicStats:t)!=null?s.viewCount:s,t))+'</div>\n			<div class="fave-count"><i></i> '+l(c((s=t!=null?t.basicStats:t)!=null?s.faveCount:s,t))+'</div>\n			<div class="comment-count"><i></i> '+l(c((s=t!=null?t.basicStats:t)!=null?s.commentCount:s,t))+'</div>\n		</div>\n	</div>\n\n	<div class="photo-stats-nav">\n		<div class="nav-links">\n			<div class="photo-stats-nav-link selected" data-link="views">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.RECENT_VIEWS"},data:i}))+'</div>\n			<div class="photo-stats-nav-link" data-link="sources">'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.SOURCES"},data:i}))+'</div>\n		</div>\n		<div class="photo-stats-nav-extras">\n			<div class="date-picker">'+l((o=(o=n.prettyDateString||(t!=null?t.prettyDateString:t))!=null?o:a,typeof o===f?o.call(u,{name:"prettyDateString",hash:{},data:i}):o))+' <span></span></div>\n		</div>\n	</div>\n\n	<div class="photo-stats-sections" data-showing="views">\n\n		<div class="photo-stats-section" data-section="views">\n			<div class="daily-views-graph">\n			</div>\n		</div>\n\n		<div class="photo-stats-section" data-section="sources">\n\n			<div class="source-breakdown-left'+((s=n.unless.call(u,t!=null?t.hasReferrers:t,{name:"unless",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n				<div class="no-sources">\n					'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.NO_SOURCES_TODAY"},data:i}))+'\n				</div>\n\n				<div class="sources-pie-chart pie-chart"></div>\n			</div>\n\n			<div class="source-breakdown-right'+((s=n.unless.call(u,t!=null?t.hasReferrers:t,{name:"unless",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n				<div class="sources-breakdown">\n					<div class="sources-breakdown-header">\n						<div>'+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.SOURCES"},data:i}))+"</div>\n						<div>"+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"stats.VISITS"},data:i}))+'</div>\n						<div>%</div>\n					</div>\n					<div class="sources-breakdown-list"></div>\n				</div>\n			</div>\n\n		</div>\n\n	</div>\n\n'},2:function(e,t,n,r,i){return"						"+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlDate:t!=null?t.intlDate:t,intlName:t!=null?t.intlName:t},data:i}))+"\n"},4:function(e,t,n,r,i){return" no-results"},6:function(e,t,n,r,i){return'\n	<div class="no-stats-available">\n		'+e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"stats.NO_RECENT_PHOTO_STATS_AVAILABLE"},data:i}))+"\n	</div>\n\n"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.actuallyHasSomeStats:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(6,i,0),data:i}))!=null?s:""},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/stats-photo",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("timezone-helper",function(e){"use strict";e.TimezoneHelper=function(t,n,r){r?(this.tz=r,this.dst=!1):(this.tz=t.getViewer().prefs.timezonePref.offset,this.dst=t.getViewer().prefs.timezonePref.dst),this.momentObject=e.moment(n,"X"),this.momentObject.utcOffset(this.tz),this.dst&&this.momentObject.isDST()&&this.momentObject.add(1,"hour")},e.TimezoneHelper.prototype.toFormat=function(e){return this.momentObject.format(e)}},"@VERSION@",{requires:["moment"]});
YUI.add("stats-helper",function(e){"use strict";var t;YUI.Env.isServer?t=require("querystring").stringify:t=function(e){var t=[],n,r,i;for(n in e)if(e.hasOwnProperty(n))if(Array.isArray(e[n]))for(r=0,i=e[n].length;r<i;r++)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n][r]));else t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},e.StatsHelper=function(){},e.StatsHelper.prototype.moveToFrontOfArray=function(e,t){var n=-1;return e.forEach(function(e,r){e===t&&(n=r)}),n>-1&&e.unshift(e.splice(n,1)[0]),e},e.StatsHelper.prototype.moveToEndOfArray=function(e,t){var n=-1;return e.forEach(function(e,r){e===t&&(n=r)}),n>-1&&(e.push(e[n]),e.splice(n,1)),e},e.StatsHelper.prototype.whichChild=function(e){var t=0;while((e=e.previousElementSibling)!==null)++t;return t},e.StatsHelper.prototype.getRoundedRectanglePath=function(e,t,n,r,i,s,o){var u=e[0],a=e[1],f=t[0],l=t[1],c;return c="M"+(u+n)+","+a,c+="h"+(f-2*n),i?c+="a"+n+","+n+" 0 0 1 "+n+","+n:(c+="h"+n,c+="v"+n),c+="v"+(l-2*n),o?c+="a"+n+","+n+" 0 0 1 "+ -n+","+n:(c+="v"+n,c+="h"+ -n),c+="h"+(2*n-f),s?c+="a"+n+","+n+" 0 0 1 "+ -n+","+ -n:(c+="h"+ -n,c+="v"+ -n),c+="v"+(2*n-l),r?c+="a"+n+","+n+" 0 0 1 "+n+","+ -n:(c+="v"+ -n,c+="h"+n),c+="z",c},e.StatsHelper.prototype.getIdFromParams=function(e){var n=t(e);return n===""&&(n=1),n},e.StatsHelper.prototype.convertStorageTotalToRealNumber=function(e){var t=e;return e===-1&&(t=-1),t},e.StatsHelper.prototype.convertStorageAmountToRealNumber=function(e){var t,n,r,i=100;return e=parseInt(e,10)||1,t=Math.ceil(Math.log(e)/Math.LN10),n=Math.floor(t/3),r=e/Math.pow(10,n*3),r=Math.floor(r*i)/i,r},e.StatsHelper.prototype.convertNaturalLanguageDateToRealDateTimestamp=function(t,n){var r="",i;i=e.moment();switch(n){case"today":r=i;break;case"yesterday":r=i.subtract(1,"days");break;case"thisweek":case"week":r=i.startOf("week");break;case"lastweek":r=i.subtract(1,"weeks").startOf("week");break;case"twoweeksago":case"theweekbeforethat":r=i.subtract(2,"weeks").startOf("week");break;case"threeweeksago":case"theweekbeforetheweekbeforethat":r=i.subtract(3,"weeks").startOf("week")}return r!==""&&(r=(new e.TimezoneHelper(t,r.format("X"),"00:00")).toFormat("YYYY-MM-DD")),r}},"@VERSION@",{affinity:"",requires:["flickr-promise","event-custom","moment","timezone-helper"],optional:[]});
YUI.add("flickr-stats-photo-daily-views-fetcher",function(e,t){"use strict";function n(e){var t={id:e.id,photo_id:e.photoId};return t}function r(t,n){var r=t.apiResponse.stats,i=r.graphdata,s=t.modelRegistry,o,u={},a={},f=[],l,c,h,p,d;return d={views:0,favs:0,comments:0},o={id:n.id},i&&(u=i,f=Object.keys(i),f.forEach(function(e,t){!u[e].burp&&!u[e].nodot?(c?(c>e&&(c=e),p<e&&(p=e)):(c=e,p=e),u[e].views||(u[e].views=0),u[e].comments||(u[e].comments=0),u[e].favs||(u[e].favs=0),u[e].views=parseInt(u[e].views,10),u[e].favs=parseInt(u[e].favs,10),u[e].comments=parseInt(u[e].comments,10),d.views+=u[e].views,d.favs+=u[e].favs,d.comments+=u[e].comments):delete u[e]})),o.days=u,o.oldestDate=c,o.newestDate=p,o.totals=d,s.exists(o.id)?(a=s.getValue("days"),o.days=e.merge(o.days,a),l=s.getValue("oldestDate"),c>l&&(o.oldestDate=l),h=s.getValue("newestDate"),p>h&&(o.newestDate=h),o.totals+=e.merge(o.totals,s.getValue("totals")),s.setValues(o.id,o)):s.add(o),o}function i(n,r){var i=this;return(new e.FlickrPromise({apiResponse:r.callAPI("flickr.stats.photo.getGraphData",this._processParams(n)),modelRegistry:r.getModelRegistry("stats-photo-daily-views-models")})).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-stats-photo-daily-views"]={run:i,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["stats-photo-daily-views-models"]});
YUI.add("stats-photo-daily-views-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-stats-photo-daily-views"].run(t,this.appContext)}},attributes:{days:{},oldestDate:{},newestDate:{},totals:{}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-stats-photo-daily-views-fetcher"]});
YUI.add("flickr-stats-referrer-domains-fetcher",function(e,t){"use strict";function i(e){var t={id:e.id,date:e.date||"",photo_id:e.photoId||""};return t}function s(e,t){var n=e.apiResponse,i=e.modelRegistry,s,o={},u={},a=0,f,l,c=n.stat;s={id:t.id},delete n.stat,l=Object.keys(n),n.stat=c;if(l.length===0)throw f=new Error("[flickr-stats-referrer-domains-fetcher] api returned ok but did not contain the data needed"),f.fatal=!0,f;return l.forEach(function(e,t){var i=r[e.toLowerCase()],s,f=n[e];i||(i="other"),o[i]||(o[i]={}),u[i]||(u[i]=0),s=f.viewcount,o[i]=f,u[i]+=s,a+=s}),s.referrers=o,s.totals=u,s.total=a,i.addOrUpdate(s),s}function o(t,r){var i=this;return(new e.FlickrPromise({apiResponse:r.callAPI("flickr.stats.getReferrerCategoriesForDate",this._processParams(t)),modelRegistry:r.getModelRegistry("stats-referrer-domains-models")})).then(function(e){return i._processResponse(e,t)},function(e){if(e.code===2)return n.error({err:e,id:t.id,date:t.date}),r.getModelRegistry("stats-referrer-domains-models").then(function(e){e.addOrUpdate({id:t.id,missingData:!0})});throw e})}var n=require("lib/flog")(t),r={flickr:"flickr","search engine":"search",social:"social",yahoo:"search",google:"search",bing:"search",twitter:"social",facebook:"social",pinterest:"social",tumblr:"social","flickr embedr":"flickr embedr"};e.namespace("ModelFetchers")["flickr-stats-referrer-domains"]={run:o,_processResponse:s,_processParams:i}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["stats-referrer-domains-models"]});
YUI.add("stats-referrer-domains-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-stats-referrer-domains"].run(t,this.appContext)}},attributes:{referrers:{defaultValue:{}},totals:{defaultValue:{}},total:{defaultValue:0},missingData:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-stats-referrer-domains-fetcher"]});
YUI.add("stats-photo-view",function(e){var t=500;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.statsHelper=new e.StatsHelper,this.photoId=t.photoId,this.dateString=t.dateString,this.prettyDateString=t.prettyDateString||t.dateString,this.realtimeDateString=t.realtimeDateString||t.dateString,this.isOwner=t.isOwner,this.nsid=t.nsid,this.isPro=!1,this.pickers={},this.tooltip,this.dateIntl={previousMonth:this.intlMessage({intlName:"pika-day.PREVIOUS_MONTH"}),nextMonth:this.intlMessage({intlName:"pika-day.NEXT_MONTH"})},this.dateIntl.weekdays=[this.intlMessage({intlName:"pika-day.SUNDAY"}),this.intlMessage({intlName:"pika-day.MONDAY"}),this.intlMessage({intlName:"pika-day.TUESDAY"}),this.intlMessage({intlName:"pika-day.WEDNESDAY"}),this.intlMessage({intlName:"pika-day.THURSDAY"}),this.intlMessage({intlName:"pika-day.FRIDAY"}),this.intlMessage({intlName:"pika-day.SATURDAY"})],this.dateIntl.weekdaysShort=[this.intlMessage({intlName:"pika-day.SUNDAY_SHORT"}),this.intlMessage({intlName:"pika-day.MONDAY_SHORT"}),this.intlMessage({intlName:"pika-day.TUESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.WEDNESDAY_SHORT"}),this.intlMessage({intlName:"pika-day.THURSDAY_SHORT"}),this.intlMessage({intlName:"pika-day.FRIDAY_SHORT"}),this.intlMessage({intlName:"pika-day.SATURDAY_SHORT"})],this.dateIntl.months=[this.intlMessage({intlName:"pika-day.JANUARY"}),this.intlMessage({intlName:"pika-day.FEBRUARY"}),this.intlMessage({intlName:"pika-day.MARCH"}),this.intlMessage({intlName:"pika-day.APRIL"}),this.intlMessage({intlName:"pika-day.MAY"}),this.intlMessage({intlName:"pika-day.JUNE"}),this.intlMessage({intlName:"pika-day.JULY"}),this.intlMessage({intlName:"pika-day.AUGUST"}),this.intlMessage({intlName:"pika-day.SEPTEMBER"}),this.intlMessage({intlName:"pika-day.OCTOBER"}),this.intlMessage({intlName:"pika-day.NOVEMBER"}),this.intlMessage({intlName:"pika-day.DECEMBER"})],this.viewClass="",this.get("container").get("innerHTML")===""&&this.setContainerHTML('<div class="balls"></div>'),this},loadState:function(){if(!this.appContext.flipper.isFlipped("rebootify-stats")||!this.isOwner)return e.Promise.resolve();var t=this,n,r,i,s,o,u,a={};return this.isOwner?this.appContext.getModel("person-models",this.nsid).then(function(f){return t.isPro=f.getValue("isPro"),t.isPro?(n=e.moment().format("X"),r=new e.TimezoneHelper(t.appContext,n,"00:00"),t.dateString||(t.dateString=r.toFormat("YYYY-MM-DD"),t.prettyDateString=r.toFormat("MMM D, YYYY"),t.realtimeDateString=t.dateString),i={date:t.dateString,photoId:t.photoId},s={id:t.statsHelper.getIdFromParams(i)},a.dailyViewsModel=t.appContext.getModel("stats-photo-daily-views-models",s,i),o={date:t.dateString,photoId:t.photoId},u={id:t.statsHelper.getIdFromParams(o)},a.referrerDomainsModel=t.appContext.getModel("stats-referrer-domains-models",u,o),a.photoModel=t.appContext.getModel("photo-models",t.photoId),a.photoStatsModel=t.appContext.getModel("photo-stats-models",t.photoId),(new e.FlickrPromise(a)).then(function(e){t.dailyViewsModel=e.dailyViewsModel,t.referrerDomainsModel=e.referrerDomainsModel,t.photoModel=e.photoModel,t.photoModel.stats=e.photoStatsModel},function(e){console.log(e)})):e.Promise.resolve()}):e.Promise.resolve()},loadNewDateData:function(t){var n=this,r={},i,s;return s={date:t,photoId:n.photoId},i={id:this.statsHelper.getIdFromParams(s)},r.referrerDomainsModel=this.appContext.getModel("stats-referrer-domains-models",i,s),(new e.FlickrPromise(r)).then(function(e){t===n.dateString&&(n.referrerDomainsModel=e.referrerDomainsModel,n.refreshContent())},function(e){console.log(e)})},refreshContent:function(){var e,n=t,r=this.get("container");this.updateCurrentDatePoint(this.dateString,document.querySelector("circle.selectedPoint").getAttribute("key")),this.createReferrersGraphs(),e=r.one(".source-breakdown-right .sources-breakdown"),e&&(n=e.get("clientHeight")),r.setStyles({height:Math.max(t,n+60)+"px"})},buildContainer:function(){var e=!1;return this.isPro&&this.appContext.flipper.isFlipped("rebootify-stats")&&this.isOwner&&(e=this.referrerDomainsModel.getValue("total")>0?!0:!1),this.setContainerWithTemplate("stats-photo",{hasStats:this.isPro,hasReferrers:e,prettyDateString:this.dateString===this.realtimeDateString?this.intlMessage({intlName:"stats.TODAY"}):this.prettyDateString,photoUrl:this.photoModel.getSizeToFit({width:100,height:100}).url,url:this.photoModel.getValue("url"),title:this.photoModel.getValue("title"),basicStats:this.photoModel.getValue("engagement").toJSON(),datePosted:this.photoModel.stats.getDateObj("datePosted"),actuallyHasSomeStats:this.dailyViewsModel&&this.dailyViewsModel.getValue("totals").views>0&&this.isPro}),this},activate:function(){if(!this.appContext.flipper.isFlipped("rebootify-stats")||!this.isOwner||!this.isPro||!this.dailyViewsModel)return this;var t=this,n=this.get("container"),r={},i=n.all(".date-picker").getDOMNodes(),s=this.dailyViewsModel.getValue("oldestDate"),o=this.dailyViewsModel.getValue("newestDate"),u=this.dailyViewsModel.getValue("totals");return u.views>0&&this.isPro&&e.use("d3",function(){n.addClass("hasStats"),t.viewClass="."+n.getAttribute("class").replace(/\s/g,"."),t.createMainGraph(),r={i18n:t.dateIntl,position:"bottom right",reposition:!1,format:"YYYY-MM-DD",minDate:e.moment(s).toDate(),maxDate:e.moment(o).toDate(),yearRange:[parseInt(s.substring(0,4),10),parseInt(o.substring(0,4),10)],defaultDate:e.moment(t.dateString).toDate(),setDefaultDate:!0,onSelect:function(e){t.pickaNewDate(e,this.config().theme)},onOpen:function(){t.el&&(t.el.className+=" stats-photo")}},e.use("pika-day",function(e){i.forEach(function(n,i){t.pickers[i]=new e.Pikaday(e.merge(r,{field:n,theme:"picker-"+i}))})}),t.createReferrersGraphs(),t.registerEventHandler(n.all(".photo-stats-nav-link").on("click",t.handleNavItemClick,t)),t.registerEventHandler(n.one(".source-breakdown-left").on("click",t.handleSourceBreakdownClick,t)),t.registerEventHandler(n.one(".source-breakdown-right"
).on("click",t.handleSourceBreakdownClick,t)),t.registerEventHandler(n.one(".source-breakdown-right").on("mouseover",t.handleSourceBreakdownListItemMouseover,t)),t.registerEventHandler(n.one(".source-breakdown-right").on("mouseout",t.handleSourceBreakdownListItemMouseout,t))}),this},handleNavItemClick:function(n){var r=n.target,i=r.getData("link"),s=this.get("container"),o,u=t,a=!1;r.hasClass("selected")||(s.all(".photo-stats-nav-link").removeClass("selected"),r.addClass("selected"),s.one(".photo-stats-sections").getDOMNode().setAttribute("data-showing",i),i==="sources"?(o=s.one(".source-breakdown-right .sources-breakdown"),o&&(u=o.get("clientHeight"),a=e.config.win.innerWidth<=700,a&&(u=u+140+100+70-60)),s.setStyles({height:Math.max(t,u+60)+"px"})):s.setStyles({height:t+"px"}))},handleSourceBreakdownClick:function(n){var r=n.target,i=r.ancestor(),s=r.getDOMNode(),o=r.getData(),u,a,f=this.get("container"),l,c,h,p,d=".sources-pie-chart",v=f.one(d),m=f.one(".source-breakdown-right"),g,y,b=t,w,E=!1,S,x;if(s.tagName.toLowerCase()==="path")S=this.statsHelper.whichChild(s),i.getDOMNode().classList[0]==="overall"?x=m.all(".referrer-row"):x=m.all(".referrer-row-breakdown-row"),i.getAttribute("referrerkey")!=="other"&&i.getAttribute("referrerkey")!=="flickr embedr"&&x.getDOMNodes()[S].querySelector(".header").click();else if(r.hasClass("header")){o=i.getData(),g={margin:{top:0,right:0,bottom:0,left:0}},g.width=v.get("clientWidth")-g.margin.left-g.margin.right,g.height=v.get("clientHeight")-g.margin.top-g.margin.bottom,l=this.referrerDomainsModel,c=l.getValue("referrers"),h=l.getValue("totals"),p=Object.keys(h),this.statsHelper.moveToFrontOfArray(p,"flickr"),f.all(".referrer-row-breakdown-row-breakdown-row.shown").replaceClass("shown","not-shown"),f.all(".referrer-row-breakdown-row-breakdown .show-whole-list").removeClass("no-show");if(o.category){y=m.getData("showing"),u=o.category,m.all(".referrer-row").removeClass("selected");if(e.AttributeHelpers.coerceBoolean(o.isempty)){y!=="NOPE"&&this.createOverallPieChart(g,p,h,null,null,!1),e.d3.selectAll(this.viewClass+" .sources-pie-chart .first-level").remove(),e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),m.all(".referrer-row-breakdown-row").removeClass("selected"),m.setData("showing","NOPE"),m.setData("subshowing","NOPE");return}y!==u?(i.addClass("selected"),m.setData("showing",u),f.one(".first-level")&&(e.d3.selectAll(this.viewClass+" .sources-pie-chart .first-level").remove(),e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),m.all(".referrer-row-breakdown-row").removeClass("selected"),m.setData("subshowing","NOPE")),this.createOverallPieChart(g,p,h,!0),u==="other"||u==="flickr embedr"?this.createPieChart("first-level",g,Object.keys(c[u].items),c[u].items,u):this.createPieChart("first-level",g,Object.keys(c[u]),c[u],u)):(m.setData("showing","NOPE"),this.createOverallPieChart(g,p,h,null,null,!1),u==="other"||u==="flickr embedr"?this.createPieChart("first-level",g,Object.keys(c[u].items),c[u].items,u,null,!0):this.createPieChart("first-level",g,Object.keys(c[u]),c[u],u,null,!0),e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),m.setData("subshowing","NOPE"))}else if(o.referrer){y=m.getData("subshowing"),u=o.referrer,a=o.parentcategory,m.all(".referrer-row-breakdown-row").removeClass("selected");if(e.AttributeHelpers.coerceBoolean(o.isempty)){m.setData("subshowing","NOPE"),y!=="NOPE"&&(this.createPieChart("first-level",g,Object.keys(c[a]),c[a],a,null,"fakeOpen"),this.createPieChart("second-level",g,Object.keys(c[a][y].items),c[a][y].items,y,a,!0));return}y!==u?(i.addClass("selected"),m.setData("subshowing",u),f.one(".first-level")&&e.d3.selectAll(this.viewClass+" .sources-pie-chart .second-level").remove(),this.createPieChart("first-level",g,Object.keys(c[a]),c[a],a,null,"fakeClose"),this.createPieChart("second-level",g,Object.keys(c[a][u].items),c[a][u].items,u,a)):(m.setData("subshowing","NOPE"),this.createPieChart("first-level",g,Object.keys(c[a]),c[a],a,null,"fakeOpen"),this.createPieChart("second-level",g,Object.keys(c[a][u].items),c[a][u].items,u,a,!0))}w=f.one(".source-breakdown-right .sources-breakdown"),b=w.get("clientHeight"),E=e.config.win.innerWidth<=700,E&&(b=b+140+100+70-60),f.setStyles({height:Math.max(t,b+60)+"px"})}else r.hasClass("show-whole-list")&&(f.all(".referrer-row-breakdown-row-breakdown-row.not-shown").replaceClass("not-shown","shown"),f.all(".referrer-row-breakdown-row-breakdown .show-whole-list").addClass("no-show"))},handleSourceBreakdownListItemMouseover:function(e){var t=e.target,n=t.ancestor(),r=this.get("container"),i,s;n.hasClass("referrer-row")?(i=this.statsHelper.whichChild(n.getDOMNode()),s=r.one(".source-breakdown-left").all(".pie-chart .overall path"),s.setAttribute("class","not-selected"),s.getDOMNodes()[i].setAttribute("class","")):n.hasClass("referrer-row-breakdown-row")?(i=this.statsHelper.whichChild(n.getDOMNode()),s=r.one(".source-breakdown-left").all(".pie-chart .first-level path"),s.setAttribute("class","not-selected"),s.getDOMNodes()[i].setAttribute("class","")):t.hasClass("referrer-row-breakdown-row-breakdown-row")&&(i=this.statsHelper.whichChild(t.getDOMNode()),s=r.one(".source-breakdown-left").all(".pie-chart .second-level path"),s.setAttribute("class","not-selected"),s.getDOMNodes()[i].setAttribute("class",""))},handleSourceBreakdownListItemMouseout:function(e){var t=e.target;t.getDOMNode().getAttribute("class")!=="pie"&&t.getDOMNode().tagName!=="path"&&this.get("container").all(".source-breakdown-left .pie-chart path").setAttribute("class","")},pickaNewDate:function(t,n){var r=new e.TimezoneHelper(this.appContext,t.getTime()/1e3+Math.abs(t.getTimezoneOffset()*60),"00:00"),i,s;this.dateString=r.toFormat("YYYY-MM-DD"),this.prettyDateString=r.toFormat("MMM D, YYYY");for(i in this.pickers)this.dateString===this.realtimeDateString?s=this.intlMessage({intlName:"stats.TODAY"}):s=this.prettyDateString,s+=" <span></span>",this.pickers
[i]._o.field.innerHTML=s,i!==n&&this.pickers[i].setMoment(r.momentObject,!0);this.loadNewDateData(this.dateString)},createMainGraph:function(){function b(t){t.each(function(){var t=e.d3.select(this),n=t.text().split(/\s+/).reverse(),r,i=[],s=0,o=1.1,u=t.attr("y"),a=parseFloat(t.attr("dy")),f=t.text(null).append("tspan").attr("x",0).attr("y",u).attr("dy",a+"em"),l=n.length;while(r=n.pop())i.push(r),f.text(i.join(" ")),l>1&&(i.pop(),f.text(i.join(" ")),i=[r],r!==""&&r!==" "&&(f=t.append("tspan").attr("x",0).attr("y",u).attr("dy",s++*o+a+"em").text(r)))})}var t=this.dailyViewsModel,n=t.getValue("days"),r=Object.keys(n),i=t.getValue("newestDate"),s=e.d3.time.format("%Y-%m-%d").parse,o=this,u=this.get("container"),a=".daily-views-graph",f=u.one(a),l,c,h,p,d,v=[],m,g,y="linear";this.daysKeys=r,h={margin:{top:15,right:15,bottom:90,left:60}},h.width=f.get("clientWidth")-h.margin.left-h.margin.right,h.height=f.get("clientHeight")-h.margin.top-h.margin.bottom,o.createYStuff=function(t){var i={};return i.yMin=0,i.yMax=e.d3.max(r,function(e,r){return+n[e][t]}),i.yMax=Math.ceil(i.yMax*1.2),i.yMaxLength=i.yMax.toString().length,i.yAxisDivisor=Math.pow(10,Math.max(0,i.yMaxLength-2)),i.yMax=Math.ceil(i.yMax*.2/i.yAxisDivisor)*i.yAxisDivisor*5,i.yAxisValues=[0,Math.ceil(i.yMax*.2/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax*.4/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax*.6/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax*.8/i.yAxisDivisor)*i.yAxisDivisor,Math.ceil(i.yMax/i.yAxisDivisor)*i.yAxisDivisor],i.y=e.d3.scale.linear().range([h.height,0]).domain([i.yMin,i.yMax]),i.yAxis=e.d3.svg.axis().scale(i.y).orient("left").tickSubdivide(!1).tickValues(i.yAxisValues).tickFormat(function(e,t){var n=e;return t===0&&(n=""),n}),i},g={views:o.createYStuff("views"),favs:o.createYStuff("favs"),comments:o.createYStuff("comments")},r.forEach(function(e,t){v.push(s(e))}),d=e.d3.extent(r,function(e,t){return s(e)}),p=e.d3.time.scale().range([0,h.width]).domain(d),m=e.d3.svg.axis().scale(p).orient("bottom").tickValues(v).tickFormat(function(t,n){var r="";if(n%2===0){r=parseInt(e.d3.time.format("%e")(t),10);if(n===0||r===1||r===2)r+=" "+e.d3.time.format("%b")(t)}return r}),l=e.d3.select(o.viewClass+" "+a).append("svg").attr("class","main-graph").attr("width",h.width+h.margin.left+h.margin.right).attr("height",h.height+h.margin.top+h.margin.bottom).on("mouseleave",function(){e.d3.select(o.viewClass+" .selectedPoint").attr("cx",-100).attr("cy",-100)}),c=l.append("defs"),c.append("linearGradient").attr("id","photoDailyViewsViews").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").selectAll("stop").data([{offset:"0%",color:"#24d9d7"},{offset:"100%",color:"#00aaff"}]).enter().append("stop").attr("offset",function(e){return e.offset}).attr("stop-color",function(e){return e.color}),l.append("g").attr("class","weekends").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").attr("width",h.width).attr("height",h.height).selectAll("rect").data(r).enter().append("rect").attr("class",function(e,t){var n=s(e),r=n.getDay(),i="";if(r===0||r===6)i="weekend";return i}).attr("y",0).attr("x",function(e,t){var n=p(s(e));return t>0&&(n-=h.width/r.length/2),n}).attr("height",h.height).attr("width",function(e,t){var n=h.width/r.length;if(t===0||t===r.length-1)n/=2;return n}),l.append("g").attr("class","gridlines").attr("transform","translate(0, "+h.margin.top+")").selectAll("line").data(g.views.yAxisValues).enter().append("line").attr("x1",0).attr("x2",h.width+h.margin.left+h.margin.right).attr("y1",function(e){return g.views.y(e)}).attr("y2",function(e){return g.views.y(e)}),o.createYAxis=function(t,n){var r=!1;r=e.d3.selectAll(o.viewClass+" .y.axis"),r&&r.remove(),t.insert("g",".x.axis").attr("class","y axis").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").call(g[n].yAxis).selectAll("text").attr("x","-10").attr("y","12")},o.createYAxis(l,"views"),l.append("g").attr("class","x axis").attr("transform","translate("+h.margin.left+", "+(h.height+h.margin.top)+")").call(m).selectAll("text").attr("y","10").call(b),o.createFlatLine=function(){return e.d3.svg.line().x(function(e){return p(s(e))}).y(function(e){return g.views.y(0)})},o.createLine=function(t){return e.d3.svg.line().interpolate(y).x(function(e){return p(s(e))}).y(function(e){return g[t].y(n[e][t])})},o.createArea=function(t){return e.d3.svg.area().interpolate(y).x(function(e){return p(s(e))}).y0(h.height).y1(function(e){return g[t].y(n[e][t])})},l.append("path").attr("class","main-line views").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").attr("d",o.createFlatLine()(r)).attr("stroke","url(#photoDailyViewsViews)").transition().delay(500).duration(500).attr("d",o.createLine("views")(r)),o.updatePoint=function(t,r,i,u){var a=e.d3.select(o.viewClass+" "+t),f=a.attr("cx"),l=a.attr("cy"),c=p(s(r))+h.margin.left,d=g[i].y(n[r][i])+h.margin.top;return u?a.transition().duration(500).attr("cx",c).attr("cy",d).attr("date",r).attr("key",i):a.attr("cx",c).attr("cy",d).attr("date",r).attr("key",i),{point:a,oldXY:[f,l],newXY:[c,d]}},o.updateCurrentDatePoint=function(e,t,n){o.updatePoint(".currentDatePoint",e,t,n)},o.updateSelectedPoint=function(t,n,r){o.updatePoint(".selectedPoint",t,n,r);var i,s,u={};return i={date:t,photoId:o.photoId},s={id:o.statsHelper.getIdFromParams(i)},u.referrerDomainsModel=this.appContext.getModel("stats-referrer-domains-models",s,i),(new e.FlickrPromise(u)).then(function(e){},function(e){console.log(e)})},o.createVoronoi=function(t){var n=!1;n=e.d3.selectAll(o.viewClass+" g.voronoi"),n&&n.remove(),l.insert("g",".selectedPoint").attr("class","voronoi").attr("transform","translate("+h.margin.left+", "+h.margin.top+")").attr("width",h.width+h.width/r.length).attr("height",h.height).selectAll("rect").data(r).enter().append("rect").attr("y",0).attr("x",function(e,t){var n=p(s(e));return n-=h.width/r.length/2,n}).attr("height",h.height).attr("width",function(e,t){return h.width/r.length}).on("mouseenter",function(
e,n){o.updateSelectedPoint(r[n],t)})},l.append("circle").attr("class","currentDatePoint").attr("date",i).attr("key","views").attr("r",7).attr("cx",function(e,t){var n=0;return i===o.dateString?n=p(s(i))+h.margin.left:n=p(s(o.dateString))+h.margin.left,n}).attr("cy",g.views.y(0)+h.margin.top).transition().delay(500).duration(500).attr("cy",function(e,t){var r=0;return i===o.dateString?r=g.views.y(n[i].views)+h.margin.top:r=g.views.y(n[o.dateString].views)+h.margin.top,r}),l.append("circle").attr("class","selectedPoint").attr("cx",-100).attr("cy",-100).attr("r",4).attr("date",i).attr("key","views").on("click",function(){o.pickaNewDate(new Date(this.getAttribute("date")))}).on("mouseenter",function(t,r){var i=this.getAttribute("date"),s=n[i],a=new Date(i),f=new e.TimezoneHelper(o.appContext,a.getTime()/1e3+Math.abs(a.getTimezoneOffset()*60),"00:00"),l=f.toFormat("MMMM D"),c,h=150,p,d=s.views;s.favs>d&&(d=s.favs),s.comments>d&&(d=s.comments),h+=(d.toString().length-1)*20,p=-(h/2)+3,c='<div class="date">'+l+"</div>"+'<div class="stats">'+'<div class="stat">'+'<i class="icon" data-type="views"></i>'+o.intlMessage({intlName:"stats.NUMBER",num:s.views})+"</div>"+'<div class="stat">'+'<i class="icon" data-type="faves"></i>'+o.intlMessage({intlName:"stats.NUMBER",num:s.favs})+"</div>"+'<div class="stat">'+'<i class="icon" data-type="comments"></i>'+o.intlMessage({intlName:"stats.NUMBER",num:s.comments})+"</div>"+"</div>",o.tooltip?o.tooltip.updateHTMLMessage(c):(o.tooltip=new e.Views.FluidDroparound({appContext:o.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!1,showDropArrow:!0,preferTop:!0,preferLeft:!0,width:h,height:60,classList:"photo-daily-stats-tooltip over-modal",anchorElement:u.one(".selectedPoint"),hideModalOverlay:!0,invisibleOverlay:!0,htmlMessage:c,contentPadding:0,anchorOffsetHorizontal:24,anchorOffsetVertical:10,closeOnScroll:!0}),o.tooltip.show())}).on("mouseleave",function(e){o.tooltip&&(o.tooltip.close(),o.tooltip=undefined)}),o.createVoronoi("views")},createReferrersGraphs:function(){var e=this,t=this.referrerDomainsModel,n=t.getValue("referrers"),r,i=t.getValue("total"),s=t.getValue("totals"),o,u=this.get("container"),a=".sources-pie-chart",f=u.one(a),l=u.one(".source-breakdown-left"),c=u.one(".source-breakdown-right"),h=f.one(".overall"),p,d,v="";c.setData("showing","NOPE"),c.setData("subshowing","NOPE"),parseInt(i,10)===0?(l.addClass("no-results"),c.addClass("no-results")):(l.removeClass("no-results"),c.removeClass("no-results"),r=Object.keys(n),this.statsHelper.moveToFrontOfArray(r,"flickr"),this.statsHelper.moveToEndOfArray(r,"other"),o=Object.keys(s),this.statsHelper.moveToFrontOfArray(o,"flickr"),this.statsHelper.moveToEndOfArray(o,"other"),d={margin:{top:0,right:0,bottom:0,left:0}},d.width=f.get("clientWidth")-d.margin.left-d.margin.right,d.height=f.get("clientHeight")-d.margin.top-d.margin.bottom,this.set("outerRadius",d.height/2),h?p=e.createOverallPieChart(d,o,s,!1,!0):p=e.createOverallPieChart(d,o,s),v='<div class="referrer-rows">',o.forEach(function(t,n){t==="search"&&s[t]===0?v+='<div class="referrer-row" data-category="'+t+'" data-isempty="true">':v+='<div class="referrer-row" data-category="'+t+'" data-isempty="false">',v+='<div class="header">',t==="search"&&s[t]===0?v+='<div><span class="dot"></span>'+t+"</div>":v+='<div><span class="dot"></span>'+t+'<span class="caret"></span></div>',v+="<div>"+e.intlMessage({intlName:"stats.NUMBER",num:s[t]})+"</div>",v+="<div>"+Math.round(s[t]/i*100)+"%</div>",v+="</div>",v+="</div>"}),v+="</div>",c.one(".sources-breakdown-list").empty().append(v),r.forEach(function(t,r){var i="",o,u,a;t==="other"||t==="flickr embedr"?(o=n[t].items,u=Object.keys(o),a=s[t],typeof a.viewcount!="undefined"&&(a=a.viewcount),i='<div class="referrer-row-breakdown" data-index="'+r+'" data-group="'+t+'">'+e.createOtherReferrerListRowsHTML(u,o,a,t)+"</div>"):(o=n[t],u=Object.keys(o),a=s[t],i='<div class="referrer-row-breakdown" data-index="'+r+'" data-group="'+t+'">'+e.createReferrerListRowsHTML(u,o,a,t)+"</div>"),c.one('.referrer-row[data-category="'+t+'"]').append(i)}))},createOverallPieChart:function(t,n,r,i,s){i||(i=!1);var o,u,a,f,l=this.get("outerRadius"),c=this.get("innerRadius"),h=501,p=this.get("container"),d=".sources-pie-chart",v=p.one(d).one("svg .overall"),m,g=0;n.forEach(function(e){var t=r[e];typeof t.viewcount!="undefined"&&(t=t.viewcount),g+=t}),m=e.d3.scale.linear().domain([1,n.length]).range(["#00aaff","#18297f"]),u=e.d3.svg.arc().innerRadius(c).outerRadius(l),s&&v&&(e.d3.select(this.viewClass+" "+d+" svg").remove(),v=!1),v?i?(a=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(-2*Math.PI).value(function(e,t){var n=r[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),o=e.d3.select(this.viewClass+" "+d+" svg .overall"),f=o.datum(n).selectAll("path").call(function(t){t.transition().delay(function(e,t){var i=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof r[n[o]].viewcount!="undefined"?s+=r[n[o]].viewcount:s+=r[n[o]];i=s/g*h}return i}).duration(function(e,t){var n=0;return n=e.value/g*h,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.startAngle=n(e),u(t)}})})):(a=e.d3.layout.pie().startAngle(2*Math.PI).endAngle(0*Math.PI).value(function(e,t){var n=r[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),o=e.d3.select(this.viewClass+" "+d+" svg .overall"),f=o.selectAll("path"),f.data().map(function(e,t){e.startAngle=e.originalStartAngle,e.endAngle=e.originalEndAngle}),f.call(function(t){t.transition().delay(function(e,t){var i=0,s=0,o=0;for(o=t+1;o<n.length;o++)typeof r[n[o]].viewcount!="undefined"?s+=r[n[o]].viewcount:s+=r[n[o]];return i=s/g*h,i}).duration(function(e,t){var n=0;return n=e.value/g*h,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.startAngle=n(e),u(t)}})}),e.d3.select(this.viewClass+" "+d+" svg text").text(g)):(a=e.d3.layout.pie().
startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){var n=r[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),o=e.d3.select(this.viewClass+" "+d).append("svg").attr("class","pie").attr("width",t.width+t.margin.left+t.margin.right).attr("height",t.height+t.margin.top+t.margin.bottom).append("g").attr("class","overall").attr("height",t.height+t.margin.top+t.margin.bottom).attr("width",l*2).attr("transform","translate("+t.width/2+", "+l+")"),f=o.datum(n).selectAll("path").data(a).enter().append("path").attr("data-source",function(e){return e.data}).on("mouseenter",function(e,t){var n=this.get("container"),r,i;r=n.all(".source-breakdown-right .referrer-row"),i=n.all(".source-breakdown-left .pie-chart .overall path"),r.removeClass("temp-selected"),r.getDOMNodes()[t].setAttribute("class",r.getDOMNodes()[t].getAttribute("class")+" temp-selected"),i.setAttribute("class","not-selected"),i.getDOMNodes()[t].setAttribute("class","")}.bind(this)).on("mouseleave",function(e,t){var n=this.get("container"),r,i;r=n.all(".source-breakdown-right .referrer-row"),i=n.all(".source-breakdown-left .pie-chart .overall path"),r.removeClass("temp-selected"),i.setAttribute("class","")}.bind(this)).transition().delay(function(e,t){var i=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof r[n[o]].viewcount!="undefined"?s+=r[n[o]].viewcount:s+=r[n[o]];i=s/g*h}return i}).duration(function(e,t){var n=0;return n=e.value/g*h,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.endAngle=n(e),u(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle}),o.append("text").attr("transform","translate(0, 5)").attr("fill-opacity",0).text(g).transition().delay(h/2).duration(h/2).attr("fill-opacity",1))},createPieChart:function(t,n,r,i,s,o,u){u||(u=!1);var a,f,l,c,h=this.get("outerRadius"),p=this.get("innerRadius"),d=501,v=this.get("container"),m=".sources-pie-chart",g=v.one(m).one("svg ."+t),y,b=0,w=r.length;return r.forEach(function(e){var t=i[e];typeof t.viewcount!="undefined"&&(t=t.viewcount),b+=t}),y=e.d3.scale.linear().domain([1,r.length]).range(["#00aaff","#18297f"]),f=e.d3.svg.arc().innerRadius(p).outerRadius(h),g?u===!0?b===0?(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){return 1}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.datum(r).selectAll("path").call(function(t){t.transition().delay(function(e,t){var n=0,i=0,s=0;for(s=t+1;s<r.length;s++)i+=1;return n=i/w*d,n}).duration(function(e,t){var n=0;return n=e.value/w*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})})):(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.datum(r).selectAll("path").call(function(t){t.transition().delay(function(e,t){var n=0,s=0,o=0;for(o=t+1;o<r.length;o++)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];return n=s/b*d,n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})})):u==="fakeClose"?(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(-2*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.datum(r).selectAll("path").call(function(t){t.transition().delay(function(e,t){var n=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];n=s/b*d}return n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.startAngle=n(e),f(t)}})})):(l=e.d3.layout.pie().startAngle(2*Math.PI).endAngle(0*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg ."+t),c=a.selectAll("path"),c.data().map(function(e,t){e.startAngle=e.originalStartAngle,e.endAngle=e.originalEndAngle}),c.call(function(t){t.transition().delay(function(e,t){var n=0,s=0,o=0;for(o=t+1;o<r.length;o++)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];return n=s/b*d,n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.endAngle,t.startAngle);return function(e){return t.startAngle=n(e),f(t)}})}),e.d3.select(this.viewClass+" "+m+" svg text").text(b)):(b===0?(l=e.d3.layout.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){return 1}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg").append("g").attr("class",t).attr("referrerkey",s).attr("parentreferrerkey",o).attr("height",n.height+n.margin.top+n.margin.bottom).attr("width",h*2).attr("transform","translate("+n.width/2+", "+h+")"),c=a.datum(r).selectAll("path").data(l).enter().append("path").attr("data-source",function(e){var t=e.data;if(s==="flickr"||s==="other"||s==="flickr embedr")t="";return t}).attr("fill",function(e,t){var n="";if(s==="flickr"||s==="other"||s==="flickr embedr"||o)n=y(t);return n}).transition().delay(function(e,t){var n=0,r=0,i=0;if(t>0){for(i=t-1;i>=0;--i)r+=1;n=r/w*d}return n}).duration(function(e,t){var n=0;return n=e.value/w*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})):(l=e.d3.
layout.pie().startAngle(0*Math.PI).endAngle(2*Math.PI).value(function(e,t){var n=i[e];return typeof n.viewcount!="undefined"&&(n=n.viewcount),n}).sort(null),a=e.d3.select(this.viewClass+" "+m+" svg").append("g").attr("class",t).attr("referrerkey",s).attr("parentreferrerkey",o).attr("height",n.height+n.margin.top+n.margin.bottom).attr("width",h*2).attr("transform","translate("+n.width/2+", "+h+")"),c=a.datum(r).selectAll("path").data(l).enter().append("path").attr("data-source",function(e){var t=e.data;if(s==="flickr"||s==="other"||s==="flickr embedr")t="";return t}).attr("fill",function(e,t){var n="";if(s==="flickr"||s==="other"||s==="flickr embedr"||o)n=y(t);return n}).on("mouseenter",function(e,n){var r=this.get("container"),i,u,a;o?(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown-row[data-parentcategory="'+o+'"][data-referrer="'+s+'"] .referrer-row-breakdown-row-breakdown-row:not(.not-shown)'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path'),i.removeClass("selected"),a=i.getDOMNodes()[n],a&&a.setAttribute("class","referrer-row-breakdown-row-breakdown-row temp-selected")):(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown[data-group="'+s+'"] .referrer-row-breakdown-row'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path'),i.removeClass("selected"),i.getDOMNodes()[n].setAttribute("class","referrer-row-breakdown-row temp-selected")),u.setAttribute("class","not-selected"),u.getDOMNodes()[n].setAttribute("class","")}.bind(this)).on("mouseleave",function(e,n){var r=this.get("container"),i,u;o?(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown-row[data-parentcategory="'+o+'"][data-referrer="'+s+'"] .referrer-row-breakdown-row-breakdown-row'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path')):(i=r.all('.source-breakdown-right .referrer-row .referrer-row-breakdown[data-group="'+s+'"] .referrer-row-breakdown-row'),u=r.all(".source-breakdown-left .pie-chart ."+t+'[referrerkey="'+s+'"] path')),i.removeClass("temp-selected"),u.setAttribute("class","")}.bind(this)).transition().delay(function(e,t){var n=0,s=0,o=0;if(t>0){for(o=t-1;o>=0;--o)typeof i[r[o]].viewcount!="undefined"?s+=i[r[o]].viewcount:s+=i[r[o]];n=s/b*d}return n}).duration(function(e,t){var n=0;return n=e.value/b*d,n}).ease("linear").attrTween("d",function(t){var n=e.d3.interpolate(t.startAngle,t.endAngle);return function(e){return t.endAngle=n(e),f(t)}}).each("end",function(e,t){e.originalStartAngle=e.startAngle,e.originalEndAngle=e.endAngle})),e.d3.select(this.viewClass+" "+m+" svg text").text(b)),a},createReferrerBreakdownListRowsHTML:function(t,n,r,i){var s=this,o="",u,a,f=5;return u=Object.keys(t),a=e.d3.scale.linear().domain([0,u.length-1]).range(["#00aaff","#18297f"]),o='<div class="referrer-row-breakdown-row-breakdown">',u.forEach(function(r,i){var u,l,c,h="",p=!1,d=t[r].viewcount;u="referrer-row-breakdown-row-breakdown-row",i>=f&&(u+=" not-shown"),l=e.Escape.html(t[r].displaytext);if(l.toLowerCase()==="direct"||l==="/")t[r].platform&&(l=t[r].platform.split(".")[1]),t[r].link&&t[r].link!==""&&t[r].link!=="/"&&(l=t[r].link);t[r].link&&t[r].link!==""&&t[r].link!=="/"&&(p=!0,c=e.Escape.html(t[r].link)),h=' style="background: '+a(i)+';"',p?o+='<a class="'+u+'" title="'+l+'" href="'+c+'" target="_blank">':o+='<div class="'+u+'" title="'+l+'">',o+='<div><span class="dot"'+h+"></span>"+l+"</div>",o+="<div>"+s.intlMessage({intlName:"stats.NUMBER",num:d})+"</div>",o+="<div>"+Math.round(d/n*100)+"%</div>",p?o+="</a>":o+="</div>"}),u.length>f&&(o+='<div class="show-whole-list">'+s.intlMessage({intlName:"stats.SHOW_ALL"})+"</div>"),o+="</div>",o},createReferrerListRowsHTML:function(t,n,r,i){var s="",o=this,u,a="";return u=e.d3.scale.linear().domain([0,t.length-1]).range(["#00aaff","#18297f"]),t.forEach(function(e,t){var f=n[e],l=e;l.toLowerCase()==="sets"&&(l="Albums"),typeof f.viewcount!="undefined"&&(f=f.viewcount);if(i==="flickr"||i==="other"||i==="flickr embedr")a=' style="background: '+u(t)+';"';s+='<div class="referrer-row-breakdown-row" title="'+l+'" data-parentcategory="'+i+'" data-referrer="'+e+'" data-isempty="'+!n[e].items+'">',s+='<div class="header">',n[e].items?s+='<div><span class="dot"'+a+"></span>"+l+'<span class="caret"></span></div>':s+='<div><span class="dot"'+a+"></span>"+l+"</div>",s+="<div>"+o.intlMessage({intlName:"stats.NUMBER",num:f})+"</div>",r>0?s+="<div>"+Math.round(f/r*100)+"%</div>":s+="<div>0%</div>",s+="</div>",n[e].items&&(s+=o.createReferrerBreakdownListRowsHTML(n[e].items,f,i,e)),s+="</div>"}),s},createOtherReferrerListRowsHTML:function(t,n,r,i){var s=this,o="",u;return u=e.d3.scale.linear().domain([0,t.length-1]).range(["#00aaff","#18297f"]),t.forEach(function(t,a){var f,l,c="",h=!1,p=n[t].viewcount;f=e.Escape.html(n[t].displaytext);if(f.toLowerCase()==="direct"||f==="/")n[t].platform&&(f=n[t].platform.split(".")[1]),n[t].link&&n[t].link!==""&&n[t].link!=="/"&&(f=n[t].link);n[t].link&&n[t].link!==""&&n[t].link!=="/"&&(h=!0,l=e.Escape.html(n[t].link)),c=' style="background: '+u(a)+';"',h?o+='<a class="referrer-row-breakdown-row" title="'+f+'" href="'+l+'" target="_blank" data-parentcategory="'+i+'">':o+='<div class="referrer-row-breakdown-row" title="'+f+'" data-parentcategory="'+i+'">',o+='<div class="header">',o+='<div><span class="dot"'+c+"></span>"+f+'<span class="caret"></span></div>',o+="<div>"+s.intlMessage({intlName:"stats.NUMBER",num:p})+"</div>",o+="<div>"+Math.round(p/r*100)+"%</div>",o+="</div>",h?o+="</a>":o+="</div>"}),o},destructor:function(){this.tooltip&&(this.showTooltip=!1,this.tooltip.close(),this.tooltip=undefined)}},{ATTRS:{innerRadius:{value:29},outerRadius:{value:0}}})},"@VERSION@",{requires:["flickr-view","flickrui-css","hermes-template-stats-photo","photo-sidebar-actions-css","stats-photo-css","pika-day-css","moment","timezone-helper","stats-helper","photo-models","photo-engagement-models","photo-stats-models","stats-photo-daily-views-models"
,"stats-referrer-domains-models"],optional:[],langBundles:["common","stats","pika-day","photo-page-scrappy"]});
YUI.add("hermes-lang-stats_zh-hant-hk",function(e,t){e.Intl.add("hermes/stats","zh-Hant-HK",{STATS:["\u7d71\u8a08\u8cc7\u6599"],NUMBER:[{type:"number",valueName:"num"}],NUMBER_VIEWS:[{type:"number",valueName:"num"}," \u6b21\u6aa2\u8996"],NUMBER_FAVES:[{type:"number",valueName:"num"}," \u500b\u6700\u611b"],NUMBER_COMMENTS:[{type:"number",valueName:"num"}," \u5247\u7559\u8a00"],VIEW_COUNTS:["\u6aa2\u8996\u6b21\u6578"],SO_FAR_TODAY:["\u4eca\u5929\u81f3\u76ee\u524d\u70ba\u6b62"],SO_FAR_TODAY_DOT_DOT_DOT:["\u4eca\u5929\u81f3\u76ee\u524d\u70ba\u6b62..."],YESTERDAY:["\u6628\u5929"],ALL_TIME:["\u6240\u6709\u6642\u9593"],PHOTOS_AND_VIDEOS:["\u76f8\u7247\u548c\u5f71\u7247"],PHOTOS:["\u76f8\u7247"],VIDEOS:["\u5f71\u7247"],PHOTOSTREAM:["\u6240\u6709\u76f8\u7247"],ALBUMS:["\u76f8\u7c3f"],COLLECTIONS:["\u73cd\u85cf\u96c6"],GALLERIES:["\u535a\u89bd\u9928"],TOTAL:["\u7e3d\u8a08"],TOP_PHOTOS_AND_VIDEOS:["\u71b1\u9580\u76f8\u7247\u548c\u5f71\u7247"],CONTENT_BREAKDOWN:["\u5167\u5bb9\u5206\u6790<span>(",{type:"number",valueName:"num"}," \u500b\u9805\u76ee)</span>"],VIEWS:["\u6aa2\u8996\u6b21\u6578"],ALL_TIME_VIEWS:["\u6240\u6709\u6642\u9593\u7684\u6aa2\u8996\u6b21\u6578"],ALL_TIME_FAVES:["\u5168\u90e8\u52a0\u5165\u6700\u611b\u7684\u6b21\u6578"],ALL_TIME_COMMENTS:["\u5168\u90e8\u7559\u8a00\u7684\u6578\u91cf"],DATE:["\u65e5\u671f"],INTERESTINGNESS:["Interestingness"],FAVORITES:["\u6700\u611b"],COMMENTS:["\u7559\u8a00"],RECENT_VIEWS:["\u6700\u8fd1\u7684\u6aa2\u8996\u6b21\u6578"],RECENT_FAVES:["\u6700\u8fd1\u7684\u52a0\u5165\u6700\u611b\u6b21\u6578"],RECENT_COMMENTS:["\u6700\u8fd1\u7684\u7559\u8a00\u6578\u91cf"],BACK_TO_STATS:["\u8fd4\u56de\u7d71\u8a08\u8cc7\u6599"],SOURCE_BREAKDOWN:["\u4f86\u6e90\u5206\u6790"],ALL_PHOTO_AND_VIDEOS_LINK:["\u6240\u6709\u76f8\u7247\u548c\u5f71\u7247"],VISITS:["\u700f\u89bd\u6b21\u6578"],PRO_UNTIL_DATE:["\u5728 ","${date}"," \u524d\u4f7f\u7528 PRO"],PRO_SINCE_DATE:["\u7531 ","${date}"," \u8d77\u4f7f\u7528 PRO"],PRO_SINCE_MONTHYEAR:["\u7531 ",{type:"date",valueName:"intlDate",format:"monthYear"}," \u8d77\u4f7f\u7528 PRO"],PRO_UNTIL_MONTHYEAR:["\u4f60\u53ef\u4f7f\u7528 PRO \u76f4\u81f3 ",{type:"date",valueName:"intlDate",format:"monthYear"}],LEARN_MORE:["\u4e86\u89e3\u66f4\u591a"],CURRENT_STATS_DATE:["\u7d71\u8a08\u8cc7\u6599\u4ee5 GMT \u6642\u9593\u986f\u793a\uff0c\u76ee\u524d\u6642\u9593\u70ba ","${date}"," ","${time}"],CURRENT_STATS_LONGDATE:["\u7d71\u8a08\u8cc7\u6599\u4ee5 GMT \u6642\u9593\u986f\u793a\uff0c\u76ee\u524d\u6642\u9593\u70ba ",{type:"date",valueName:"intlDate",format:"long"}," ","${time}"],SPACE_USED_LIMITED:["(\u5df2\u4f7f\u7528 ","${used}","\uff0c\u5171 ","${total}",")"],SPACE_USED_UNLIMITED:["(\u5df2\u4f7f\u7528 ","${used}","\uff0c\u6c92\u6709\u5bb9\u91cf\u9650\u5236)"],PUBLIC:["\u516c\u958b"],FRIENDS:["\u670b\u53cb"],FAMILY:["\u5bb6\u4eba"],FF:["\u670b\u53cb\u548c\u5bb6\u4eba"],PRIVATE:["\u79c1\u4eba"],TAGGED:["\u5df2\u52a0\u5165\u6a19\u7c64"],GEOTAGGED:["\u5df2\u52a0\u5165\u5730\u7406\u6a19\u7c64"],IN_ALBUMS:["\u76f8\u7c3f\u4e2d"],IN_GROUPS:["\u7fa4\u7d44\u4e2d"],VIEWED:["\u5df2\u6aa2\u8996"],FAVED:["\u5df2\u52a0\u5165\u6700\u611b"],COMMENTED:["\u5df2\u7559\u8a00"],NO_SOURCES_TODAY:["\u6c92\u6709\u9019\u5929\u7684\u4f86\u6e90"],NO_VIEWS_TODAY:["\u4eca\u5929\u6c92\u6709\u4eba\u6aa2\u8996\u4f60\u7684\u76f8\u7247"],PERCENTAGE_OF_VIEWS:[{type:"number",valueName:"num"},"% \u7684\u6aa2\u8996\u6b21\u6578"],PERCENTAGE_OF_FAVES:[{type:"number",valueName:"num"},"% \u7684\u6700\u611b"],PERCENTAGE_OF_COMMENTS:[{type:"number",valueName:"num"},"% \u7684\u7559\u8a00"],TODAY:["\u4eca\u5929"],SOURCES:["\u4f86\u6e90"],LOAD_MORE:["\u8f09\u5165\u66f4\u591a"],NEXT:["\u4e0b\u4e00\u9801"],PREVIOUS:["\u4e0a\u4e00\u9801"],MEDIA:["\u5a92\u9ad4"],VISIBILITY:["\u53ef\u898b\u5ea6"],ALPHA_LABEL:["\u7d71\u8a08\u8cc7\u6599 Alpha"],BETA_LABEL:["\u7d71\u8a08\u8cc7\u6599 Beta"],SHOW_ALL:["\u986f\u793a\u5168\u90e8"],PHOTO_STATS:["\u76f8\u7247\u7d71\u8a08\u8cc7\u6599"],EXPAND_ALL:["\u5c55\u958b\u4ee5\u986f\u793a\u6240\u6709\u9805\u76ee"],COLLAPSE_ALL:["\u6536\u5408\u4ee5\u96b1\u85cf\u6240\u6709\u9805\u76ee"],NO_PHOTO_STATS_AVAILABLE:["\u9019\u5f35\u76f8\u7247\u6c92\u6709\u7d71\u8a08\u8cc7\u6599"],NO_RECENT_PHOTO_STATS_AVAILABLE:["\u9019\u5f35\u76f8\u7247\u6c92\u6709\u8fd1\u671f\u7684\u7d71\u8a08\u8cc7\u6599"],WELCOME_TO_STATS:["\u6b61\u8fce\u67e5\u770b\u7d71\u8a08\u8cc7\u6599"],WELCOME_MODAL_SCREEN_1:["\u8f15\u9b06\u67e5\u770b\u6240\u6709\u8cc7\u6599"],WELCOME_MODAL_SCREEN_2:["\u66f4\u5f37\u5927\u7684\u700f\u89bd\u529f\u80fd"],WELCOME_MODAL_SCREEN_3:["\u66f4\u5b8c\u5584\u7684\u8cc7\u6599\u3001\u985e\u5225\u548c\u793e\u4ea4\u8cc7\u6599\u4f86\u6e90"],WELCOME_MODAL_SCREEN_2_QUICK:["\u900f\u904e\u52a0\u5f37\u7684\u700f\u89bd\u529f\u80fd\uff0c\u5feb\u901f\u5b58\u53d6\u4f60\u7684\u8cc7\u6599"],WORKING_ON_IT:["\u6211\u5011\u6b63\u5728\u8655\u7406"],STATS_LOADING:["\u6211\u5011\u76ee\u524d\u7121\u6cd5\u986f\u793a\u7d71\u8a08\u8cc7\u6599\uff0c\u8acb\u518d\u8a66\u4e00\u6b21\u3002"]})},"@VERSION@",{requires:["intl"]});
YUI.add("hermes-lang-pika-day_zh-hant-hk",function(e,t){e.Intl.add("hermes/pika-day","zh-Hant-HK",{DATE_FORMAT:["DD-MM-YYYY"],PREVIOUS_MONTH:["\u4e0a\u4e00\u6708"],NEXT_MONTH:["\u4e0b\u4e00\u6708"],JANUARY:["1 \u6708"],FEBRUARY:["2 \u6708"],MARCH:["3 \u6708"],APRIL:["4 \u6708"],MAY:["5 \u6708"],JUNE:["6 \u6708"],JULY:["7 \u6708"],AUGUST:["8 \u6708"],SEPTEMBER:["9 \u6708"],OCTOBER:["10 \u6708"],NOVEMBER:["11 \u6708"],DECEMBER:["12 \u6708"],SUNDAY:["\u661f\u671f\u65e5"],MONDAY:["\u661f\u671f\u4e00"],TUESDAY:["\u661f\u671f\u4e8c"],WEDNESDAY:["\u661f\u671f\u4e09"],THURSDAY:["\u661f\u671f\u56db"],FRIDAY:["\u661f\u671f\u4e94"],SATURDAY:["\u661f\u671f\u516d"],SUNDAY_SHORT:["\u65e5"],MONDAY_SHORT:["\u4e00"],TUESDAY_SHORT:["\u4e8c"],WEDNESDAY_SHORT:["\u4e09"],THURSDAY_SHORT:["\u56db"],FRIDAY_SHORT:["\u4e94"],SATURDAY_SHORT:["\u516d"]})},"@VERSION@",{requires:["intl"]});
