YUI.add("hermes-template-fluid-share-loading-state",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s;return"<!-- okay, not ideal, but this is just a loading state so we inline some styles -->\n<style>\n@keyframes pinkBall{0%{z-index:1}50%{-webkit-transform:translateX(12px);transform:translateX(12px)}}\n@-webkit-keyframes pinkBall{0%{z-index:1}50%{-webkit-transform:translateX(12px);transform:translateX(12px)}}\n@keyframes blueBall{50%{-webkit-transform:translateX(-12px);transform:translateX(-12px)}}\n@-webkit-keyframes blueBall{50%{-webkit-transform:translateX(-12px);transform:translateX(-12px)}}\n.fluid .balls{position:relative;width:24px;height:12px;margin:0 auto;display:inline-block}.fluid .balls::before,.fluid .balls::after{position:absolute;top:0;width:12px;height:12px;content:'';border-radius:100%;-webkit-animation:pinkBall 1.6s ease-in-out infinite;animation:pinkBall 1.6s ease-in-out infinite}.fluid .balls::before{background:#ff329c;left:0}.fluid .balls::after{-webkit-animation:blueBall 1.6s ease-in-out infinite;animation:blueBall 1.6s ease-in-out infinite;background:#0063dc;right:0}#yui3-css-stamp.fluid-balls-css{display:none}\n\n.fluid.sharing-loader .balls {\n	margin: 80px auto;\n	display: block;\n}\n</style>\n\n\n<div class=\"sharing-loader fluid\">\n"+((s=e.invokePartial(r["flickr-balls"],t,{name:"flickr-balls",data:i,indent:"	",helpers:n,partials:r,decorators:e.decorators}))!=null?s:"")+"</div>"},usePartial:!0,useData:!0}),r={};e.Array.each(["flickr-balls"],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-loading-state",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-flickr-balls"]});
YUI.add("hermes-template-fluid-share-panel",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return" sharing-type-disabled"},3:function(e,t,n,r,i){return" sharing-type-enabled"},5:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.canNotShareTitle:s,t))+'"'},7:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canNotShareTitle:s,t))+'"'},9:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canNotShareTitle:s,t))+'"'},11:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canNotShareTitle:s,t))+'"'},13:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.canNotShareTitle:s,t))+'"'},15:function(e,t,n,r,i){return" single-link-field"},17:function(e,t,n,r,i){return" single-link"},19:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing;return((s=(n.isFlipped||t&&t.isFlipped||u).call(o,"enable-embedr-in-share",{name:"isFlipped",hash:{},fn:e.program(20,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=(n.isNotFlipped||t&&t.isNotFlipped||u).call(o,"enable-embedr-in-share",{name:"isNotFlipped",hash:{},fn:e.program(23,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.linkShareDisplay:t)!=null?s.bbCode:s,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.noop,data:i}))!=null?s:"")},20:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=t!=null?t.linkShareDisplay:t)!=null?s.embedr:s,{name:"if",hash:{},fn:e.program(21,i,0),inverse:e.noop,data:i}))!=null?s:""},21:function(e,t,n,r,i){return'									<span class="link-type-button embed-type-button">'+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{intlName:"share-modal.EMBED"},data:i}))+"</span>\n"},23:function(e,t,n,r,i){var s,o=t!=null?t:{};return((s=n["if"].call(o,(s=t!=null?t.linkShareDisplay:t)!=null?s.embedr:s,{name:"if",hash:{},fn:e.program(24,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.linkShareDisplay:t)!=null?s.iframe:s,{name:"if",hash:{},fn:e.program(26,i,0),inverse:e.noop,data:i}))!=null?s:"")},24:function(e,t,n,r,i){return'									<span class="link-type-button embed-type-button">HTML</span>\n'},26:function(e,t,n,r,i){return'									<span class="link-type-button iframe-type-button">IFRAME</span>\n'},28:function(e,t,n,r,i){return'								<span class="link-type-button bbcode-type-button">'+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{intlName:"share-modal.BBCODE"},data:i}))+"</span>\n"},30:function(e,t,n,r,i){return" single-highlight"},32:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'						<div class="grab-link-only grab-link">\n\n'+((s=n["if"].call(u,t!=null?t.canHaveGuestpass:t,{name:"if",hash:{},fn:e.program(33,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n							<input readonly type="text" class="grab-link-text-field" value="'+l((o=(o=n.grabLink||(t!=null?t.grabLink:t))!=null?o:a,typeof o===f?o.call(u,{name:"grabLink",hash:{},data:i}):o))+'">\n\n							<div class="grab-link-loader '+((s=n.unless.call(u,t!=null?t.canHaveGuestpass:t,{name:"unless",hash:{},fn:e.program(36,i,0),inverse:e.noop,data:i}))!=null?s:"")+" "+((s=n.unless.call(u,t!=null?t.choiceOfPermission:t,{name:"unless",hash:{},fn:e.program(38,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"><div class="balls"></div></div>\n\n							<div class="grab-link-reminders">\n								<div class="grab-link-privacy-reminder hide-reminder'+((s=n["if"].call(u,t!=null?t.canHaveGuestpass:t,{name:"if",hash:{},fn:e.program(40,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">'+l((o=(o=n.privacyWarningString||(t!=null?t.privacyWarningString:t))!=null?o:a,typeof o===f?o.call(u,{name:"privacyWarningString",hash:{},data:i}):o))+"</div>\n								"+((s=n["if"].call(u,t!=null?t.showDownloadWarning:t,{name:"if",hash:{},fn:e.program(42,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n							</div>\n\n						</div>\n"},33:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.choiceOfPermission:t,{name:"if",hash:{},fn:e.program(34,i,0),inverse:e.noop,data:i}))!=null?s:""},34:function(e,t,n,r,i){var s;return'								<div class="grab-link-permission-field grab-link-field">\n									<span class="grab-link-permission-label">'+e.escapeExpression((s=(s=n.grabLinkDefaultPermission||(t!=null?t.grabLinkDefaultPermission:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"grabLinkDefaultPermission",hash:{},data:i}):s))+'</span>\n									<span class="dropdown-arrow"></span>\n								</div>\n'},36:function(e,t,n,r,i){return" no-permission-loader"},38:function(e,t,n,r,i){return"no-permission-loader"},40:function(e,t,n,r,i){return" with-guestpasses "},42:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'<div class="grab-link-download-reminder">'+a((s=(s=n.downloadAccessString||(t!=null?t.downloadAccessString:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"downloadAccessString",hash:{},data:i}):s))+" "+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{url:"/account/prefs/downloads/",intlName:"share-modal.CHANGE_DOWNLOAD_PREF"},data:i}))+"</div>"},44:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'						<div class="sliding-frame">\n\n							<div class="link-type-content grab-link">\n\n'+((s=n["if"].call(u,t!=null?t.canHaveGuestpass:t,{name:"if",hash:{},fn:e.program(45,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n								<input readonly type="text" class="grab-link-text-field" value="'+
l((o=(o=n.grabLink||(t!=null?t.grabLink:t))!=null?o:a,typeof o===f?o.call(u,{name:"grabLink",hash:{},data:i}):o))+'">\n\n								<div class="grab-link-loader '+((s=n.unless.call(u,t!=null?t.choiceOfPermission:t,{name:"unless",hash:{},fn:e.program(38,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"><div class="balls"></div></div>\n\n								<div class="grab-link-reminders">\n									<div class="grab-link-privacy-reminder '+((s=n.unless.call(u,t!=null?t.canHaveGuestpass:t,{name:"unless",hash:{},fn:e.program(48,i,0),inverse:e.program(40,i,0),data:i}))!=null?s:"")+'">'+l((o=(o=n.privacyWarningString||(t!=null?t.privacyWarningString:t))!=null?o:a,typeof o===f?o.call(u,{name:"privacyWarningString",hash:{},data:i}):o))+"</div>\n									"+((s=n["if"].call(u,t!=null?t.showDownloadWarning:t,{name:"if",hash:{},fn:e.program(42,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n								</div>\n\n							</div>\n\n"+((s=n["if"].call(u,(s=t!=null?t.linkShareDisplay:t)!=null?s.embedr:s,{name:"if",hash:{},fn:e.program(50,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(u,(s=t!=null?t.linkShareDisplay:t)!=null?s.iframe:s,{name:"if",hash:{},fn:e.program(52,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(u,(s=t!=null?t.linkShareDisplay:t)!=null?s.bbCode:s,{name:"if",hash:{},fn:e.program(54,i,0),inverse:e.noop,data:i}))!=null?s:"")+"						</div>\n\n"},45:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.choiceOfPermission:t,{name:"if",hash:{},fn:e.program(46,i,0),inverse:e.noop,data:i}))!=null?s:""},46:function(e,t,n,r,i){var s;return'									<div class="grab-link-permission-field grab-link-field">\n										<span class="grab-link-permission-label">'+e.escapeExpression((s=(s=n.grabLinkDefaultPermission||(t!=null?t.grabLinkDefaultPermission:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"grabLinkDefaultPermission",hash:{},data:i}):s))+'</span>\n										<span class="dropdown-arrow"></span>\n									</div>\n'},48:function(e,t,n,r,i){return" hide-reminder"},50:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'								<div class="link-type-content html-embed">\n									<div class="embed-code-size-field embed-size-field">\n										<span class="embed-code-label">\n										'+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.defaultSizeStr:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'\n										</span>\n										<span class="dropdown-arrow"></span>\n									</div>\n									<input readonly type="text" class="embed-code-text-field" value="'+a((s=(s=n.defaultEmbedrCode||(t!=null?t.defaultEmbedrCode:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"defaultEmbedrCode",hash:{},data:i}):s))+'">\n\n								</div>\n'},52:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'								<div class="link-type-content html-iframe-embed">\n									<div class="iframe-code-size-field embed-size-field">\n										<span class="embed-code-label">\n										'+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.defaultIframeSizeStr:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'\n										</span>\n										<span class="dropdown-arrow"></span>\n									</div>\n									<input readonly type="text" class="iframe-code-text-field" value="'+a((s=(s=n.defaultIframeCode||(t!=null?t.defaultIframeCode:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"defaultIframeCode",hash:{},data:i}):s))+'">\n								</div>\n'},54:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'								<div class="link-type-content html-bb-embed">\n									<input readonly type="text" class="bb-code-text-field" value="'+a((s=(s=n.defaultBBCode||(t!=null?t.defaultBBCode:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"defaultBBCode",hash:{},data:i}):s))+'">\n									<div class="bb-code-size-field embed-size-field">\n										<span class="embed-code-label">\n											'+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.defaultBBCodeSizeStr:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'\n										</span>\n										<span class="dropdown-arrow"></span>\n									</div>\n								</div>\n'},56:function(e,t,n,r,i){var s;return'				<div class="mail-perm-field">\n					<span class="mail-permission-label">'+e.escapeExpression((s=(s=n.grabLinkDefaultPermission||(t!=null?t.grabLinkDefaultPermission:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"grabLinkDefaultPermission",hash:{},data:i}):s))+'</span>\n					<span class="dropdown-arrow"></span>\n				</div>\n'},58:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.nonPublicWarning:t,{name:"if",hash:{},fn:e.program(59,i,0),inverse:e.noop,data:i}))!=null?s:""},59:function(e,t,n,r,i){return'						<div class="tertiary non-public-warning">'+e.escapeExpression((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||n.helperMissing).call(t!=null?t:{},t!=null?t.nonPublicWarning:t,{name:"renderTrustedMarkup",hash:{},data:i}))+"</div>\n"},61:function(e,t,n,r,i){return"make-room-for-dropdown"},63:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.nonPublicWarning:t,{name:"if",hash:{},fn:e.program(64,i,0),inverse:e.noop,data:i}))!=null?s:""},64:function(e,t,n,r,i){return"make-room-for-warning"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=e.lambda,a=e.escapeExpression,f=t!=null?t:{},l=n.helperMissing;return'<div class="share-panel-body">\n	<div class="share-panels">\n\n		<div class="main-sharing-panel share-panel">\n			<div class="network-buttons">\n				<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.className:s,t))+"\n\n				"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+'"\n\n				'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses
:t)!=null?s.facebook:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n					<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.className:s,t))+'-icon"></span>\n					<span class="share-link-label">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.FACEBOOK"},data:i}))+'</span>\n				</span>\n				<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.className:s,t))+"\n\n				"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+'"\n\n				'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n					<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.className:s,t))+'-icon"></span>\n					<span class="share-link-label">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.TUMBLR"},data:i}))+'</span>\n				</span>\n				<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.className:s,t))+"\n\n				"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+'"\n\n				'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(9,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n					<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.className:s,t))+'-icon"></span>\n					<span class="share-link-label">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.TWITTER"},data:i}))+'</span>\n				</span>\n				<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.className:s,t))+"\n\n				"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+'"\n\n				'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(11,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n					<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.className:s,t))+'-icon"></span>\n					<span class="share-link-label">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.PINTEREST"},data:i}))+'</span>\n				</span>\n				<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.className:s,t))+"\n\n				"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+'"\n\n				'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(13,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n					<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.className:s,t))+'-icon"></span>\n					<span class="share-link-label">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.MAIL"},data:i}))+'</span>\n				</span>\n			</div>\n\n			<div class="link-instructions '+((s=n["if"].call(f,t!=null?t.moveInstructionsUp:t,{name:"if",hash:{},fn:e.program(15,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n				'+a((o=(o=n.copyMessage||(t!=null?t.copyMessage:t))!=null?o:l,typeof o=="function"?o.call(f,{name:"copyMessage",hash:{},data:i}):o))+'\n			</div>\n\n			<div class="share-link-types first-stop">\n\n					<div class="link-type-buttons">\n\n						<span class="link-type-button link-grab-type-button '+((s=n["if"].call(f,t!=null?t.hideButtons:t,{name:"if",hash:{},fn:e.program(17,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.GRAB_LINK"},data:i}))+"</span>\n\n"+((s=n.unless.call(f,t!=null?t.hideButtons:t,{name:"unless",hash:{},fn:e.program(19,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n						<span class="link-type-highlight '+((s=n["if"].call(f,t!=null?t.hideButtons:t,{name:"if",hash:{},fn:e.program(30,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"></span>\n\n					</div>\n\n\n				<div class="link-type-contents">\n'+((s=n["if"].call(f,t!=null?t.hideButtons:t,{name:"if",hash:{},fn:e.program(32,i,0),inverse:e.program(44,i,0),data:i}))!=null?s:"")+'\n				</div>\n			</div>\n		</div>\n\n\n		<div class="email-sharing-panel share-panel">\n\n			<div class="message-form">\n				<div class="fake-input">\n					<input type="text" class="email-recipient-text-field" placeholder="'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.SCREEN_NAME_OR_EMAIL"},data:i}))+'" data-field="recipient">\n				</div>\n\n'+((s=n["if"].call(f,t!=null?t.showMailPerms:t,{name:"if",hash:{},fn:e.program(56,i,0),inverse:e.program(58,i,0),data:i}))!=null?s:"")+'\n				<textarea class="email-message-text-field '+((s=n["if"].call(f,t!=null?t.showMailPerms:t,{name:"if",hash:{},fn:e.program(61,i,0),inverse:e.program(63,i,0),data:i}))!=null?s:"")+'" placeholder="'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"share-modal.INCLUDE_A_MESSAGE"},data:i}))+'"></textarea>\n			</div>\n\n			<button disabled class="share-by-email mini">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage"
,hash:{intlName:"share-modal.FLICKR_SHARE"},data:i}))+'</button>\n			<button class="leave-email-sharing mini alt">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||l).call(f,{name:"intlHTMLMessage",hash:{intlName:"common.BACK"},data:i}))+"</button>\n\n		</div>\n\n\n	</div>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-panel",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-share-panel-restyle",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return" single-link"},3:function(e,t,n,r,i){var s,o=t!=null?t:{};return((s=n["if"].call(o,(s=t!=null?t.linkShareDisplay:t)!=null?s.embedr:s,{name:"if",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.canShare:s,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,(s=t!=null?t.linkShareDisplay:t)!=null?s.bbCode:s,{name:"if",hash:{},fn:e.program(8,i,0),inverse:e.noop,data:i}))!=null?s:"")},4:function(e,t,n,r,i){return'								<span class="link-type-button embed-type-button">'+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{intlName:"share-modal.EMBED_SIMPLE"},data:i}))+"</span>\n"},6:function(e,t,n,r,i){return'							<span class="link-type-button email-type-button">'+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{intlName:"share-modal.EMAIL"},data:i}))+"</span>\n"},8:function(e,t,n,r,i){return'								<span class="link-type-button bbcode-type-button">'+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(t!=null?t:{},{name:"intlHTMLMessage",hash:{intlName:"share-modal.BBCODE"},data:i}))+"</span>\n"},10:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},(s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.canShare:s,{name:"if",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:""},12:function(e,t,n,r,i){return" single-highlight"},14:function(e,t,n,r,i){var s,o,u=e.lambda,a=e.escapeExpression,f=t!=null?t:{},l=n.helperMissing,c="function";return'						<div class="link-type-content grab-link-only grab-link">\n							<div class="network-buttons">\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(19,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.className:s,t))+'-icon"></span>\n								</span>\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(21,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.className:s,t))+'-icon"></span>\n								</span>\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(23,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.className:s,t))+'-icon"></span>\n								</span>\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(25,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.className:s,t))+'-icon"></span>\n								</span>\n							</div>\n\n\n							<input readonly type="text" class="grab-link-text-field" value="'+a((o=(o=n.grabLink||(t!=null?t.grabLink:t))!=null?o:l,typeof o===c?o.call(f,{name:"grabLink",hash:{},data:i}):o))+'">\n\n'+((s=n["if"].call(f,t!=null?t.canHaveGuestpass:t,{name:"if",hash:{},fn:e.program(27,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n							<div class="grab-link-loader '+((s=n.unless.call(f,t!=null?t.canHaveGuestpass:t,{name:"unless",hash:{},fn:e.program(30,i,0),inverse:e.noop,data:i}))!=null?s:"")+" "+((s=n.unless.call(f,t!=null?t.choiceOfPermission:t,{name:"unless",hash:{},fn:e.program(32,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"><div class="balls"></div></div>\n\n							<div class="grab-link-reminders">\n								<div class="grab-link-privacy-reminder '+((s=n.unless.call(f,t!=null?t.canHaveGuestpass:t,{name:"unless",hash:{},fn:e.program(34,i,0),inverse:e.program(36,i,0),data:i}))!=null?s:"")+'">'+a((o=(o=n.privacyWarningString||(t!=null?t.privacyWarningString:t))!=null?o:l,typeof o===c?o.call(f,{name:"privacyWarningString",hash:{},data:i}):o))+"</div>\n								"+((s=n["if"].call(f,t!=null?t.showDownloadWarning:t,{name:"if",hash:{},fn:e.program(38,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n							</div>\n\n						</div>\n\n"+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.canShare:s,{name:"if",hash:{},fn:e.program
(40,i,0),inverse:e.noop,data:i}))!=null?s:"")},15:function(e,t,n,r,i){return" sharing-type-disabled"},17:function(e,t,n,r,i){return" sharing-type-enabled"},19:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.canNotShareTitle:s,t))+'"'},21:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canNotShareTitle:s,t))+'"'},23:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canNotShareTitle:s,t))+'"'},25:function(e,t,n,r,i){var s;return' title="'+e.escapeExpression(e.lambda((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canNotShareTitle:s,t))+'"'},27:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.choiceOfPermission:t,{name:"if",hash:{},fn:e.program(28,i,0),inverse:e.noop,data:i}))!=null?s:""},28:function(e,t,n,r,i){var s;return'								<div class="grab-link-permission-field grab-link-field">\n									<span class="grab-link-permission-label">'+e.escapeExpression((s=(s=n.grabLinkDefaultPermission||(t!=null?t.grabLinkDefaultPermission:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"grabLinkDefaultPermission",hash:{},data:i}):s))+'</span>\n									<span class="dropdown-arrow"></span>\n								</div>\n'},30:function(e,t,n,r,i){return" no-permission-loader"},32:function(e,t,n,r,i){return"no-permission-loader"},34:function(e,t,n,r,i){return" hide-reminder"},36:function(e,t,n,r,i){return" with-guestpasses "},38:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'<div class="grab-link-download-reminder">'+a((s=(s=n.downloadAccessString||(t!=null?t.downloadAccessString:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"downloadAccessString",hash:{},data:i}):s))+" "+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{url:"/account/prefs/downloads/",intlName:"share-modal.CHANGE_DOWNLOAD_PREF"},data:i}))+"</div>"},40:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'							<div class="link-type-content email-sharing-panel">\n								<div class="message-form">\n									<div class="fake-input">\n										<input type="text" class="email-recipient-text-field" placeholder="'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.SCREEN_NAME_OR_EMAIL"},data:i}))+'" data-field="recipient">\n									</div>\n\n									<textarea class="email-message-text-field '+((s=n["if"].call(o,t!=null?t.showMailPerms:t,{name:"if",hash:{},fn:e.program(41,i,0),inverse:e.program(43,i,0),data:i}))!=null?s:"")+'" placeholder="'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.INCLUDE_A_MESSAGE"},data:i}))+'"></textarea>\n								</div>\n\n								<div class="button-bar">\n'+((s=n["if"].call(o,t!=null?t.showMailPerms:t,{name:"if",hash:{},fn:e.program(46,i,0),inverse:e.program(48,i,0),data:i}))!=null?s:"")+'									<button disabled class="share-by-email">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.FLICKR_SHARE"},data:i}))+"</button>\n								</div>\n							</div>\n"},41:function(e,t,n,r,i){return"make-room-for-dropdown"},43:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.nonPublicWarning:t,{name:"if",hash:{},fn:e.program(44,i,0),inverse:e.noop,data:i}))!=null?s:""},44:function(e,t,n,r,i){return"make-room-for-warning"},46:function(e,t,n,r,i){var s;return'									<div class="mail-perm-field">\n										<span class="mail-permission-label">'+e.escapeExpression((s=(s=n.grabLinkDefaultPermission||(t!=null?t.grabLinkDefaultPermission:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"grabLinkDefaultPermission",hash:{},data:i}):s))+'</span>\n										<span class="dropdown-arrow"></span>\n									</div>\n'},48:function(e,t,n,r,i){var s;return(s=n["if"].call(t!=null?t:{},t!=null?t.nonPublicWarning:t,{name:"if",hash:{},fn:e.program(49,i,0),inverse:e.noop,data:i}))!=null?s:""},49:function(e,t,n,r,i){return'											<div class="tertiary non-public-warning">'+e.escapeExpression((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||n.helperMissing).call(t!=null?t:{},t!=null?t.nonPublicWarning:t,{name:"renderTrustedMarkup",hash:{},data:i}))+"</div>\n"},51:function(e,t,n,r,i){var s,o,u=e.lambda,a=e.escapeExpression,f=t!=null?t:{},l=n.helperMissing,c="function";return'\n						<div class="link-type-content grab-link">\n\n							<div class="network-buttons">\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(19,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.facebook:s)!=null?s.className:s,t))+'-icon"></span>\n								</span>\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(21,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.tumblr:s)!=null?s.className
:s,t))+'-icon"></span>\n								</span>\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(23,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.twitter:s)!=null?s.className:s,t))+'-icon"></span>\n								</span>\n								<span class="share-link '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.className:s,t))+"\n\n								"+((s=n.unless.call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canShare:s,{name:"unless",hash:{},fn:e.program(15,i,0),inverse:e.program(17,i,0),data:i}))!=null?s:"")+'"\n\n								'+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.canNotShareTitle:s,{name:"if",hash:{},fn:e.program(25,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n\n									<span class="share-link-icon '+a(u((s=(s=t!=null?t.networkClasses:t)!=null?s.pinterest:s)!=null?s.className:s,t))+'-icon"></span>\n								</span>\n							</div>\n							<input readonly type="text" class="grab-link-text-field" value="'+a((o=(o=n.grabLink||(t!=null?t.grabLink:t))!=null?o:l,typeof o===c?o.call(f,{name:"grabLink",hash:{},data:i}):o))+'">\n\n'+((s=n["if"].call(f,t!=null?t.canHaveGuestpass:t,{name:"if",hash:{},fn:e.program(27,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n							<div class="grab-link-loader '+((s=n.unless.call(f,t!=null?t.choiceOfPermission:t,{name:"unless",hash:{},fn:e.program(32,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"><div class="balls"></div></div>\n\n							<div class="grab-link-reminders">\n								<div class="grab-link-privacy-reminder '+((s=n.unless.call(f,t!=null?t.canHaveGuestpass:t,{name:"unless",hash:{},fn:e.program(34,i,0),inverse:e.program(36,i,0),data:i}))!=null?s:"")+'">'+a((o=(o=n.privacyWarningString||(t!=null?t.privacyWarningString:t))!=null?o:l,typeof o===c?o.call(f,{name:"privacyWarningString",hash:{},data:i}):o))+"</div>\n								"+((s=n["if"].call(f,t!=null?t.showDownloadWarning:t,{name:"if",hash:{},fn:e.program(38,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n							</div>\n\n						</div>\n\n"+((s=n["if"].call(f,(s=t!=null?t.linkShareDisplay:t)!=null?s.embedr:s,{name:"if",hash:{},fn:e.program(52,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(f,(s=(s=t!=null?t.networkClasses:t)!=null?s.flickr:s)!=null?s.canShare:s,{name:"if",hash:{},fn:e.program(61,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(f,(s=t!=null?t.linkShareDisplay:t)!=null?s.bbCode:s,{name:"if",hash:{},fn:e.program(63,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"},52:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f=e.escapeExpression;return'							<div class="link-type-content html-embed">\n\n								<input readonly type="text" class="embed-code-text-field" value="'+f((o=(o=n.defaultEmbedrCode||(t!=null?t.defaultEmbedrCode:t))!=null?o:a,typeof o=="function"?o.call(u,{name:"defaultEmbedrCode",hash:{},data:i}):o))+'">\n\n								<div class="embed-demo-container '+((s=(n.ifCond||t&&t.ifCond||a).call(u,(s=t!=null?t.displayOptions:t)!=null?s.header:s,"===","true",{name:"ifCond",hash:{},fn:e.program(53,i,0),inverse:e.noop,data:i}))!=null?s:"")+" "+((s=(n.ifCond||t&&t.ifCond||a).call(u,(s=t!=null?t.displayOptions:t)!=null?s.footer:s,"===","true",{name:"ifCond",hash:{},fn:e.program(55,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">\n									<div class="embed-demo">\n									</div>\n								</div>\n\n								<div class="embed-options">\n									<div class="radio">\n										<input type="checkbox" data-setting="header" id="embedr-option-header" name="radio" '+((s=(n.ifCond||t&&t.ifCond||a).call(u,(s=t!=null?t.displayOptions:t)!=null?s.header:s,"===","true",{name:"ifCond",hash:{},fn:e.program(57,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n										<label for="embedr-option-header">\n											<div class="square"></div>\n											<span>'+f((n.intlHTMLMessage||t&&t.intlHTMLMessage||a).call(u,{name:"intlHTMLMessage",hash:{intlName:"share-modal.EMBEDR_OPTION_HEADER"},data:i}))+'</span>\n										</label>\n									</div>\n\n									<div class="radio">\n										<input type="checkbox" data-setting="footer" id="embedr-option-footer" name="radio" '+((s=(n.ifCond||t&&t.ifCond||a).call(u,(s=t!=null?t.displayOptions:t)!=null?s.footer:s,"===","true",{name:"ifCond",hash:{},fn:e.program(57,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n										<label for="embedr-option-footer">\n											<div class="square"></div>\n											<span>'+f((n.intlHTMLMessage||t&&t.intlHTMLMessage||a).call(u,{name:"intlHTMLMessage",hash:{intlName:"share-modal.EMBEDR_OPTION_FOOTER"},data:i}))+"</span>\n										</label>\n									</div>\n\n"+((s=n.unless.call(u,t!=null?t.isAlbumEmbed:t,{name:"unless",hash:{},fn:e.program(59,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n									<div class="embed-code-size-field embed-size-field">\n										<span class="embed-code-label">\n										'+f((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||a).call(u,t!=null?t.defaultSizeStr:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'\n										</span>\n										<span class="dropdown-arrow"></span>\n									</div>\n								</div> <!-- embed options-->\n\n							</div>\n'},53:function(e,t,n,r,i){return"show-header"},55:function(e,t,n,r,i){return"show-footer"},57:function(e,t,n,r,i){return'checked="true"'},59:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing;return'									<div class="radio">\n										<input type="checkbox" data-setting="context" id="embedr-option-context" name="radio" '+((s=(n.ifCond||t&&t.ifCond||u).call(o,(s=t!=null?t.displayOptions
:t)!=null?s.context:s,"===","true",{name:"ifCond",hash:{},fn:e.program(57,i,0),inverse:e.noop,data:i}))!=null?s:"")+'>\n										<label for="embedr-option-context">\n											<div class="square"></div>\n											<span>'+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.EMBEDR_OPTION_SLIDESHOW"},data:i}))+"</span>\n										</label>\n									</div>\n"},61:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'							<div class="link-type-content email-sharing-panel">\n								<div class="message-form">\n									<div class="fake-input">\n										<input type="text" class="email-recipient-text-field" placeholder="'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.SCREEN_NAME_OR_EMAIL"},data:i}))+'" data-field="recipient">\n									</div>\n\n									<textarea class="email-message-text-field '+((s=n["if"].call(o,t!=null?t.showMailPerms:t,{name:"if",hash:{},fn:e.program(41,i,0),inverse:e.program(43,i,0),data:i}))!=null?s:"")+'" placeholder="'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.INCLUDE_A_MESSAGE"},data:i}))+'"></textarea>\n								</div>\n\n								<div class="button-bar">\n'+((s=n["if"].call(o,t!=null?t.showMailPerms:t,{name:"if",hash:{},fn:e.program(46,i,0),inverse:e.program(48,i,0),data:i}))!=null?s:"")+'\n									<button disabled class="share-by-email">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.FLICKR_SHARE"},data:i}))+"</button>\n								</div>\n							</div>\n"},63:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'							<div class="link-type-content html-bb-embed">\n								<input readonly type="text" class="bb-code-text-field" value="'+a((s=(s=n.defaultBBCode||(t!=null?t.defaultBBCode:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"defaultBBCode",hash:{},data:i}):s))+'">\n								<div class="bb-code-size-field embed-size-field">\n									<span class="embed-code-label">\n										'+a((n.renderTrustedMarkup||t&&t.renderTrustedMarkup||u).call(o,t!=null?t.defaultBBCodeSizeStr:t,{name:"renderTrustedMarkup",hash:{},data:i}))+'\n									</span>\n									<span class="dropdown-arrow"></span>\n								</div>\n							</div>\n'},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{};return'<div class="share-panel-body">\n	<div class="share-panels">\n\n		<div class="main-sharing-panel share-panel">\n\n			<div class="share-link-types first-stop">\n\n					<div class="link-type-buttons">\n\n						<span class="link-type-button link-grab-type-button '+((s=n["if"].call(o,t!=null?t.hideButtons:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">'+e.escapeExpression((n.intlHTMLMessage||t&&t.intlHTMLMessage||n.helperMissing).call(o,{name:"intlHTMLMessage",hash:{intlName:"share-modal.SHARE"},data:i}))+"</span>\n\n"+((s=n.unless.call(o,t!=null?t.hideButtons:t,{name:"unless",hash:{},fn:e.program(3,i,0),inverse:e.noop,data:i}))!=null?s:"")+"\n"+((s=n["if"].call(o,t!=null?t.hideButtons:t,{name:"if",hash:{},fn:e.program(10,i,0),inverse:e.noop,data:i}))!=null?s:"")+'\n						<span class="link-type-highlight '+((s=n["if"].call(o,t!=null?t.hideButtons:t,{name:"if",hash:{},fn:e.program(12,i,0),inverse:e.noop,data:i}))!=null?s:"")+'"></span>\n\n					</div>\n\n\n				<div class="link-type-contents">\n'+((s=n["if"].call(o,t!=null?t.hideButtons:t,{name:"if",hash:{},fn:e.program(14,i,0),inverse:e.program(51,i,0),data:i}))!=null?s:"")+"\n				</div>\n			</div>\n\n		</div>\n\n	</div>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-panel-restyle",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-share-embedr-code",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing;return((s=(n.ifCond||t&&t.ifCond||u).call(o,(s=t!=null?t.displayOptions:t)!=null?s.header:s,"===","true",{name:"ifCond",hash:{},fn:e.program(2,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=(n.ifCond||t&&t.ifCond||u).call(o,(s=t!=null?t.displayOptions:t)!=null?s.footer:s,"===","true",{name:"ifCond",hash:{},fn:e.program(4,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=n.unless.call(o,t!=null?t.isAlbumEmbed:t,{name:"unless",hash:{},fn:e.program(6,i,0),inverse:e.noop,data:i}))!=null?s:"")},2:function(e,t,n,r,i){return'data-header="true" '},4:function(e,t,n,r,i){return'data-footer="true" '},6:function(e,t,n,r,i){var s;return(s=(n.ifCond||t&&t.ifCond||n.helperMissing).call(t!=null?t:{},(s=t!=null?t.displayOptions:t)!=null?s.context:s,"===","true",{name:"ifCond",hash:{},fn:e.program(7,i,0),inverse:e.noop,data:i}))!=null?s:""},7:function(e,t,n,r,i){return'data-context="true" '},9:function(e,t,n,r,i){return'data-vr="true" '},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return'<a data-flickr-embed="true" '+((s=(n.isFlipped||t&&t.isFlipped||a).call(u,"enable-share-restyle",{name:"isFlipped",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+((s=(n.ifCond||t&&t.ifCond||a).call(u,(s=t!=null?t.displayOptions:t)!=null?s.vr:s,"===","true",{name:"ifCond",hash:{},fn:e.program(9,i,0),inverse:e.noop,data:i}))!=null?s:"")+' href="'+l((o=(o=n.embedLink||(t!=null?t.embedLink:t))!=null?o:a,typeof o===f?o.call(u,{name:"embedLink",hash:{},data:i}):o))+'" title="'+l((o=(o=n.title||(t!=null?t.title:t))!=null?o:a,typeof o===f?o.call(u,{name:"title",hash:{},data:i}):o))+'"><img src="'+l((o=(o=n.farmURL||(t!=null?t.farmURL:t))!=null?o:a,typeof o===f?o.call(u,{name:"farmURL",hash:{},data:i}):o))+'" width="'+l((o=(o=n.width||(t!=null?t.width:t))!=null?o:a,typeof o===f?o.call(u,{name:"width",hash:{},data:i}):o))+'" height="'+l((o=(o=n.height||(t!=null?t.height:t))!=null?o:a,typeof o===f?o.call(u,{name:"height",hash:{},data:i}):o))+'" alt="'+l((o=(o=n.alt||(t!=null?t.alt:t))!=null?o:a,typeof o===f?o.call(u,{name:"alt",hash:{},data:i}):o))+'"></a><script async src="//embedr.flickr.com/assets/client-code.js" charset="utf-8"></script>'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-embedr-code",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-share-bb-code",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s,o,u=t!=null?t:{};return"by [url="+((s=n["if"].call(u,t!=null?t.authorURL:t,{name:"if",hash:{},fn:e.program(2,i,0),inverse:e.program(4,i,0),data:i}))!=null?s:"")+"]"+e.escapeExpression((o=(o=n.authorName||(t!=null?t.authorName:t))!=null?o:n.helperMissing,typeof o=="function"?o.call(u,{name:"authorName",hash:{},data:i}):o))+"[/url]"},2:function(e,t,n,r,i){var s;return e.escapeExpression((s=(s=n.authorURL||(t!=null?t.authorURL:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"authorURL",hash:{},data:i}):s))},4:function(e,t,n,r,i){return"shortURL"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f="function",l=e.escapeExpression;return"[url="+l((o=(o=n.shortURL||(t!=null?t.shortURL:t))!=null?o:a,typeof o===f?o.call(u,{name:"shortURL",hash:{},data:i}):o))+"][img]"+l((o=(o=n.farmURL||(t!=null?t.farmURL:t))!=null?o:a,typeof o===f?o.call(u,{name:"farmURL",hash:{},data:i}):o))+"[/img][/url][url="+l((o=(o=n.shortURL||(t!=null?t.shortURL:t))!=null?o:a,typeof o===f?o.call(u,{name:"shortURL",hash:{},data:i}):o))+"]"+l((o=(o=n.title||(t!=null?t.title:t))!=null?o:a,typeof o===f?o.call(u,{name:"title",hash:{},data:i}):o))+"[/url] "+((s=n["if"].call(u,t!=null?t.authorName:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.noop,data:i}))!=null?s:"")+", "+l((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"share-modal.ON_FLICKR"},data:i}))},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-bb-code",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-share-modal-mail-pill",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s=t!=null?t:{},o=n.helperMissing,u=e.escapeExpression;return'<div class="pill" title="'+u((n.stripTags||t&&t.stripTags||o).call(s,t!=null?t.value:t,{name:"stripTags",hash:{},data:i}))+'">\n	<span>'+u((n.stripTags||t&&t.stripTags||o).call(s,t!=null?t.value:t,{name:"stripTags",hash:{},data:i}))+'</span>\n	<span class="remove-tag">\n		<i class="delete-tag" title="Delete"></i>\n	</span>\n</div>'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/share-modal-mail-pill",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-warning",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){var s;return e.escapeExpression((s=(s=n.title||(t!=null?t.title:t))!=null?s:n.helperMissing,typeof s=="function"?s.call(t!=null?t:{},{name:"title",hash:{},data:i}):s))},3:function(e,t,n,r,i){return e.escapeExpression((n.intlMessage||t&&t.intlMessage||n.helperMissing).call(t!=null?t:{},{name:"intlMessage",hash:{intlName:"common.OOPS"},data:i}))},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{},a=n.helperMissing,f=e.escapeExpression;return'<div class="fluid-warning">\n	<span class="warning-title">'+((s=n["if"].call(u,t!=null?t.title:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+'</span>\n	<br/><br/>\n	<span class="warning-message">'+f((o=(o=n.message||(t!=null?t.message:t))!=null?o:a,typeof o=="function"?o.call(u,{name:"message",hash:{},data:i}):o))+'</span>\n	<button class="button">'+f((n.intlMessage||t&&t.intlMessage||a).call(u,{name:"intlMessage",hash:{intlName:"common.OK"},data:i}))+"</button>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-warning",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-share-panel-error",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a=e.escapeExpression;return'<div class="share-panel-body cancel-share">\n	<div class="cancel-message">\n		'+a((s=(s=n.errorMessage||(t!=null?t.errorMessage:t))!=null?s:u,typeof s=="function"?s.call(o,{name:"errorMessage",hash:{},data:i}):s))+'\n	</div>\n\n	<button class="done-sharing mini">'+a((n.intlHTMLMessage||t&&t.intlHTMLMessage||u).call(o,{name:"intlHTMLMessage",hash:{intlName:"common.CANCEL"},data:i}))+"</button>\n</div>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-panel-error",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-share-old-html-embed-code",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'<a href="'+f((s=(s=n.embedLink||(t!=null?t.embedLink:t))!=null?s:u,typeof s===a?s.call(o,{name:"embedLink",hash:{},data:i}):s))+'" title="'+f((s=(s=n.title||(t!=null?t.title:t))!=null?s:u,typeof s===a?s.call(o,{name:"title",hash:{},data:i}):s))+" by "+f((s=(s=n.authorName||(t!=null?t.authorName:t))!=null?s:u,typeof s===a?s.call(o,{name:"authorName",hash:{},data:i}):s))+", "+f((n.intlMessage||t&&t.intlMessage||u).call(o,{name:"intlMessage",hash:{intlName:"share-modal.ON_FLICKR"},data:i}))+'"><img src="'+f((s=(s=n.farmURL||(t!=null?t.farmURL:t))!=null?s:u,typeof s===a?s.call(o,{name:"farmURL",hash:{},data:i}):s))+'" width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" alt="'+f((s=(s=n.alt||(t!=null?t.alt:t))!=null?s:u,typeof s===a?s.call(o,{name:"alt",hash:{},data:i}):s))+'"></a>'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-old-html-embed-code",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-fluid-share-old-iframe-embed-code",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o=t!=null?t:{},u=n.helperMissing,a="function",f=e.escapeExpression;return'<iframe src="'+f((s=(s=n.embedLink||(t!=null?t.embedLink:t))!=null?s:u,typeof s===a?s.call(o,{name:"embedLink",hash:{},data:i}):s))+'" width="'+f((s=(s=n.width||(t!=null?t.width:t))!=null?s:u,typeof s===a?s.call(o,{name:"width",hash:{},data:i}):s))+'" height="'+f((s=(s=n.height||(t!=null?t.height:t))!=null?s:u,typeof s===a?s.call(o,{name:"height",hash:{},data:i}):s))+'" frameborder="0" allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/fluid-share-old-iframe-embed-code",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("flickr-contacts-getListfetcher",function(e,t){"use strict";function n(t,n){var r=t[0],i=t[1];return r.contacts&&r.contacts.contact&&r.contacts.contact.forEach(function(t){i.addOrUpdate(e.APIHelper.response.parsePerson(t))}),r}function r(n,r){var i=this;return n.extras=(n.extras||"")+", icon_urls, paid_products",e.Promise.all([r.callAPI("flickr.contacts.getList",n),r.getModelRegistry("person-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-contacts-getList"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-models"]});
YUI.add("contact-search-box",function(e){var t,n=function(n){this.options=n,this.options.elValue=this.options.elValue||"value",this.options.hideInitially||[],this._contacts=null,this.queryEl=this.options.el,this.queryElEvent,this.listEl=null,t=this.options.DOMContainer||e.config.win,this.init()};n.prototype={langBundles:["common","photo-page-scrappy"],init:function(){var t=this;this.options.showFollowingState!==!1&&(this.options.showFollowingState=!0),this.queryEl.on("keydown",this.keynav.bind(this)),this.queryElEvent=this.queryEl.on("keyup",this.search.bind(this)),this.wrapperEl=e.Node.create("<div/>"),this.wrapperEl.addClass("c-contact-search-autocomplete"),this.listEl=e.Node.create("<ul/>"),this.listEl.addClass("contact-list"),this.wrapperEl.appendChild(this.listEl),this.listEl.on("mouseover",function(e){var n=e.target.ancestor("li",!0);if(!n||n===t.highlighted)return;t._highlight(n)}),this.queryEl.ancestor().insertBefore(this.wrapperEl,this.queryEl),this.wrapperEl.appendChild(this.queryEl),this.options.clickContact=this.options.clickContact||function(e){var n=e.target.ancestor("[data-nsid]",!0),r=n?n.getData("nsid"):"";t.select(r)},this.listEl.delegate("click",this.options.clickContact,"li"),this.selectedIndex=0},keynav:function(e){e.keyCode===38?(e.preventDefault(),this.selectedIndex--,this.selectedIndex<0&&(this.selectedIndex=this.numShowing+this.selectedIndex),this._highlight(this.selectedIndex),this._scrollToNode(this.highlighted)):e.keyCode===40?(e.preventDefault(),this.selectedIndex++,this.selectedIndex>this.numShowing-1&&(this.selectedIndex=this.numShowing-this.selectedIndex),this._highlight(this.selectedIndex),this._scrollToNode(this.highlighted)):e.keyCode===9?this._visible&&this.highlighted&&(e.preventDefault(),this.select(this.highlighted.getData("nsid"))):e.keyCode===13&&this._visible&&this.highlighted&&(e.preventDefault(),!e.target.ancestor(".share-view",!0)&&!e.target.ancestor(".fluid-share-panel-view",!0)?this.options.clickContact(e,this.highlighted):this.select(this.highlighted.getData("nsid")))},_highlight:function(t){var n=this.listEl.all("li"),r=t instanceof e.Node,i=r?t:n.item(t),s=r?n.indexOf(t):t;i&&!i.hasClass("loading")&&!i.hasClass("no-members")&&(n.removeClass("highlight"),i.addClass("highlight"),this.selectedIndex=s,this.highlighted=i)},_scrollToNode:function(e){var t=this.listEl.get("scrollTop"),n=t+this.listEl.get("clientHeight"),r=e.get("offsetTop"),i=r+e.get("clientHeight"),s=5;t>r?this.listEl.set("scrollTop",r-s):n<i&&this.listEl.set("scrollTop",i-this.listEl.get("clientHeight")+s)},getContact:function(e){var t=0,n=this._contacts,r=n.length;for(;t<r;t++)if(n[t].nsid===e&&!n[t].hide)return n[t]},hideFromSearch:function(e){e=e.trim(),this._contacts&&this._contacts.some(function(t){if(t.nsid.trim()===e)return t.hide=!0,!0})},resetSearch:function(){this._contacts&&this._contacts.forEach(function(e){e.hide=!1})},showInSearch:function(e){e=e.trim(),this._contacts&&this._contacts.some(function(t){if(t.nsid.trim()===e)return t.hide=!1,!0})},load:function(e){var t={},n=this,r,i;if(this._busy)return;return this._end=!1,this._busy=!0,t.can_tag=this.options.canTag||0,i=this.options.appContext.getViewer().nsid,r=this.options.appContext.getModel("contacts-models",i),r.then(function(r){return t.page=1,t.perPage=3e3,t.per_page=3e3,n._loadMoreContacts(r,t,e)},function(){n._busy=!1,n.options.onError()})},_loadMoreContacts:function(e,t,n){var r=this;return this._busy=!0,r.options.loadingState&&!r.listEl.one("li.loading")&&r.appendLoader(),e.getValue("contacts").getPage(t).then(function(i){r._contacts=(r.processContactModels(i,!0,!0)||[]).concat(r._contacts||[]),n(),(!r._contacts||r._contacts.length===0)&&r.hide(),t.page<e.getValue("pages")&&(t.page++,r._loadMoreContacts(e,t,n))},function(){r._busy=!1,r.options.onError()})},processContactModels:function(t,n,r){var i=this,s,o,u;try{u=t.map(function(e){return e.toJSON()})||[]}catch(a){u=[]}if(!i.contactIds){i.contactIds={};if(i._contacts)for(o in i._contacts)i.contactIds[o.id]=!0}return u=u.filter(function(e){return!i.contactIds[e.id]}),u.forEach(function(t,n){i.contactIds[t.id]=!0,t.realname=t.realname||t.username,t.isContact=r,t.buddyicon=e.URLHelper.getBuddyIconURL(t.nsid,t.iconfarm,t.iconserver)}),n&&i.options.me&&(s=i.options.me.toJSON(),e.APIHelper.response.agnosticizeFarmPathTransferProtocol(s.buddyicon),s.buddyicon=s.buddyicon["default"],i.contactIds[s.id]=!0,s.me=!0,u.push(s)),i.options.hideInitially&&u.forEach(function(e){i.options.hideInitially.indexOf(e.nsid)>-1&&(e.hide=!0)}),u},destructor:function(){this.queryElEvent&&this.queryElEvent.detach&&this.queryElEvent.detach()},hide:function(e){e&&e.halt();if(!this._visible)return;this._visible=!1,this.highlighted=null,this.selectedIndex=0,this.selected=null,this.options.noShim||this._shimUp(!1),this.listEl.setStyle("display","none"),this.options.onHide&&this.options.onHide()},show:function(){if(this._visible)return;this._visible=!0,this.options.noShim||this._shimUp(),this.listEl.setStyle("display","block"),this._reposition(),this.options.onShow()},_reposition:function(){var n={width:t.innerWidth||t.clientWidth,height:t.innerHeight||t.clientHeight},r=this.options.el,i=r.getDOMNode(),s=i.getBoundingClientRect(),o=this.listEl.getDOMNode().getBoundingClientRect(),u=!this._contacts,a=u&&this.options.upInitially,f=t===e.config.win?s.top:i.clientTop,l;this.options.dialogOffset&&(l=this.options.dialogOffset()),a||f>0&&f+o.height+25>n.height&&!this.options.alwaysDownward?(this.listEl.setStyle("top","auto"),this.listEl.setStyle("bottom","25px"),this.options.onOrientationChange&&this.options.onOrientationChange(!0)):(this.listEl.setStyle("top",l||null),this.listEl.setStyle("bottom",null),this.options.onOrientationChange&&this.options.onOrientationChange(!1),r.ancestor(".modal",!0)&&this.listEl.setStyle("maxHeight",n.height-f-25))},_shimUp:function(t){if(t===!1){if(!this._shim)return;this._shim.detach("click").remove(),this._shim=null;return}this._shim=e.Node.create("<div/>"),this
._shim.addClass(this.options.shim),this._shim.on("click",this.hide.bind(this)),this.wrapperEl.appendChild(this._shim)},select:function(e){typeof e=="string"&&(e=this.getContact(e),e&&this.queryEl.set("value",e.realname)),e&&(this.selected=e,this.options.onSelect(e)),this.hide()},search:function(e){var t=this.queryEl.get(this.options.elValue),n=this,r,i,s,o=this.options.appContext.getViewer().nsid;if(e&&e.keyCode===27){e.preventDefault(),this.queryEl.blur();return}if(e&&[38,40,9].indexOf(e.keyCode)!==-1){e.preventDefault();return}this._nameTest(t),this.selected=null,this.selectedIndex=0,this.abort=!1;if(t.trim()==="")return this.abort=!0,this.hide();this.options.searchNonContacts||(this._end=!0,this._busy=!1);if(this._contacts&&this.options.me&&t==="me")return this.showResults(this._contacts.filter(function(e){return!e.hide&&e.me}).concat(this._contacts.filter(function(e){return!e.hide&&n._matchesQuery(e)})));if(this._isEmail(t))return this.select({email:t,nsid:null});if(/,/.test(t))return this.select(null);if(!this._contacts){if(this.options.signedOut)return;this.showResults(),this.load(this.search.bind(this))}this._contacts&&(r=this._contacts.filter(function(e){return!e.hide&&n._matchesQuery(e)})),this.showResults(r),i=n.listEl.getDOMNode(),this.options.searchNonContacts&&(this.options.loadMoreOnScroll&&t.length>0?(s=1,clearTimeout(this.searchAllPeople),this.searchInstanceId=Math.random()*999999,this.searchAllPeople=setTimeout(function(){n._searchPeople(t,o,s,n.searchInstanceId,function(){n._busy=!1,n.showResults(n._contacts.filter(function(e){return!e.hide&&n._matchesQuery(e)})),n.listElScrollEvent=n.listEl.on("scroll",function(){n.listEl._node.clientHeight+n.listEl._node.scrollTop===n.listEl._node.scrollHeight&&(s++,n._loadMore(s,o,t))})})},500)):(clearTimeout(this.searchAllPeople),this.searchInstanceId=Math.random()*999999))},_loadMore:function(e,t,n){var r=this;this._busy=!0,clearTimeout(this.searchAllPeople),this.searchInstanceId=Math.random()*999999,this.searchAllPeople=setTimeout(function(){r.options.loadingState&&!r.listEl.one("li.loading")&&r.appendLoader(),r._searchPeople(n,t,e,r.searchInstanceId,function(){r.showResults(r._contacts.filter(function(e){return!e.hide&&r._matchesQuery(e)})),r.listElScrollEvent&&r.listElScrollEvent.detach(),r.listElScrollEvent=r.listEl.on("scroll",function(){r.listEl._node.clientHeight+r.listEl._node.scrollTop===r.listEl._node.scrollHeight&&(e++,r._loadMore(e,t,n))})})},100)},_nameTest:function(t){var n=new RegExp(".*"+e.flutil.agnosticizeUnicode(t).replace(/\s/,"\\s")+".*","ig");this._matchesQuery=function(e){return n.test(e.username)||n.test(e.realname)||n.test(e.email)}},appendLoader:function(e){e=e||this.listEl;var t=document.createElement("li"),n=e.scrollTop;t.className="loading",t.innerHTML=this.options.loadingState,e.appendChild(t),e.scrollTop=n+t.clientHeight},_searchPeople:function(e,t,n,r,i){var s=this,o,u;s._end=!1,s.options.loadingState&&!s.listEl.one("li.loading")&&s.appendLoader(),o=s.options.appContext.getModel("contacts-models",t),o.then(function(t){return u=t.search({username:e,page:n}),u.then(function(e){var t=e.people,n=s.processContactModels(t,!1,!1);s._contacts=s._contacts||[],s._contacts=s._contacts.concat(n),s._contacts.some(function(e){return s._matchesQuery(e)})||(s._end=!0),i()},function(){s._end=!0,s._busy=!1,i()})},function(){s._end=!0,s._busy=!1,i()})},_isEmail:function(e,t){/,/.test(e)?e=e.split(/,/):e=[e];var n=/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/;if(t){while(e.length)if(n.test(e.shift().trim()))return!0;return!1}while(e.length)if(!n.test(e.shift().trim()))return!1;return!0},showResults:function(t){if(this.abort)return;var n=this.options.max||10,r,i,s=this;r=document.createDocumentFragment(),t&&this.selectedIndex>=t.length&&(this.selectedIndex=t.length-1),this.numShowing=Math.min(n,t&&t.length||0),!s._busy&&t&&t.length===0?(i=document.createElement("li"),i.innerHTML='<span class="no-contacts">'+this.intlMessage({intlName:"photo-page-scrappy.NO_MEMBERS_FOUND"})+"</span>",i.className="no-members",r.appendChild(i),s.highlighted=null):t&&t.slice(0,n).forEach(function(t,n,i){var o=s.createItem(t);n===s.selectedIndex&&(o.setAttribute("class","highlight"),s.highlighted=e.Node(o)),r.appendChild(o)}),(s._busy||!t)&&s.options.loadingState&&s.appendLoader(r),this.options.loadMoreOnScroll&&this.listElScrollEvent&&this.listElScrollEvent.detach(),this.listEl.setHTML(""),this.listEl.getDOMNode().appendChild(r),this.show()},_template:function(){return['<img src="{{buddyicon}}">','<div class="following-status {{isContact}}">','<span class="following-icon">&nbsp;</span>',"<span>"+this.intlMessage({intlName:"common.FOLLOWING"})+"</span>","</div>",'<h2 class="all">{{realname}}</h2>','<h3 class="all">{{username}}</h3>'].join("")},_onlyContactTemplate:['<img src="{{buddyicon}}">',"<h2>{{realname}}</h2>","<h3>{{username}}</h3>"].join(""),createItem:function(t){var n=document.createElement("li"),r,i=this.options.searchNonContacts&&this.options.showFollowingState?this._template():this._onlyContactTemplate,s=this.options.truncateLength||70;return r=i.replace(/\{\{(\w+)\}\}/g,function(n,r){if(r==="buddyicon")return t[r];if(r==="isContact")return t[r]?"am-following":"";var i=e.flutil.escapeInput(t[r]);return e.Handlebars.helpers.truncate(i,s)}),n.innerHTML=r,n.dataset?(n.dataset=n.dataset,n.dataset.nsid=t.nsid,n.dataset.displayname=t.realname||t.username,n.dataset.pathAlias=t.pathAlias,n.dataset.ispro=t.isPro):(n.setAttribute("data-nsid",t.nsid),n.setAttribute("data-displayname",t.realname||t.username),n.setAttribute("data-path-alias",t.pathAlias),n.setAttribute("data-ispro",t.isPro)),n}},e.mix(n.prototype,e.Localizable),e.ContactSearchBox=n},"@VERSION@",{requires:["api-helper","flutil","contact-search-css","handlebars-helpers","flickr-contacts-getListfetcher"],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-html5-balls",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){return'\n<div class="html5-balls">\n	<div class="blueball"></div>\n	<div class="pinkball"></div>\n</div>\n'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/html5-balls",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-html4-balls",function(e,t){var n=e.Template.Handlebars.revive({compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){return'\n<div class="html4-balls"></div>\n'},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/html4-balls",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("html5-balls",function(e){var t=!(e.UA.ie&&e.UA.ie<9),n;n=function(e){return t?"html5-balls":"html4-balls"},e.augment(n,e.Attribute),e.Balls=n},"@VERSION@",{requires:["base","html5-balls-css","hermes-template-html5-balls","hermes-template-html4-balls","handlebars-helpers","template-base"]});
YUI.add("fluid-share-panel-view",function(e,t){var n=require("lib/flog")(t),r=".dropdown-arrow",i="embed-code-size-field",s="iframe-code-size-field",o="bb-code-size-field",u={},a=50,f=["sq","t","q","s","n","m","z","c","b","l","h","k"],l={header:"false",footer:"false",context:"false",vr:"false"};u[i]="embed-code-text-field",u[s]="iframe-code-text-field",u[o]="bb-code-text-field",e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.networkClasses=t.networkClasses||{},this.linkShareParams=t.linkShareParams,this.guestPassParams=t.guestPassParams||{},this.emailShareParams=t.emailShareParams,this.signedOutSharingPerms=t.signedOutSharingPerms||{},this.shareItemCount=t.shareItemCount||1,this.PERMISSIONS=[],this.guestPassParams.canSharePrivate&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_PRIVATE"}),value:"private"}),this.guestPassParams.shareNonPublic!==!1&&(this.guestPassParams.contentMarkedFriendFamily&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_FRIENDS_AND_FAMILY"}),value:"family_and_friends"}),this.guestPassParams.contentMarkedFamily&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_FAMILY"}),value:"family"}),this.guestPassParams.contentMarkedFriends&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_FRIENDS"}),value:"friends"})),this.guestPassParams.contentMarkedPublic&&this.PERMISSIONS.push({text:this.intlMessage({intlName:"share-modal.SHARE_PUBLIC_ONLY"}),value:"public"}),this.isMine=t.isMine||!1,this.cancel=!1,this.guestPasses={},this.flickrShare={recipients:[],guestpassStr:this.PERMISSIONS[0]?this.PERMISSIONS[0].value:"private"},this.appContext.flipper.isFlipped("enable-share-restyle")&&(l=e.StorageHelper.getItem("embedr-options")?JSON.parse(e.StorageHelper.getItem("embedr-options")):l),t.canVr?l.vr="true":l.vr="false",this},loadState:function(){var t=[],n=this;this.appContext.getViewer().nsid&&t.push(this.appContext.getModel("person-models",this.appContext.getViewer().nsid).then(function(e){n.set("me",e)}));if(this.guestPassParams.shareToAll)Object.keys(this.signedOutSharingPerms).forEach(function(e){n.networkClasses[e].canShare=!0});else if(this.guestPassParams.shareToSpecific)Object.keys(this.guestPassParams.shareToSpecific).forEach(function(e){n.networkClasses[e].canShare=n.guestPassParams.shareToSpecific[e].canShare,n.networkClasses[e].canNotShareTitle=n.guestPassParams.shareToSpecific[e].canNotShareTitle});else{var r={};r[this.emailShareParams.modelName+"_id"]=this.emailShareParams.modelId,this.emailShareParams.modelOwnerId&&(r.owner_id=this.emailShareParams.modelOwnerId),t.push(this._loadSharingPermissionsFromAPI(r))}return e.Promise.all(t)},_loadSharingPermissionsFromAPI:function(e){var t=this;return e.breakCache=(new Date).toISOString(),this.appContext.callAPI("flickr.sharing.canShare",e).then(function(e){e&&e.services&&e.services.service&&e.services.service.forEach(function(e){Object.keys(t.networkClasses).some(function(n){if(t.networkClasses[n].serviceId===e.serviceTypeId){t.networkClasses[n].canShare=!!e.canShare,n==="flickr"&&t.appContext.getViewer().signedIn===!1&&(t.networkClasses[n].canShare=!1),e.canShare||(t.networkClasses[n].canNotShareTitle=e.reason.map(function(e){return e.content}).join(", "));if(e.serviceTypeId===130&&e.reason&&e.reason.length&&e.reason.some(function(e){return e.code===3}))return t.cancelMessage=t.intlMessage({intlName:"share-modal.CANCEL_SHARE_BECAUSE_RESTRICTED"}),t.cancel=!0,!0;if(e.serviceTypeId===130){t.PERMISSIONS.length&&t.PERMISSIONS[t.PERMISSIONS.length-1].value!=="public"&&(t.guestpassRequired=!0);if(e.availableGuestpasses){e.guestpassRequired===1&&t.PERMISSIONS.length&&t.PERMISSIONS[t.PERMISSIONS.length-1].value==="public"&&t.PERMISSIONS.shift(),e.guestpassRequired===1&&(t.guestpassRequired=!0,t.guestPassParams=t.guestPassParams||{},t.guestPassParams.contentMarkedPublic=!1,t.guestPassParams.nonPublicWarning=!0);var r=!1,i=!1,s=!1;e.availableGuestpasses.guestpass.forEach(function(e){e.content==="friends"&&(r=!0),e.content==="family"&&(i=!0),e.content==="private"&&(s=!0)});var o=0;while(o<t.PERMISSIONS.length)t.PERMISSIONS[o].value==="friends"&&!r||t.PERMISSIONS[o].value==="family"&&!i||t.PERMISSIONS[o].value==="family_and_friends"&&!i&&!r||t.PERMISSIONS[o].value==="private"&&!s?t.PERMISSIONS.splice(o,1):o++}else t.PERMISSIONS.length&&t.PERMISSIONS[t.PERMISSIONS.length-1].value==="public"&&(t.PERMISSIONS=[t.PERMISSIONS[0]]);t.flickrShare.guestpassStr=t.PERMISSIONS[0]?t.PERMISSIONS[0].value:"private"}return!0}return!1})})},function(e){n.error("Error reading canShare permissions",{err:e}),Object.keys(t.signedOutSharingPerms).forEach(function(e){t.networkClasses[e].canShare=t.signedOutSharingPerms[e].canShare})})},buildContainer:function(){var t,n=this.guestPassParams.showGuestPassDropdown&&this.isMine&&!!this.guestPassParams.type||!this.guestPassParams.contentMarkedPublic,r="";if(this.cancel)return this.setContainerWithTemplate("fluid-share-panel-error",{errorMessage:this.cancelMessage||this.intlMessage({intlName:"share-modal.CANCEL_SHARE_BECAUSE_ERROR",photoCount:this.guestPassParams.multipleItems?2:1})}),this;this.linkShareDisplay=this.generateLinkSharingDisplay(this.linkShareParams),e.UA.os==="macintosh"?r=this.intlMessage({intlName:"share-modal.COPY_MAC"}):r=this.intlMessage({intlName:"share-modal.COPY_PC"}),t={networkClasses:this.networkClasses,linkShareDisplay:this.linkShareDisplay,privacyWarningString:this.linkShareParams.privacyWarningString,downloadAccessString:this.linkShareParams.downloadAccessString,showDownloadWarning:this.linkShareParams.showDownloadWarning,shareItemCount:this.shareItemCount,grabLink:this.guestPassParams.contentMarkedPublic||this.linkShareParams.generateLink?this.linkShareParams.shortURL:null,canHaveGuestpass:n,emailShareParams:this.emailShareParams,showMailPerms:this.guestPassParams.showGuestPassDropdown&&this.isMine&&this.guestPassParams
.multipleItems&&this.PERMISSIONS.length>0,nonPublicWarning:this.guestPassParams.nonPublicWarning,grabLinkDefaultPermission:(n&&this.PERMISSIONS.length)>0?this.PERMISSIONS[0].text:"",copyMessage:r,choiceOfPermission:this.PERMISSIONS.length>1,displayOptions:l,isAlbumEmbed:typeof this.linkShareParams.albumId!="undefined"};if(this.linkShareDisplay.embedr){var i=0,s=e.StorageHelper.getItem("fluid-share-panel-embedr-default-size"),o;this.linkShareDisplay.embedr.sizes.forEach(function(e,t){s&&e.sizeKey===s&&(i=t,o=!0);if(!o){var n=f.indexOf(e.sizeKey);n>i&&(i=t)}}),t.defaultSizeStr=this.linkShareDisplay.embedr.sizes[i].sizeStr,t.defaultEmbedrCode=this.linkShareDisplay.embedr.sizes[i].embedCode,e.StorageHelper.setItem("fluid-share-panel-embedr-default-size",this.linkShareDisplay.embedr.sizes[i].sizeKey)}if(this.linkShareDisplay.bbCode){var u=0,a=e.StorageHelper.getItem("fluid-share-panel-bbCode-default-size"),c;this.linkShareDisplay.bbCode.sizes.forEach(function(e,t){a&&e.sizeKey===a&&(u=t,c=!0);if(!c){var n=f.indexOf(e.sizeKey);n>u&&(u=t)}}),t.defaultBBCode=this.linkShareDisplay.bbCode.sizes[u].embedCode,t.defaultBBCodeSizeStr=this.linkShareDisplay.bbCode.sizes[u].sizeStr}if(this.linkShareDisplay.iframe){var h=0,p=e.StorageHelper.getItem("fluid-share-panel-iframe-default-size"),d;this.linkShareDisplay.iframe.sizes.forEach(function(e,t){p&&e.sizeKey===p&&(h=t,d=!0);if(!d){var n=f.indexOf(e.sizeKey);n>h&&(h=t)}}),t.defaultIframeSizeStr=this.linkShareDisplay.iframe.sizes[h].sizeStr,t.defaultIframeCode=this.linkShareDisplay.iframe.sizes[h].embedCode}return!this.linkShareDisplay.bbCode&&!this.linkShareDisplay.embedr&&!this.linkShareDisplay.iframe&&(t.hideButtons=!0),t.moveInstructionsUp=t.hideButtons&&!t.canHaveGuestpass&&!t.choiceOfPermission,this.appContext.flipper.isFlipped("enable-share-restyle")?this.setContainerWithTemplate("fluid-share-panel-restyle",t):this.setContainerWithTemplate("fluid-share-panel",t),this},additionalViewClasses:function(){var e=[];return this.appContext.flipper.isFlipped("enable-share-restyle")&&e.push("restyle"),e},activate:function(){var t=this.get("container"),n=this;this.registerEventHandler(t.delegate("click",function(e){e.preventDefault(),n.fire("subviewViewEvent","done-sharing")},".done-sharing")),this.guestpassRequired&&this.fire("subviewViewEvent","guestpass-required");if(this.cancel)return this;this.dropdowns={},this.linkShareDisplay||(this.linkShareDisplay=this.generateLinkSharingDisplay(this.linkShareParams)),this.registerEventHandler(e.globalEvents.subscribe("window:keydown",function(t){(t.e.ctrlKey||t.e.metaKey)&&t.e.keyCode===67&&e.rapidTracker.beacon(n.name,"linkCopied-"+e.StorageHelper.getItem("fluid-share-panel-first-selected"))})),this.registerEventHandler(t.delegate("click",function(e){e.preventDefault(),n._toggleLinkSelection(e,t)},".link-type-button")),this.registerEventHandler(t.delegate("click",function(e){e.preventDefault(),n._createdDropdownForEmbedIframeBB.bind(n)(e,t)},".embed-size-field")),this.registerEventHandler(t.delegate("click",function(e){e.preventDefault(),n._createGrabLinkPermissionDropdown(e,t)},".grab-link-field")),this.registerEventHandler(t.delegate("click",function(e){e.preventDefault(),n._createMailPermissionDropdown(e,t)},".mail-perm-field")),this.registerEventHandler(t.delegate("click",function(e){e.target.select()},".bb-code-text-field, .grab-link-text-field, .embed-code-text-field")),this.registerEventHandler(t.delegate("click",function(r){n.networkClasses&&r.target.ancestor("."+n.networkClasses.flickr.className,!0)&&(r.preventDefault(),t.one(".share-panels").addClass("show-email-form"),e.rapidTracker.beacon(n.name,"emailTabClick"))},".share-link.sharing-type-enabled")),this.appContext.flipper.isFlipped("enable-share-restyle")||this.registerEventHandler(t.one(".leave-email-sharing").on("click",function(e){e.preventDefault(),t.one(".share-panels").removeClass("show-email-form")})),t.one(".share-by-email")&&this.registerEventHandler(t.one(".share-by-email").on("click",function(e){e.preventDefault(),n._onShareByEmail(e)})),n.appContext.flipper.isFlipped("enable-embedr-in-share")&&n.appContext.flipper.isFlipped("enable-share-restyle")&&this.registerEventHandler(t.delegate("change",function(e){e.halt(),n._updateEmbedrOptions(e)},".embed-options input")),this.setupEmailSharing();var r=this.PERMISSIONS[0].value;if(!this.linkShareParams.generateLink)if((this.appContext.flipper.isFlipped("enable-public-guestpass")||this.guestpassRequired)&&this.isMine&&this.linkShareParams.url.indexOf("favorites")===-1||r!=="public"){r!=="public"&&t.one(".grab-link-privacy-reminder").removeClass("hide-reminder");var i=[1,1,1];r==="friends"?i=[0,1,0]:r==="family"?i=[1,0,0]:r==="family_and_friends"&&(i=[1,1,0]),this.requestGuestpass.apply(this,i)}this.linkShareParams.generateLink&&(t.one(".grab-link-privacy-reminder").removeClass("hide-reminder"),this.generatingLink||(this.generatingLink=!0,this.startGuestpassLoader(),this.fire("subviewViewEvent","generate-link")));if(!this.appContext.flipper.isFlipped("enable-share-restyle")){var s=e.OverflowHelper.detectScrollbarSize(e.one("body"));t.one(".message-form")&&t.one(".message-form").setStyle("paddingRight",s+"px"),t.one(".share-by-email")&&t.one(".share-by-email").setStyle("marginRight",s+"px"),t.one(".share-panel-body")&&t.one(".share-panel-body").setStyle("paddingRight",s+"px")}return this.setHighlightWidths(),this},onParentViewEvent:function(t,n){var r=this.get("container"),i=r.one(".grab-link-text-field"),s=e.StorageHelper.getItem("fluid-share-panel-first-selected")||"grabLinkItem";if(n[0]==="flickr-share-error")this._onWarning(this.intlMessage({intlName:"share-modal.FLICKR_SHARE_ERROR"}));else if(n[0]==="flickr-share-success"){var o=r.one(".fake-input");o.removeClass("not-empty"),o.all(".pill").remove(),r.one(".email-message-text-field").set("value",""),r.one(".email-recipient-text-field").setStyle("width","inherit"),r.one(".share-by-email").set("disabled",!0),this.contacts.resetSearch(),this.to={},this
.flickrShare.recipients=[],this._onWarning(this.intlMessage({intlName:"share-modal.FLICKR_SHARE_SUCCESS"}),this.intlMessage({intlName:"share-modal.FLICKR_SHARE_SUCCESS_TITLE"}),!0)}else n[0]==="guestpass-created"?(this.guestPasses[""+n[1]]=n[2],i.set("value",n[2]),s==="grabLinkItem"&&i.select(),this.endGuestpassLoader()):n[0]==="guestpass-failed"?(r.one(".grab-link-permission-label")&&r.one(".grab-link-permission-label").set("text",this.intlMessage({intlName:"share-modal.SHARE_PUBLIC_ONLY"})),i.set("value",this.linkShareParams.shortURL),this.endGuestpassLoader(),this._onWarning(this.intlMessage({intlName:"share-modal.GUESTPASS_CREATION_FAILURE"}))):n[0]==="generated-link"&&(r.one(".grab-link-text-field").set("text",n[1]),i.set("value",n[1]),i.select(),this.endGuestpassLoader())},setHighlightWidths:function(){var t=this.get("container"),n=t.one(".link-type-highlight"),r=24,i=0,s=t.one(".link-grab-type-button").getDOMNode().offsetLeft,o,u="grabLinkItem",a=e.StorageHelper.getItem("fluid-share-panel-first-selected")||u,f,l,c;o=[{name:u,element:t.one(".link-grab-type-button")},{name:"embedItem",element:t.one(".embed-type-button")},{name:"iframeItem",element:t.one(".iframe-type-button")},{name:"emailItem",element:t.one(".email-type-button")},{name:"bbCodeItem",element:t.one(".bbcode-type-button")}],this.highlightWidths={};for(c=0;c<o.length;c++){l=o[c];if(!l.element){l.name===a&&(a=u);continue}i=parseInt(l.element.get("clientWidth"),10),this.highlightWidths[l.name]={width:i,left:s+"px"},s+=i+r}Object.keys(this.highlightWidths).length===1&&(a=u),f=o.filter(function(e){return e.name===a})[0].element,n.setStyles(this.highlightWidths[a]),this._toggleLinkSelection({target:f},t)},_toggleLinkSelection:function(t,n){var r=n.one(".link-type-highlight"),i,s=t.target.ancestor(".link-type-buttons",!0).get("children").indexOf(t.target);n.one(".share-link-types").toggleClass("first-stop",s===0).toggleClass("second-stop",s===1).toggleClass("third-stop",s===2).toggleClass("fourth-stop",s===3),t.target.hasClass("link-grab-type-button")?(i=this.highlightWidths.grabLinkItem,n.one(".grab-link-text-field").select(),e.StorageHelper.setItem("fluid-share-panel-first-selected","grabLinkItem"),e.rapidTracker.beacon(this.name,"grabLinkTabClick")):t.target.hasClass("embed-type-button")?(i=this.highlightWidths.embedItem,n.one(".embed-code-text-field").select(),e.StorageHelper.setItem("fluid-share-panel-first-selected","embedItem"),e.rapidTracker.beacon(this.name,"embedTabClick")):t.target.hasClass("iframe-type-button")?(i=this.highlightWidths.iframeItem,n.one(".iframe-code-text-field").select(),e.StorageHelper.setItem("fluid-share-panel-first-selected","iframeItem"),e.rapidTracker.beacon(this.name,"iframeTabClick")):t.target.hasClass("bbcode-type-button")?(i=this.highlightWidths.bbCodeItem,n.one(".bb-code-text-field").select(),e.StorageHelper.setItem("fluid-share-panel-first-selected","bbCodeItem"),e.rapidTracker.beacon(this.name,"bbCodeTabClick")):t.target.hasClass("email-type-button")&&(this.appContext.getViewer().signedIn?(i=this.highlightWidths.emailItem,e.StorageHelper.setItem("fluid-share-panel-first-selected","emailItem"),e.rapidTracker.beacon(this.name,"emailTabClick")):this.fire("subviewViewEvent","confirm-sign-in")),r.setStyles(i)},_createDropdown:function(t,n,i,s,o){var u=this;if(!o||o.isClosed)o=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,hideModalOverlay:!0,classList:"over-modal",overlayClassList:"over-modal",anchorElement:t.one("."+n+" "+r),observePageResize:!0,menuItems:i,forceLeft:!0,anchorOffsetHorizontal:16,closeOnResize:!0,preferBottom:!0}),o.on("selected",function(e){o.close(),s.bind(u)(e),u.setHighlightWidths()}),o.show()},_createdDropdownForEmbedIframeBB:function(t,n){var r,a,l,c;t.target.ancestor(".embed-size-field",!0).hasClass(i)?(r=i,a="embedr"):t.target.ancestor(".embed-size-field",!0).hasClass(s)?(r=s,a="iframe"):t.target.ancestor(".embed-size-field",!0).hasClass(o)&&(r=o,a="bbCode"),l=this.linkShareDisplay[a].sizes,c=f.concat(["o"]),this._createDropdown(n,r,Object.keys(l).map(function(e){return{text:l[e].sizeStr,value:l[e].sizeKey}}).sort(function(e,t){return c.indexOf(e.value)<c.indexOf(t.value)?-1:1}),function(t){var i;t&&t.menuItem&&(l.some(function(e){return e.sizeKey===t.menuItem.value?(i=e.sizeKey,n.one("."+u[r]).set("value",e.embedCode),n.one("."+r).one(".embed-code-label").set("text",e.sizeStr),!0):!1}),e.StorageHelper.setItem("fluid-share-panel-"+a+"-default-size",i))},this.dropdowns[a])},_createGrabLinkPermissionDropdown:function(e,t){var n=this;this._createDropdown(t,"grab-link-field",this.PERMISSIONS,function(e){if(e&&e.menuItem){var r=e.menuItem.value,i=t.one(".grab-link-text-field"),s=t.one(".grab-link-privacy-reminder");t.one(".grab-link-permission-label").set("text",e.menuItem.text);if(r==="public")i.set("value",n.linkShareParams.shortURL),s.addClass("hide-reminder");else{var o=0,u=0,a=0;r==="friends"?o=1:r==="family"&&(u=1),r==="family_and_friends"?(u=1,o=1):r==="private"&&(a=1),s.removeClass("hide-reminder"),n.requestGuestpass(u,o,a)}}},this.dropdowns.grabLink)},_createMailPermissionDropdown:function(e,t){var n=this;this._createDropdown(t,"mail-perm-field",this.PERMISSIONS,function(e){e&&e.menuItem&&(t.one(".mail-permission-label").set("text",e.menuItem.text),n.flickrShare.guestpassStr=e.menuItem.value)},this.dropdowns.mail)},_onShareByEmail:function(e){this.fire("subviewViewEvent","share-by-email",{recipients:this.flickrShare.recipients,guestpassStr:this.flickrShare.guestpassStr,message:this.get("container").one(".email-message-text-field").get("value")})},generateLinkSharingDisplay:function(t){var n=this,r={link:t.url},i=t.sizes?Object.keys(t.sizes):[];return i.length>0&&t.supportsEmbedr&&(n.appContext.flipper.isFlipped("enable-embedr-in-share")?r.embedr={sizes:Object.keys(t.sizes).map(function(r){return{sizeKey:r,sizeStr:n.getSizeStr(r)+" "+t.sizes[r].width+" \u00d7 "+t.sizes[r].height,embedCode:n.templates("fluid-share-embedr-code")({embedLink:
e.url(t.url),title:t.title,farmURL:e.URLHelper.addProtocolToURL(t.sizes[r].displayUrl),width:t.sizes[r].width,height:t.sizes[r].height,alt:t.title,displayOptions:l,isAlbumEmbed:typeof n.linkShareParams.albumId!="undefined"})}})}:(r.embedr={sizes:Object.keys(t.sizes).map(function(r){return{sizeKey:r,sizeStr:n.getSizeStr(r)+" "+t.sizes[r].width+" \u00d7 "+t.sizes[r].height,embedCode:n.templates("fluid-share-old-html-embed-code")({embedLink:e.url(t.url),title:t.title,authorName:t.author,farmURL:e.URLHelper.addProtocolToURL(t.sizes[r].displayUrl),width:t.sizes[r].width,height:t.sizes[r].height,alt:t.title})}})},r.iframe={sizes:Object.keys(t.sizes).map(function(r){var i;return i=e.config.win.location.href,i[i.length-1]!=="/"&&(i+="/"),i+="player/",{sizeKey:r,sizeStr:n.getSizeStr(r)+" "+t.sizes[r].width+" \u00d7 "+t.sizes[r].height,embedCode:n.templates("fluid-share-old-iframe-embed-code")({embedLink:i,title:t.title,farmURL:e.URLHelper.addProtocolToURL(t.sizes[r].displayUrl),width:t.sizes[r].width,height:t.sizes[r].height,alt:t.title})}})})),i.length>0&&t.supportsBBCode&&(r.bbCode={sizes:Object.keys(t.sizes).map(function(r){return{sizeKey:r,sizeStr:n.getSizeStr(r)+" "+t.sizes[r].width+" \u00d7 "+t.sizes[r].height,embedCode:n.templates("fluid-share-bb-code")({title:t.title,farmURL:e.URLHelper.addProtocolToURL(t.sizes[r].displayUrl),shortURL:t.shortURL,authorURL:e.url(t.authorURL),authorName:t.author})}})}),r},getSizeStr:function(e){var t="";return["sq","q"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.SQUARE"}):e==="t"?t=this.intlMessage({intlName:"common.THUMBNAIL"}):["s","n"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.SMALL"}):["m","z","c"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.MEDIUM"}):["l","h","k"].indexOf(e)>-1?t=this.intlMessage({intlName:"common.LARGE"}):e==="o"&&(t=this.intlMessage({intlName:"common.ORIGINAL"})),t},requestGuestpass:function(e,t,n){var r=this.get("container").one(".grab-link-text-field"),i=""+e+t+n;if(this.guestPasses[i]){r.set("value",this.guestPasses[i]);return}var s={is_private:n,is_family:e,is_friend:t},o=this.guestPassParams.type,u=this.guestPassParams.id;o==="photo"&&(s.photo=u),o==="photostream"&&(s.photostream=u),o==="set"&&(s.set=u),this.startGuestpassLoader(),this.fire("subviewViewEvent","request-guestpass",i,s)},startGuestpassLoader:function(){var e=this;setTimeout(function(){if(!e.guestpassLoaded){var t=e.get("container").one(".grab-link-loader");t.setStyle("display","block"),t.addClass("show-loader")}},a)},endGuestpassLoader:function(){var e=this.get("container").one(".grab-link-loader");this.guestpassLoaded=!0,e.removeClass("show-loader"),setTimeout(function(){this.guestpassLoaded&&e.setStyle("display","none")}.bind(this),500)},setupEmailSharing:function(){var t=this.get("container"),n=t.one(".email-recipient-text-field"),r=this.fakeInput=t.one(".fake-input"),i=this.input=this.get("container").one('[data-field="recipient"]'),s=t.one(".email-message-text-field"),o=t.one(".share-by-email"),u=this;this.focus&&(setTimeout(function(){n.focus()},100),this.focus=!1),n&&(this.to={},this.arrow=e.Node.create('<span class="ui-dialog-arrow contact-autocomplete-arrow"></span>'),n.on("focus",function(){r.addClass("focus"),i.get("value")===""?u.contacts.hide():u.contacts.search(),u._adjustInputWidth()}),n.on("blur",function(){i.ancestor(".fake-input").one(".pill")||t.one(".email-recipient-text-field").setStyle("width","inherit")}),i.on("blur",function(){var e,t=!1;e=u.contacts.selected,e&&e.email&&(t=!0,u._makePill(e,t),u.contacts.selected=null,u.get("container").one(".fake-input").insertBefore(i,u.contacts.wrapperEl)),r.removeClass("focus")}),i.on("keydown",function(e){var t,n,r;if(e.keyCode===8)this.get("value")===""&&(n=u.get("container").all(".pill"),r=n.pop(),r&&r.fire("remove")),setTimeout(function(){u._adjustInputWidth()},0);else if(e.keyCode===13||e.keyCode===9&&!e.shiftKey||e.keyCode===32||e.keyCode===188)t=u.contacts.selected,t&&t.email?(e.preventDefault(),u._makePill(t),u.contacts.selected=null,u._arrangeInput()):e.keyCode===13&&!u.contacts.selected&&(e.preventDefault(),this.get("value")===""&&u.get("container").one('[data-field="message"]').focus())}),i.on("keypress",function(e){var t=this.get("value");u._adjustInputWidth(t+String.fromCharCode(e.which)),u.contacts._reposition(),this.show()}),i.on("keyup",function(t){var n=e.Object.size(u.to)===0&&u.input.get("value")==="";n?o.setAttribute("disabled",!0):o.removeAttribute("disabled"),t.keyCode===8&&this.get("value")===""&&u._arrangeInput()}),s.on("keydown",function(e){e.keyCode===9&&!e.shiftKey&&(e.preventDefault(),o.focus())}),this.appContext.flipper.isFlipped("enable-share-restyle")||s.on("keyup",function(t){var n=s.get("value").trim()==="",r=e.Object.size(u.to)===0&&u.input.get("value")==="";n||r?o.setAttribute("disabled",!0):o.removeAttribute("disabled")}),r.delegate("click",function(e){u._arrangeInput()},".fake-input"),r.delegate("mouseover",function(e){var t=e.currentTarget,n=r.get("clientWidth"),i=t.get("offsetLeft"),s=parseInt(t.getComputedStyle("width").replace("px",""),10);u.appContext.flipper.isFlipped("enable-share-restyle")&&(i=t.get("offsetLeft")-r.get("offsetLeft")),n-i-s-10>0?(t.addClass("not-eol"),t.removeClass("end-of-the-line")):(t.removeClass("not-eol"),t.addClass("end-of-the-line"))},".pill"),this.contacts=new e.ContactSearchBox({el:n,appContext:this.appContext,shim:"c-contact-search-shim",signedOut:!this.appContext.getViewer().signedIn,alwaysDownward:!0,DOMContainer:t.one(".share-panel-body").getDOMNode(),loadingState:this.templates(e.Balls())(),onError:function(){n.blur(),u.contacts.hide()},onShow:function(e){var t=u.get("container"),n=u.get("container").one(".contact-list");t.on("click",function(e){e.target.get("tagName")!=="INPUT"&&n.getStyle("display")==="block"&&u.contacts.hide()})},onSelect:function(e,t){e&&e.nsid&&(u._makePill(e),u._arrangeInput())},dialogOffset:function(){var e=u.fakeInput.getDOMNode().getBoundingClientRect(),t=u.input.getDOMNode().getBoundingClientRect
();return e.height-t.height+10}}))},_adjustInputWidth:function(t){var n,r,i,s=this.get("container"),o=s.one(".share-by-email"),u=this;return t=t||this.input.get("value"),e.Object.size(this.to)===0&&t===""?(r=s.one(".fake-input"),r.removeClass("not-empty"),n=r.get("clientWidth"),s.one(".email-message-text-field").get("value").trim()!==""&&o.setAttribute("disabled",!0),this.input.setStyle("width",n-20),setTimeout(function(){u.input.focus()},10),n):(i=e.Node.create('<span class="width-check"></span>'),i.set("innerHTML",escape(t)),this.get("container").appendChild(i),n=i.get("clientWidth")||0,i.remove(),this.input.setStyle("width",(n||30)+5+"px"),setTimeout(function(){u.input.focus()},10),n)},_makePill:function(e,t){var n=escape(e.realname||e.email),r=this.templates("share-modal-mail-pill")({value:n}),i,s=this.get("container"),o=s.one(".share-by-email"),u=s.one(".fake-input"),a=this;u.addClass("not-empty"),s.one(".email-message-text-field").get("value").trim()!==""&&o.removeAttribute("disabled"),this.to[n]=e,a.completeSameEvent&&a.completeSameEvent.detach(),i=u.insertBefore(r,this.contacts.wrapperEl),i.on("remove",function(t){e.nsid?a.contacts.showInSearch(e.nsid):e.email&&!t&&(a.input.set("value",i.one("span:first-child").get("innerHTML")),a._adjustInputWidth()),delete a.to[n],i.remove(),a.flickrShare.recipients.some(function(t,n){return t.nsid&&t.nsid===e.nsid||!t.nsid&&t.name&&t.name===e.name?(a.flickrShare.recipients.splice(n,1),!0):!1})}),i.delegate("click",function(e){e.stopPropagation(),i.fire("remove",!0),a.input.focus()},".remove-tag"),i.on("dblclick",function(t){t.stopPropagation();var r=a.input;r.set("value",n),a._adjustInputWidth(n),i.replace(r),i.fire("remove"),setTimeout(function(){r.focus()},10),a.contacts.search(),a.completeSameEvent=r.once("blur",function(t){r.get("value")===n&&(a._makePill(e),a.input.set("value",""),a._arrangeInput())})}),e.nsid&&this.contacts.hideFromSearch(e.nsid),this.flickrShare.recipients.push(e),this.input.set("value",""),t||(this.input.focus(),a._adjustInputWidth())},_arrangeInput:function(){var e=this.input;this.get("container").one(".fake-input").insertBefore(e,this.contacts.wrapperEl),setTimeout(function(){e.focus()},10)},_onWarning:function(t,n,r){var i=e.Node.create(this.templates("fluid-warning")({message:t,title:n})),s=e.Node.create("<div></div>"),o=this.get("container"),u=20,a=this,f=o.get("clientWidth")+u,l=o.get("clientHeight")+u,c=500,h=100,p=f/2-(c+u)/2,d=l/2-(h+u)/2;i.setStyle("width",c),i.setStyle("height",h),i.setStyle("left",p),i.setStyle("top",d),s.setStyle("left",0),s.setStyle("top",0),s.setStyle("width","100%"),s.setStyle("height","100%"),s.addClass("warning-modal"),o.append(s),s.append(i),s.on("click",function(){s.remove(!0),r&&a.fire("subviewViewEvent","closeAll")})},_updateEmbedrOptions:function(t){var n=t.target.getData("setting"),r=t.target.getDOMNode().checked,i=this.get("container"),s=e.StorageHelper.getItem("fluid-share-panel-embedr-default-size"),o=i.one(".embed-demo-container");r?l[n]="true":l[n]="false",this.linkShareDisplay=this.generateLinkSharingDisplay(this.linkShareParams),this.linkShareDisplay.embedr.sizes.some(function(e){if(e.sizeKey===s)return i.one("."+u["embed-code-size-field"]).set("value",e.embedCode),i.one(".embed-code-size-field").one(".embed-code-label").set("text",e.sizeStr),!0}),l.header==="true"?o.addClass("show-header"):o.removeClass("show-header"),l.footer==="true"?o.addClass("show-footer"):o.removeClass("show-footer"),i.one(".embed-code-text-field").select(),e.StorageHelper.setItem("embedr-options",JSON.stringify(l))}})},"@VERSION@",{requires:["flickr-view","promise","hermes-template-fluid-share-panel","hermes-template-fluid-share-panel-restyle","fluid-css","fluid-share-panel-css","fluid-share-panel-restyle-css","fluid-droparound-view","hermes-template-fluid-share-embedr-code","hermes-template-fluid-share-bb-code","hermes-template-share-modal-mail-pill","hermes-template-fluid-warning","hermes-template-fluid-share-panel-error","hermes-template-fluid-share-old-html-embed-code","hermes-template-fluid-share-old-iframe-embed-code","fluid-modal-view","contact-search-box","fluid-balls-css","html5-balls","overflow-helper","url-helper","storage-helper"],optionalRequires:["global-events"],langBundles:["share-modal","common"]});
YUI.add("hermes-lang-share-modal_zh-hant-hk",function(e,t){e.Intl.add("hermes/share-modal","zh-Hant-HK",{SHARE_ON_BLOGGER:["\u5728 Blogger \u4e0a\u5206\u4eab"],SHARE_PHOTO:["\u5206\u4eab\u76f8\u7247"],SHARE_PHOTOS:["\u5206\u4eab\u76f8\u7247"],SHARE_VIDEO:["\u5206\u4eab\u5f71\u7247"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_BLOGGER:["\u8acb\u6388\u6b0a Flickr \u5728 Blogger \u4e0a\u767c\u4f48"],SHARE_ON_FACEBOOK:["\u5728 Facebook \u4e0a\u5206\u4eab"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_FACEBOOK:["\u8acb\u6388\u6b0a Flickr \u5728 Facebook \u4e0a\u767c\u4f48"],SHARE_VIA_MAIL:["\u900f\u904e\u96fb\u5b50\u90f5\u4ef6\u5206\u4eab"],SHARE_ON_TUMBLR:["\u5728 Tumblr \u4e0a\u5206\u4eab"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TUMBLR:["\u8acb\u6388\u6b0a Flickr \u5728 Tumblr \u4e0a\u767c\u4f48"],PUBLISH_NOW:["\u7acb\u5373\u767c\u4f48"],ADD_TO_QUEUE:["\u65b0\u589e\u81f3\u4f47\u5217"],SAVE_AS_DRAFT:["\u5132\u5b58\u70ba\u8349\u7a3f"],SHARE_ON_TWITTER:["\u5728 Twitter \u4e0a\u5206\u4eab"],PLEASE_AUTHORIZE_FLICKR_TO_POST_ON_TWITTER:["\u8acb\u6388\u6b0a Flickr \u5728 Twitter \u4e0a\u767c\u4f48"],SHARE_PHOTOSTREAM:["\u5206\u4eab\u76f8\u7247\u7246"],SHARE_ALBUM:["\u5206\u4eab\u76f8\u7c3f"],SHARE_FAVORITES:["\u5206\u4eab\u6700\u611b"],AUTHORIZE_TO_SHARE:["\u4f60\u5fc5\u9808\u6388\u6b0a Flickr \u624d\u80fd\u5728 ","${service}"," \u5206\u4eab\u76f8\u7247"],CONNECT_TO_SERVICE:["\u9023\u63a5\u81f3 ","${service}"],OK_TAKE_ME_TO_MY_SETTINGS:["\u597d\u7684\uff0c\u8b93\u6211\u79fb\u81f3\u6211\u7684\u8a2d\u5b9a"],POST:["\u767c\u4f48"],SHARE:["\u5206\u4eab"],FRIENDS:["\u670b\u53cb"],FAMILY:["\u5bb6\u4eba"],SCREEN_NAME_OR_EMAIL:["\u66b1\u7a31\u6216\u96fb\u5b50\u90f5\u4ef6"],INCLUDE_A_MESSAGE:["\u5305\u542b\u8a0a\u606f"],SHARE_THIS_VIA:["\u5206\u4eab\u6b64\u9805\u76ee\u7684\u65b9\u5f0f..."],SHARE_PREFERENCES:["\u5206\u4eab\u504f\u597d\u8a2d\u5b9a"],GRAB_THE_LINK:["\u53d6\u5f97\u9023\u7d50"],SHOW_SHORT_URL:["\u986f\u793a\u7c21\u77ed URL"],INCLUDE_CONTENT_MARKED_AS:["\u5305\u542b\u5177\u6709\u4e0b\u5217\u6a19\u7c64\u7684\u5167\u5bb9\uff1a"],PS_ITEMS_NOT_PUBLIC:["\u4f60\u6240\u6709\u76f8\u7247\u4e2d\u7684\u67d0\u4e9b\u9805\u76ee\u4e0d\u662f\u516c\u958b\u7684\u3002"],HERE_IS_PS_LINK:["\u9019\u662f\u6b64\u6240\u6709\u76f8\u7247\u7684\u9023\u7d50\u3002 \u53ea\u8981\u8907\u88fd\u4e26\u8cbc\u4e0a\u5373\u53ef\uff01"],YOU_CAN_ADD_GUEST_PASS:['\u4f60\u53ef\u4ee5\u65b0\u589e\u904a\u5ba2\u8eab\u4efd [<a class="guest-pass-link" title="',"${title}",'" data-action="follow" href="/help/sharing/#2184">?</a>]\uff0c\u4ee5\u4fbf\u63a5\u6536\u8005\u67e5\u770b\u3002'],ADD_A_GUEST_PASS:["\u65b0\u589e\u904a\u5ba2\u8eab\u4efd"],GUEST_PASS_COPY:["\u4f60\u53ef\u4ee5\u900f\u904e\u904a\u5ba2\u8eab\u4efd\u5206\u4eab\u4f60\u7684\u975e\u516c\u958b\u76f8\u7247\u3002 \u7121\u8ad6\u662f\u5426\u70ba Flickr \u6703\u54e1\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u96a8\u6642\u67e5\u770b\u4f60\u7684\u516c\u958b\u76f8\u7247\u3002 \u4f46\u662f\uff01 \u5982\u679c\u4f60\u60f3\u8981\u5206\u4eab\u6a19\u793a\u70ba\u670b\u53cb\u3001\u5bb6\u4eba\u6216\u79c1\u4eba\u7684\u76f8\u7247\uff0c\u8acb\u4f7f\u7528\u904a\u5ba2\u8eab\u4efd\u3002 \u5982\u679c\u8981\u5206\u4eab\u76f8\u7247\u96c6\u4e2d\u7684\u76f8\u7247\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u5305\u542b\u6240\u6709\u6a19\u793a\u70ba\u670b\u53cb\u3001\u5bb6\u4eba\u6216\u79c1\u4eba\u4e4b\u76f8\u7247\u7684\u904a\u5ba2\u8eab\u4efd\u3002 \u5982\u679c\u8981\u5206\u4eab\u6574\u500b\u6240\u6709\u76f8\u7247\uff0c\u4f60\u53ef\u4ee5\u5efa\u7acb\u5305\u542b\u6a19\u793a\u70ba\u670b\u53cb\u6216\u5bb6\u4eba\u4e4b\u76f8\u7247 (\u4f46\u4e0d\u5305\u542b\u79c1\u4eba\u76f8\u7247) \u7684\u904a\u5ba2\u8eab\u4efd\u3002"],VISIT_GUESTPASS_HISTORY:['\u4f60\u53ef\u4ee5\u96a8\u6642\u9020\u8a2a<a href="/invite/history/guests/" data-action="follow">\u904a\u5ba2\u8eab\u4efd\u6b77\u7a0b\u8a18\u9304</a>\u4ee5\u5c07\u904a\u5ba2\u8eab\u4efd\u8a2d\u70ba\u904e\u671f\u3002'],SOMETHING_WRONG:["\u767c\u751f\u554f\u984c\u3002<br>\u8acb\u91cd\u65b0\u6574\u7406\u60a8\u7684\u700f\u89bd\u5668\uff0c\u7136\u5f8c\u518d\u8a66\u4e00\u6b21\u3002"],ERROR:["\u932f\u8aa4"],OK:["\u78ba\u5b9a"],SHARE_GROUP:["\u5206\u4eab\u7fa4\u7d44"],MESSAGE:["\u8a0a\u606f"],EMAIL:["\u96fb\u5b50\u90f5\u4ef6"],SIGN_IN_TO_EMAIL:["\u4f60\u5fc5\u9808\u767b\u5165\u624d\u80fd\u5206\u4eab\u76f8\u7247\u3002 \u8acb\u767b\u5165\u4e26\u518d\u8a66\u4e00\u6b21\u3002"],LINK_ACCOUNT:["\u9023\u7d50\u5e33\u865f"],ACCOUNT_SETTINGS:["\u5e33\u865f\u8a2d\u5b9a"],AUTHORIZE_FLICKR:["\u8acb\u5728\u300c\u5e33\u865f\u8a2d\u5b9a\u300d\u9801\u9762\u4e2d\u6388\u6b0a Flickr \u4f7f\u7528\u4f60\u7684\u5e33\u865f\u3002"],COPY_TO_CLIPBOARD:["\u6309\u4e0b Ctrl+C (Win) / Cmd+C (Mac) \u4ee5\u5728\u9078\u64c7\u6642\u8907\u88fd\u6b64\u9023\u7d50"],HTML_EMBED:["HTML \u5167\u5d4c"],EMAIL_BODY_PHOTOS:["${username}"," \u8207\u4f60\u5206\u4eab\u4e86 ",{type:"plural",valueName:"count",options:{one:"${#} \u5f35\u76f8\u7247",other:"${#} \u5f35\u76f8\u7247"}},"\uff01"],EMAIL_BODY_ALBUM:["${username}"," \u8207\u4f60\u5206\u4eab\u4e86\u4ed6\u5011\u7684\u76f8\u7c3f\uff01"],EMAIL_BODY_PHOTOSTREAM:["${username}"," \u8207\u4f60\u5206\u4eab\u4e86\u4ed6\u5011\u7684\u6240\u6709\u76f8\u7247\uff01"],SHARE_PHOTOS_TO:[{type:"plural",valueName:"count",options:{one:"\u5206\u4eab ${#} \u5f35\u76f8\u7247\u81f3\uff1a",other:"\u5206\u4eab ${#} \u5f35\u76f8\u7247\u81f3\uff1a"}}],SHARE_VIDEO_TO:[{type:"plural",valueName:"count",options:{one:"\u5206\u4eab ${#} \u500b\u5f71\u7247\u7d66\uff1a",other:"\u5206\u4eab ${#} \u500b\u5f71\u7247\u7d66\uff1a"}}],SHARE_PHOTOSTREAM_TO:["\u5206\u4eab\u6240\u6709\u76f8\u7247\u81f3\uff1a"],SHARE_ALBUM_TO:["\u5206\u4eab\u76f8\u7c3f\u81f3\uff1a"],SHARE_FAVES_TO:["\u5206\u4eab\u6700\u611b\u81f3\uff1a"],SHARE_ALBUMS_TO:["\u5206\u4eab\u76f8\u7c3f\u81f3\uff1a"],SHARE_GROUP_TO:["\u5206\u4eab\u7fa4\u7d44\u81f3\uff1a"],FACEBOOK:["Facebook"],TUMBLR:["Tumblr"],TWITTER:["Twitter"],PINTEREST:["Pinterest"],MAIL:["Mail"],EMBED:["HTML \u5167\u5d4c"],EMBED_SIMPLE:["\u5167\u5d4c"],HTML:["HTML"],GRAB_LINK:["\u53d6\u5f97\u9023\u7d50"],BBCODE:["BBCode"],VIA_FLICKR
:["\u900f\u904e Flickr\uff1a"],SHARE_PUBLIC_ONLY:["\u50c5\u986f\u793a\u516c\u958b\u76f8\u7247"],SHARE_FRIENDS:["\u52a0\u5165\u6a19\u793a\u70ba\u670b\u53cb\u7684\u76f8\u7247"],SHARE_FAMILY:["\u52a0\u5165\u6a19\u793a\u70ba\u5bb6\u4eba\u7684\u76f8\u7247"],SHARE_FAMILY_AND_FRIENDS:["\u52a0\u5165\u6a19\u793a\u70ba\u5bb6\u4eba\u8207\u670b\u53cb\u7684\u76f8\u7247"],SHARE_FRIENDS_AND_FAMILY:["\u52a0\u5165\u6a19\u793a\u70ba\u670b\u53cb\u548c\u5bb6\u4eba\u7684\u76f8\u7247"],SHARE_PRIVATE:["\u6240\u6709\u76f8\u7247 - \u516c\u958b\u548c\u79c1\u4eba"],SHARING_DISABLED:["\u5df2\u505c\u7528\u5206\u4eab"],ON_FLICKR:["\u65bc Flickr"],PHOTO_PRIVATE_MESSAGE:['\u9019\u662f\u79c1\u4eba\u76f8\u7247\u3002 \u5c07\u52a0\u5165\u904a\u5ba2\u8eab\u4efd[<a target="_blank" href="/help/sharing/">\uff1f</a>]\u4ee5\u5141\u8a31\u6536\u4ef6\u4eba\u6aa2\u8996\u76f8\u7247\u3002'],PHOTO_FRIENDS_MESSAGE:['\u53ea\u6709\u670b\u53cb\u80fd\u770b\u5230\u6b64\u76f8\u7247\u3002 \u5c07\u52a0\u5165\u904a\u5ba2\u8eab\u4efd[<a target="_blank" href="/help/sharing/">\uff1f</a>]\u4ee5\u5141\u8a31\u6536\u4ef6\u4eba\u6aa2\u8996\u76f8\u7247\u3002'],PHOTO_FAMILY_MESSAGE:['\u53ea\u6709\u5bb6\u4eba\u80fd\u770b\u5230\u6b64\u76f8\u7247\u3002 \u5c07\u52a0\u5165\u904a\u5ba2\u8eab\u4efd[<a target="_blank" href="/help/sharing/">\uff1f</a>]\u4ee5\u5141\u8a31\u6536\u4ef6\u4eba\u6aa2\u8996\u76f8\u7247\u3002'],PHOTO_FAMILY_FRIENDS_MESSAGE:['\u53ea\u6709\u670b\u53cb\u548c\u5bb6\u4eba\u80fd\u770b\u5230\u6b64\u76f8\u7247\u3002 \u5c07\u52a0\u5165\u904a\u5ba2\u8eab\u4efd[<a target="_blank" href="/help/sharing/">\uff1f</a>]\u4ee5\u5141\u8a31\u6536\u4ef6\u4eba\u6aa2\u8996\u76f8\u7247\u3002'],PHOTO_CAMERAROLL_MESSAGE:["\u7121\u8ad6\u8a2d\u5b9a\u4e86\u4ec0\u9ebc\u79c1\u96b1\u5c64\u7d1a\uff0c\u6536\u4ef6\u4eba\u90fd\u6703\u770b\u5230\u6240\u6709\u88ab\u5206\u4eab\u7684\u76f8\u7247\u3002"],GUESTPASS_CREATION_FAILURE:["\u7522\u751f\u5206\u4eab\u9023\u7d50\u6642\u767c\u751f\u932f\u8aa4\u3002  \u8acb\u518d\u8a66\u4e00\u6b21\u3002"],CONTACT_SEARCH_ERROR:["\u65b0\u589e\u6536\u4ef6\u4eba\u6642\u767c\u751f\u932f\u8aa4\u3002 \u8acb\u518d\u8a66\u4e00\u6b21\u3002"],FLICKR_SHARE_ERROR:["\u5728 Flickr \u4e0a\u5206\u4eab\u6642\u767c\u751f\u932f\u8aa4\u3002 \u8acb\u518d\u8a66\u4e00\u6b21\u3002"],FLICKR_SHARE_SUCCESS:["\u6709\u4eba\u5206\u4eab\u4f60\u7684\u9805\u76ee\uff01"],FLICKR_SHARE_SUCCESS_TITLE:["\u6210\u529f"],CLICK_GENERATE_LINK:["\u6309\u4e00\u4e0b\u4ee5\u7522\u751f\u5206\u4eab\u9023\u7d50"],FLICKR_SHARE:["\u5206\u4eab"],COPY_MAC:["\u5728\u9078\u64c7\u9019\u500b\u9023\u7d50\u5f8c\uff0c\u6309 Command+C \u4f86\u8907\u88fd\u9023\u7d50"],COPY_PC:["\u5728\u9078\u64c7\u9019\u500b\u9023\u7d50\u5f8c\uff0c\u6309 Ctrl+C \u4f86\u8907\u88fd\u9023\u7d50"],CANCEL_SHARE_BECAUSE_ERROR:[{type:"plural",valueName:"photoCount",options:{one:"\u7121\u6cd5\u5206\u4eab\u9019\u5f35\u76f8\u7247\u3002 \u8acb\u7a0d\u5f8c\u518d\u8a66\u4e00\u6b21\u3002",other:"\u7121\u6cd5\u5206\u4eab\u9019\u4e9b\u76f8\u7247\u3002 \u8acb\u7a0d\u5f8c\u518d\u8a66\u4e00\u6b21\u3002"}}],LINK_PRIVACY_REMINDER:[{type:"plural",valueName:"photoCount",options:{one:"\u9019\u5f35\u6240\u9078\u7684\u79c1\u4eba\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u3002 \u5982\u7528\u6236\u64c1\u6709\u4f60\u5206\u4eab\u7684\u9023\u7d50\u624d\u80fd\u770b\u5230\u9019\u4e9b\u76f8\u7247\u3002",other:"\u9019\u4e9b\u6240\u9078\u7684\u79c1\u4eba\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u3002 \u5982\u7528\u6236\u64c1\u6709\u4f60\u5206\u4eab\u7684\u9023\u7d50\u624d\u80fd\u770b\u5230\u9019\u4e9b\u76f8\u7247\u3002"}}],PHOTO_PAGE_PRIVACY_WARNING:["\u9019\u5f35\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u72c0\u614b\u3002\u53ea\u6709\u6536\u5230\u4f60\u5206\u4eab\u9023\u7d50\u7684\u6703\u54e1\u624d\u80fd\u770b\u5230\u9019\u5f35\u76f8\u7247\u3002"],CAMERAROLL_PRIVACY_WARNING:[{type:"plural",valueName:"photoCount",options:{one:"\u9019\u5f35\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u72c0\u614b\u3002\u53ea\u6709\u6536\u5230\u4f60\u5206\u4eab\u9023\u7d50\u7684\u6703\u54e1\u624d\u80fd\u770b\u5230\u9019\u5f35\u76f8\u7247\u3002",other:"\u6240\u6709\u5df2\u9078\u7684\u79c1\u4eba\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u72c0\u614b\u3002\u53ea\u6709\u6536\u5230\u4f60\u5206\u4eab\u9023\u7d50\u7684\u6703\u54e1\u624d\u80fd\u770b\u5230\u9019\u4e9b\u76f8\u7247\u3002"}}],ALBUM_PRIVACY_WARNING:[{type:"plural",valueName:"photoCount",options:{one:"\u6b64\u76f8\u7c3f\u4e2d\u7684\u79c1\u4eba\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u72c0\u614b\u3002\u53ea\u6709\u6536\u5230\u4f60\u5206\u4eab\u9023\u7d50\u7684\u6703\u54e1\u624d\u80fd\u770b\u5230\u9019\u5f35\u76f8\u7247\u3002",other:"\u6b64\u76f8\u7c3f\u4e2d\u7684\u6240\u6709\u79c1\u4eba\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u72c0\u614b\u3002\u53ea\u6709\u6536\u5230\u4f60\u5206\u4eab\u9023\u7d50\u7684\u6703\u54e1\u624d\u80fd\u770b\u5230\u9019\u4e9b\u76f8\u7247\u3002"}}],PHOTOSTREAM_PRIVACY_WARNING:[{type:"plural",valueName:"photoCount",options:{one:"\u6240\u6709\u76f8\u7247\u4e2d\u7684\u79c1\u4eba\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u72c0\u614b\u3002\u53ea\u6709\u6536\u5230\u4f60\u5206\u4eab\u9023\u7d50\u7684\u6703\u54e1\u624d\u80fd\u770b\u5230\u9019\u5f35\u76f8\u7247\u3002",other:"\u6240\u6709\u76f8\u7247\u4e2d\u7684\u5168\u90e8\u79c1\u4eba\u76f8\u7247\u5c07\u6703\u4fdd\u6301\u70ba\u79c1\u4eba\u72c0\u614b\u3002\u53ea\u6709\u6536\u5230\u4f60\u5206\u4eab\u9023\u7d50\u7684\u6703\u54e1\u624d\u80fd\u770b\u5230\u9019\u4e9b\u76f8\u7247\u3002"}}],CANCEL_SHARE_BECAUSE_RESTRICTED:["\u62b1\u6b49\uff01 \u4f60\u7121\u6cd5\u5206\u4eab\u53d7\u9650\u5236\u7684\u76f8\u7247\u3002"],NO_SHAREABLE_ITEMS:["\u6c92\u6709\u4efb\u4f55\u53ef\u5206\u4eab\u7684\u9805\u76ee\u3002"],EMBEDR_OPTION_HEADER:["\u6a19\u984c"],EMBEDR_OPTION_FOOTER:["\u9801\u5c3e"],EMBEDR_OPTION_TRUNCATE:["\u4e0d\u986f\u793a"],EMBEDR_OPTION_SLIDESHOW:["\u5e7b\u71c8\u7247"],ALBUM_DOWNLOAD_ACCESS_YOU:[{type:"plural",valueName:"photoCount",options:{one:"\u53ea\u6709\u4f60\u80fd\u4e0b\u8f09\u6b64\u76f8\u7247\u3002"
,other:"\u53ea\u6709\u4f60\u80fd\u4e0b\u8f09\u9019\u4e9b\u76f8\u7247\u3002"}}],ALBUM_DOWNLOAD_ACCESS_FF:[{type:"plural",valueName:"photoCount",options:{one:"\u53ea\u6709\u4f60\u7684\u89aa\u53cb\u80fd\u4e0b\u8f09\u6b64\u76f8\u7247\u3002",other:"\u53ea\u6709\u4f60\u7684\u89aa\u53cb\u80fd\u4e0b\u8f09\u9019\u4e9b\u76f8\u7247\u3002"}}],ALBUM_DOWNLOAD_ACCESS_FOLLOWING:[{type:"plural",valueName:"photoCount",options:{one:"\u53ea\u6709\u8ffd\u8e64\u4f60\u7684\u4eba\u80fd\u4e0b\u8f09\u6b64\u76f8\u7247\u3002",other:"\u53ea\u6709\u8ffd\u8e64\u4f60\u7684\u4eba\u80fd\u4e0b\u8f09\u9019\u4e9b\u76f8\u7247\u3002"}}],ALBUM_DOWNLOAD_ACCESS_MEMBERS:[{type:"plural",valueName:"photoCount",options:{one:"\u53ea\u6709 Flickr \u6703\u54e1\u80fd\u4e0b\u8f09\u6b64\u76f8\u7247\u3002",other:"\u53ea\u6709 Flickr \u6703\u54e1\u80fd\u4e0b\u8f09\u9019\u4e9b\u76f8\u7247\u3002"}}],ALBUM_DOWNLOAD_ACCESS_EVERYONE:[{type:"plural",valueName:"photoCount",options:{one:"\u6240\u6709\u4eba\u90fd\u80fd\u4e0b\u8f09\u6b64\u76f8\u7247\u3002",other:"\u6240\u6709\u4eba\u90fd\u80fd\u4e0b\u8f09\u9019\u4e9b\u76f8\u7247\u3002"}}],CHANGE_DOWNLOAD_PREF:["(<a href='","${url}","'>\u8b8a\u66f4\u4f60\u7684\u4e0b\u8f09\u504f\u597d\u8a2d\u5b9a</a>)"]})},"@VERSION@",{requires:["intl"]});
YUI.add("fluid-share-view",function(e,t){var n=require("lib/flog")(t),r="signedOutEmailSharing",i={shareRedirectURL:e.url("/window_close.html"),css:{shareBtn:"fluid-share-button",networkClasses:{twitter:{canShare:!1,className:"twitter-link",serviceId:9},facebook:{canShare:!1,className:"facebook-link",serviceId:128},tumblr:{canShare:!1,className:"tumblr-link",serviceId:12},pinterest:{canShare:!1,className:"pinterest-link",serviceId:132},flickr:{canShare:!1,className:"flickr-link",serviceId:130}}}};i.networks={facebook:{clientId:e.config.flickr.facebook.client_id,shareUrl:"https://www.facebook.com/dialog/share?app_id="+e.config.flickr.facebook.client_id+"&display=popup&redirect_uri="+encodeURIComponent(i.shareRedirectURL)+"&href="},twitter:{shareUrl:"https://twitter.com/intent/tweet?text={{tweetText}}&url={{linkToShare}}",hashTags:"#flickr"},tumblr:{shareUrl:"https://www.tumblr.com/widgets/share/tool?caption={{tumblrCaption}}&tags={{tags}}&url={{linkToShare}}"},pinterest:{shareUrl:"https://pinterest.com/pin/create/bookmarklet/?media={{displayPhotoURL}}&url={{linkToShare}}&description={{description}}"},googlePlus:{shareUrl:"https://plus.google.com/share?url="},flickr:{apiCall:"flickr.sharing.post"}},"use strict",e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.extraModalClasses=this.extraModalClasses||"",this.appContext.lang.toLowerCase()==="en-us"?this.isEnglishLang=!0:this.isEnglishLang=!1,this},loadState:function(){return e.Promise.resolve()},buildContainer:function(e){return e=e||{},this.setContainerWithTemplate("fluid-share",e),this},activate:function(){var t=this.get("container"),n="."+i.css.shareBtn,r=t.one(n);return r&&(this.isEnglish||!this.isDisabled)&&this.registerEventHandler(t.delegate("click",function(t){t.preventDefault(),e.rapidTracker.beacon(this.subClassName,"shareButtonClick"),this.getItemCount().then(function(t){e.rapidTracker.beacon(this.subClassName,"shareButtonClickCount",{count:t})}.bind(this)),this.prepareModal(r)},n,this)),this},prepareModal:function(e){this.shouldCancelModal()||this.getItemCount().then(function(t){this.isDisabled?this.showErrorModal():this.showModal(e,t)}.bind(this)).catch(function(e){n.error({err:e})})},showModal:function(t,n){var s=this,o=this.getIsMine(),u=i.css.networkClasses,a=s.getTitleIntlKey(),f={intlName:"share-modal."+a},l;if(a==="SHARE_PHOTOS_TO"||a==="SHARE_VIDEO_TO")f.count=n;l=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,noScroll:!0,hideModalOverlay:!1,maxHeight:!1,showFooter:!1,title:s.intlMessage(f),classList:"modal-restyle "+s.extraModalClasses,width:560,subview:new e.Views["fluid-share-panel-view"]({appContext:s.appContext,networkClasses:u,linkShareParams:this.prepareLinkShareParameters(),guestPassParams:this.getGuestPassParams(),emailShareParams:this.prepareFlickrShareParameters(),isMine:o,shareItemCount:n,signedOutSharingPerms:this.getSignedOutSharingPerms(),canVr:this.get("canVr")})}),l.registerEventHandler(l.get("container").delegate("click",function(e){e.preventDefault(),e.target.ancestor("."+u.facebook.className,!0)?s.preProcessShare(s.prepareFacebookShareParameters,s.shareToFacebook):e.target.ancestor("."+u.twitter.className,!0)?s.preProcessShare(s.prepareTwitterShareParameters,s.shareToTwitter):e.target.ancestor("."+u.tumblr.className,!0)?s.preProcessShare(s.prepareTumblrShareParameters,s.shareToTumblr):e.target.ancestor("."+u.pinterest.className,!0)&&s.preProcessShare(s.preparePinterestShareParameters,s.shareToPinterest)},".share-link.sharing-type-enabled")),l.on("share-by-email",function(t){var n=e.merge(s.prepareFlickrShareParameters(),t);s.shareToFlickr(l,n)}),l.on("done-sharing",function(t){l.close(),s.guestPassURLs={},e.rapidTracker.beacon(this.subClassName,"doneSharingClick")}),l.on("request-guestpass",function(e,t,n){s.requestGuestpass(l,t,n,!0)}),l.on("generate-link",function(){s.generateLink().then(function(e){l.fire("parentViewEvent","generated-link",e)})}),l.on("activated",function(){l.get("subview").cancel&&l.get("container").one(".title").setHTML(s.intlMessage({intlName:"common.OOPS"})),l.reposition()}),l.on("guestpass-required",function(){s.guestpassRequired=!0}),l.on("confirm-sign-in",function(){l.close();var t=new e.Views.FluidModal({appContext:s.appContext,title:s.intlMessage({intlName:"common.OOPS"}),message:s.intlMessage({intlName:"share-modal.SIGN_IN_TO_EMAIL"}),actionButtonLabel:s.intlMessage({intlName:"common.OK"}),classList:"sharing-sign-out-modal",showCancelButton:!0});t.on("actionClick",function(){e.StorageHelper.setItem(r,new Date),e.SigninHelper.addPendingShare({shareType:"email"})}),setTimeout(function(){t.show()},10)}),l.on("close",function(){s.fire("sharePresentationClose"),s.guestPassURLs={},e.rapidTracker.beacon(s.name,"shareModalCancelClick")}),l.on("closeAll",function(){s.fire("sharePresentationClose"),l.close(),s.guestPassURLs={}}),l.show(),this.sharePresentation=l},showErrorModal:function(){var t=new e.Views.FluidModal({appContext:this.appContext,dismissOnOverlayClick:!0,showCancelButton:!1,noScroll:!0,hideModalOverlay:!1,showFooter:!0,title:this.intlMessage({intlName:"common.OOPS"}),message:this.intlMessage({intlName:"share-modal.NO_SHAREABLE_ITEMS"})});t.show()},prepareFacebookShareParameters:function(){return{url:"",count:1}},prepareTwitterShareParameters:function(){return{shortURL:"",url:"",title:"",count:1}},prepareTumblrShareParameters:function(){return{title:"",authorURL:"",ownerName:"",description:"",displayPhotoURL:"",url:"",count:1}},preparePinterestShareParameters:function(){return{title:"",description:"",displayPhotoURL:"",shortURL:"",url:"",count:1}},prepareGooglePlusShareParameters:function(){return{url:"",count:1}},prepareFlickrShareParameters:function(){return{modelName:"",modelId:"",title:"",url:"",count:1}},prepareLinkShareParameters:function(){return{sizes:{},url:"",title:"",author:"",authorURL:"",
shortURL:"",supportsEmbedr:!1,supportsBBCode:!1,privacyWarningString:"",generateLink:!1}},getTitleIntlKey:function(){return"SHARE_PHOTOS_TO"},getItemCount:function(){return e.Promise.resolve(1)},getIsMine:function(){return!1},getGuestPassParams:function(){return{type:null,id:null,contentMarkedFriends:!0,contentMarkedFamily:!0,contentMarkedFriendFamily:!0,contentMarkedPublic:!0,canSharePrivate:!1,sharingEntirelyNotPublic:!1,multipleItems:!1,nonPublicWarning:null,shareToAll:!1,showGuestPassDropdown:!1,shareToSpecific:null}},getSignedOutSharingPerms:function(){return{facebook:{canShare:!0},twitter:{canShare:!0},tumblr:{canShare:!0},pinterest:{canShare:!0},flickr:{canShare:!1}}},shouldCancelModal:function(){return!1},shareToFacebook:function(t,r){if(!t.url)return n.error("Error sharing to Facebook.  Missing url.");var s,o=encodeURIComponent(e.url(t.url)),u=this.guestPassURLs,a,f,l,c;this.guestpassRequired&&u&&(a=u[100],f=u["010"],l=u[110],c=u[111],f&&(o=f),a&&(o=a),l&&(o=l),c&&(o=c)),s=i.networks.facebook.shareUrl+o,e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"facebook",count:t.count||1}),r?r.location.replace(s):r=this.createSharePopup(s),this.trackShareCompletion(r)},shareToTwitter:function(t,r){if(typeof t.url=="undefined"||t.url===null)return n.error("Error sharing to Twitter.  Missing url.");if(!t.title)return n.error("Error sharing to Twitter.  Missing title.");var s,o,u=t.title,a,f;o=t.url===""?"":encodeURIComponent(t.url),f=u+" "+i.networks.twitter.hashTags,f.length+o.length>140&&(a=f.length+o.length-140,f=u.substring(0,u.length-(a+1))+"\u2026"+" "+i.networks.twitter.hashTags),s=i.networks.twitter.shareUrl.replace("{{tweetText}}",encodeURIComponent(f)).replace("{{linkToShare}}",o),r?r.location.replace(s):r=this.createSharePopup(s),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"twitter",count:t.count||1}),this.trackShareCompletion(r)},shareToTumblr:function(t,r){if(!t.title)return n.error("Error sharing to Tumblr.  Missing title.");if(!t.displayPhotoURL)return n.error("Error sharing to Tumblr.  Missing displayPhotoURL.");var s,o=t.title,u,a,f=t.tags||"",l=t.description,c,h=e.URLHelper.addProtocolToURL(t.displayPhotoURL),p,d=t.isPhotoPage,v=i.networks.tumblr.shareUrl;if(!d||!this.appContext.flipper.isFlipped("enable-tumblr-embed-share"))v+="&shareSource=legacy&posttype=photo&content={{displayPhotoURL}}&clickthroughUrl={{linkToShare}}";t.authorURL&&(u=e.url(t.authorURL)),t.ownerName&&(a=t.ownerName),t.url.indexOf("https://")===0?c=t.url:t.url.indexOf("//")===0?c=e.URLHelper.addProtocolToURL(t.url):c=e.url(t.url),s=this.templates("fluid-share-tumblr-post")({title:o,ownerURL:u,ownerName:a,description:l,linkToShare:c}),p=v.replace("{{displayPhotoURL}}",encodeURIComponent(h)).replace("{{tumblrCaption}}",encodeURIComponent(s)).replace(/{{linkToShare}}/g,encodeURIComponent(c)).replace("{{tags}}",encodeURIComponent(f)),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"tumblr",count:t.count||1}),r?r.location.replace(p):r=this.createSharePopup(p,!0)},shareToPinterest:function(t,r){if(!t.title)return n.error("Error sharing to Pinterest.  Missing title.");if(!t.displayPhotoURL)return n.error("Error sharing to Pinterest.  Missing displayPhotoURL.");if(!t.url)return n.error("Error sharing to Pinterest.  Missing url.");if(!t.shortURL)return n.error("Error sharing to Pinterest.  Missing shortURL.");var s,o,u=e.Handlebars.helpers.stripTags(t.description)||"",a=t.shortURL,f=t.title,l=e.URLHelper.addProtocolToURL(t.displayPhotoURL),c;o=encodeURIComponent(e.url(t.url)),u.trim()!==""?c=a+" | "+f+" | "+u:c=a+" | "+f,l=l.replace("https:","http:"),o=o.replace("https:","http:"),s=i.networks.pinterest.shareUrl.replace("{{displayPhotoURL}}",encodeURIComponent(l)).replace("{{description}}",encodeURIComponent(c)).replace("{{linkToShare}}",o),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"pinterest",count:t.count||1}),r?r.location.replace(s):r=this.createSharePopup(s,!0)},shareToGooglePlus:function(t,r){if(!t.url)return n.error("Error sharing to GooglePlus.  Missing url.");var s,o;o=encodeURIComponent(e.url(t.url)),s=i.networks.googlePlus.shareUrl+o,e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"googlePlus",count:t.count||1}),r?r.location.replace(s):r=this.createSharePopup(s)},shareToFlickr:function(t,s){if(!s.recipients)return n.error("Error sharing to Flickr.  Missing recipients.");if(!s.url)return n.error("Error sharing to Flickr.  Missing url.");if(!s.modelName)return n.error("Error sharing to Flickr.  Missing modelName.");if(!s.modelId)return n.error("Error sharing to Flickr.  Missing modelId.");var o,u=s.modelName,a=s.modelId,f=s.recipients,l=s.message||"",c=s.guestpassStr||"public",h={},p=[],d=[],v,m;o=encodeURIComponent(e.url(s.url)),u==="share_code"?h[u]=a:h[u+"_id"]=a,h.service_type_id="130",h.owner_id=this.appContext.getViewer().nsid;if(c!=="public"){if(c==="friends"||c==="family_and_friends")h.guestpass_friends="1";if(c==="family"||c==="family_and_friends")h.guestpass_family="1";c==="private"&&(h.guestpass_private="1",h.guestpass_friends="1",h.guestpass_family="1")}for(v in f)m=f[v]||{},m.email?p.push(m.email):m.nsid&&d.push(m.nsid);h.to_flickr=d.join(","),h.to_email=p.join(","),h.message=e.flutil.escapeInput(l),e.rapidTracker.beacon(this.get("parentViewName"),"shareNetworkClick",{type:"flickr",count:s.count||1,flkcnt:d.length,emailcnt:p.length});var g=e.StorageHelper.getItem(r);if(g){var y;try{y=e.moment(g),y.isValid()&&(new e.moment).diff(y,"hours")<2&&(e.rapidTracker.beacon(this.get("parentViewName"),"signedOutEmailShare",{count:s.count||1}),e.StorageHelper.remove(r))}catch(b){}}if(!i.networks)throw new Error("Missing sharing api configuration.");this.appContext.callAPI(i.networks.flickr.apiCall,h).then(function(){t&&t.fire("parentViewEvent","flickr-share-success")},function(e){t&&t.fire("parentViewEvent","flickr-share-error")})},generateLink:function(){var t=this
;return this.onBeforeShare().then(function(e){return e},function(n){t.sharePresentation.fire("closeAll"),setTimeout(function(){var n=new e.Views.FluidModal({appContext:t.appContext,title:t.intlMessage({intlName:"common.OOPS"}),message:t.intlMessage({intlName:"share-modal.CANCEL_SHARE_BECAUSE_ERROR",photoCount:t.getGuestPassParams.multipleItems?10:1}),actionButtonLabel:t.intlMessage({intlName:"common.OK"}),classList:"sharing-failure-modal",showCancelButton:!1});n.show()},10)})},preProcessShare:function(e,t){var r=this;if(this.onBeforeShare){var i=this.createSharePopup("",!0);try{i.document.body.innerHTML=r.templates("fluid-share-loading-state")()}catch(s){s.code===18&&(i.close(),i=this.createSharePopup("",!0),i.document.body.innerHTML=r.templates("fluid-share-loading-state")())}this.onBeforeShare().then(function(s){var o;try{o=e.call(r)}catch(u){n.error("Error getting share parameters",{err:u})}t.call(r,o,i)})}else{var o;try{o=e.call(r)}catch(u){n.error("Error getting share parameters",{err:u})}t.call(r,o)}},trackShareCompletion:function(t){var r=function(i){if(i.source===t)if(i.origin===e.url("/")&&i.data==="Window closed")n.log("Closing Facebook window."),e.rapidTracker.beacon(this.get("parentViewName"),"photoSharedToFacebook"),e.config.win.removeEventListener("message",r,!1);else if(i.origin===e.url("/")&&i.data.indexOf("share failure")===0)n.error("Got Facebook error",{data:i.data}),e.config.win.removeEventListener("message",r,!1);else if(i.origin==="https://twitter.com"&&i.data!=="__ready__")try{n.log("Tracking share completion",{data:i.data}),JSON.parse(i.data).params[0]==="tweet"&&i.returnValue&&(e.rapidTracker.beacon(this.get("parentViewName"),"photoSharedToTwitter"),e.config.win.removeEventListener("message",r,!1))}catch(s){n.error("Error tracking share completion",{err:s})}};e.config.win.addEventListener("message",r,!1)},createSharePopup:function(t,n){var r={},i="",s="nativeShare"+(new Date).getTime();return r.width=n?950:640,r.height=480,r.top=(e.config.win.screen.height-r.height)/2,r.left=(e.config.win.screen.width-r.width)/2,e.Object.each(r,function(e,t){i+=t+"="+e+","}),i=i.slice(0,-1),e.config.win.open(t,s,i)},requestGuestpass:function(e,t,n,r){var i=this;this.guestPassURLs||(this.guestPassURLs={});if(this.guestPassURLs[t]){e.fire("parentViewEvent","guestpass-created",t,this.guestPassURLs[t]);return}this.appContext.callAPI("flickr.sharing.createGuestpass",n).then(function(n){if(!n||!n.guestpass||!n.guestpass.url)throw new Error("No guestpass returned");i.guestPassURLs[t]=n.guestpass.url,e.fire("parentViewEvent","guestpass-created",t,i.guestPassURLs[t])},function(s){r?i.requestGuestpass(e,t,n):e.fire("parentViewEvent","guestpass-failed",s)})}},{ATTRS:{parentViewName:{value:""}}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-css","fluid-modal-view","hermes-template-fluid-share","hermes-template-fluid-share-tumblr-post","hermes-template-fluid-share-loading-state","fluid-share-panel-view","url","flutil","url-helper","signin-helper","handlebars-helpers"],optionalRequires:["fluid"],langBundles:["share-modal","common"]});
YUI.add("fluid-share-photo-view",function(e,t){e.FlickrView.create(this.name,e.namespace("Views")["fluid-share-view"],[],{langBundles:this.details.langBundles,subClassName:t,initializer:function(e){return this.nsid=e.nsid,this.photoId=e.photoId,this.constructor.superclass.initializer.call(this,e)},loadState:function(){var t=this;return e.Promise.all([this.appContext.getModel("photo-models",this.photoId),this.appContext.getModel("photo-privacy-models",this.photoId),this.appContext.getModel("photo-engagement-models",this.photoId),this.appContext.getModel("photo-tags-models",this.photoId)]).then(function(e){return t.set("photoModel",e[0]),t.set("privacyModel",e[1]),t.set("engagementModel",e[2]),t.set("photoTagsModels",e[3]),t.set("tags",t.get("photoTagsModels").getValue("tags").toJSON()),t.get("photoModel").canVr().then(function(e){t.set("canVr",e)})})},buildContainer:function(){var e=this.get("photoModel").getValue("safetyLevel")===2;return this.get("photoModel").getValue("owner").id!==this.appContext.getViewer().nsid&&(e=e||!this.get("privacyModel").getValue("isPublic")),this.constructor.superclass.buildContainer.call(this,{extraShareButtonIconClassList:"share-photo-icon",showShareButtonLabel:!1,sharingDisabled:e,shareTooltip:this.intlMessage({intlName:"share-modal.SHARE_PHOTO"})}),this},prepareFacebookShareParameters:function(){return{url:this.get("photoModel").getValue("url")}},prepareTwitterShareParameters:function(){var t=this.get("photoModel");return{url:e.URLHelper.getShortURL(t.getValue("id")),title:t.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"})}},prepareTumblrShareParameters:function(){var e=this.get("photoModel"),t=e.getValue("owner"),n=e.getLargestSize({excludeSizes:["o"]}).displayUrl,r=this.appContext.flipper.isFlipped("enable-flickr-embeds-on-tumblr");return{title:e.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),authorURL:t.getValue("url"),ownerName:t.getValue("displayname"),description:e.getValue("description"),displayPhotoURL:r?e.getValue("url"):n,url:e.getValue("url"),isPhotoPage:!0,tags:this.get("tags").map(function(e){return e.tagRaw}).join(",")}},preparePinterestShareParameters:function(){var t=this.get("photoModel");return{title:t.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),description:t.getValue("description"),displayPhotoURL:t.getLargestSize({excludeSizes:["o"]}).displayUrl,shortURL:e.URLHelper.getShortURL(t.getValue("id")),url:t.getValue("url"),count:1}},prepareFlickrShareParameters:function(){var e=this.get("photoModel");return{title:e.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),modelName:"photo",modelId:e.getValue("id"),url:e.getValue("url"),count:1}},prepareLinkShareParameters:function(){var t=this.get("photoModel"),n=this.get("engagementModel").getValue("canShare"),r;return n&&this.get("photoModel").getValue("isVideo")&&this.appContext.flipper.isFlipped("enable-embedr-video")?r=!0:r=n&&!this.get("photoModel").getValue("isVideo"),{url:this.appContext.flipper.isFlipped("enable-embedr-in-share")?e.config.win.location.pathname:t.getValue("url"),author:t.getValue("owner").getValue("displayname"),authorURL:t.getValue("owner").getValue("url"),shortURL:e.URLHelper.getShortURL(t.getValue("id")),supportsEmbedr:r,supportsBBCode:n,sizes:t.getValue("sizes"),title:t.getValue("title")||this.intlMessage({intlName:"default.UNTITLED"}),secret:t.getValue("secret"),privacyWarningString:this.intlMessage({intlName:"share-modal.PHOTO_PAGE_PRIVACY_WARNING"}),aspectRatio:t.getValue("aspectRatio")}},getTitleIntlKey:function(){var e=this.get("photoModel");return e.getValue("isVideo")?"SHARE_VIDEO_TO":"SHARE_PHOTOS_TO"},getGuestPassParams:function(){var e=this.get("privacyModel"),t=e.getValue("isVisibleByFriends"),n=e.getValue("isVisibleByFamily"),r=!e.getValue("isPublic"),i=this.get("photoModel"),s=i.getValue("isOwner"),o;return n&t?o=this.intlMessage({intlName:"share-modal.PHOTO_FAMILY_FRIENDS_MESSAGE"}):n?o=this.intlMessage({intlName:"share-modal.PHOTO_FAMILY_MESSAGE"}):t?o=this.intlMessage({intlName:"share-modal.PHOTO_FRIENDS_MESSAGE"}):r&&(o=this.intlMessage({intlName:"share-modal.PHOTO_PRIVATE_MESSAGE"})),{type:"photo",id:this.photoId,contentMarkedFriends:s&&t&&!n,contentMarkedFamily:s&&n&&!t,contentMarkedFriendFamily:s&&n&&t,contentMarkedPublic:!r&&!n&&!t,canSharePrivate:s&&r&&!n&&!t,showGuestPassDropdown:s&&r,multipleItems:!1,sharingEntirelyNotPublic:s&&r,nonPublicWarning:o}},getIsMine:function(){return this.get("photoModel").getValue("isOwner")},getSignedOutSharingPerms:function(){var e=this.get("engagementModel").getValue("canShare");return{facebook:{canShare:e},twitter:{canShare:e},tumblr:{canShare:e},pinterest:{canShare:e},flickr:{canShare:!1}}},onParentViewEvent:function(e,t){(t[0]==="enable-sharing"||t[0]==="disable-sharing")&&this.buildContainer()},shouldCancelModal:function(){var e=this.get("photoModel").getValue("safetyLevel")===2;return e&&this.buildContainer(),e}})},"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-share-view","url-helper","flutil"],langBundles:["models","default","share-modal"]});
YUI.add("hermes-lang-default_zh-hant-hk",function(e,t){e.Intl.add("hermes/default","zh-Hant-HK",{UNTITLED:["\u7121\u6a19\u984c"]})},"@VERSION@",{requires:["intl"]});
