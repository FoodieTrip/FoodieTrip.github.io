YUI.add("hermes-template-photo-sidebar-toggle",function(e,t){var n=e.Template.Handlebars.revive({1:function(e,t,n,r,i){return"Close"},3:function(e,t,n,r,i){return"Open"},5:function(e,t,n,r,i){return"fullscreen"},7:function(e,t,n,r,i){return"&#10529;"},9:function(e,t,n,r,i){return"&#10530;"},compiler:[7,">= 4.0.0"],main:function(e,t,n,r,i){var s,o,u=t!=null?t:{};return'<a href="'+e.escapeExpression((o=(o=n.url||(t!=null?t.url:t))!=null?o:n.helperMissing,typeof o=="function"?o.call(u,{name:"url",hash:{},data:i}):o))+'" class="toggle" data-track="lightbox'+((s=n["if"].call(u,t!=null?t.isRealFullscreen:t,{name:"if",hash:{},fn:e.program(1,i,0),inverse:e.program(3,i,0),data:i}))!=null?s:"")+'Click">\n	<span class="toggle-icon hide-text '+((s=n["if"].call(u,t!=null?t.isRealFullscreen:t,{name:"if",hash:{},fn:e.program(5,i,0),inverse:e.noop,data:i}))!=null?s:"")+'">'+((s=n["if"].call(u,t!=null?t.isRealFullscreen:t,{name:"if",hash:{},fn:e.program(7,i,0),inverse:e.program(9,i,0),data:i}))!=null?s:"")+"</span>\n</a>"},useData:!0}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-sidebar-toggle",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("photo-sidebar-toggle-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{initializer:function(t){return this.photoId=t.photoId,this.realFullscreen=!!t.realFullscreen,this.contextData=e.clone(t.context,!0),this},loadState:function(){var t=this,n=[];return n.push(this.appContext.getModel("photo-models",this.photoId).then(function(e){e&&t.set("photo",e)})),this.contextData&&this.contextData.modelName&&this.contextData.params&&n.push(this.appContext.getModel(this.contextData.modelName,this.contextData.params).then(function(e){e&&t.set("contextModel",e)}).then(null,function(){return"whatever"})),e.Promise.all(n)},getLightboxURL:function(){var t,n=this.get("photo"),r="";return this.get("contextModel")&&(r=this.get("contextModel").getValue("urlSuffix")),t=n?e.URLHelper.getPhotoPage({photoId:n.getValue("id"),pathAlias:n.getValue("owner").getValue("pathAlias"),contextSuffix:r,lightbox:!this.appContext.experiments.fullscreen.getMode()}):"#",t},buildContainer:function(){var e=this.appContext.experiments.fullscreen.getMode();return this.setContainerWithTemplate("photo-sidebar-toggle",{isRealFullscreen:e,url:this.getLightboxURL()}),this.get("container").addClass("show"),this},activate:function(){var t=this,n=this.appContext.getViewer().prefs.keyboardShortcutsEnabled;return n&&(this.attachKeyEvent("down:76",function(n){n.preventDefault(),e.rapidTracker.beacon(t.name,"lightbox"+(t.appContext.experiments.fullscreen.getMode()?"Close":"Open")+"KeyPress"),t.appContext.flapp.navigate(t.getLightboxURL())}),this.appContext.flipper.isFlipped("enable-scrappy-photo-page")&&this.attachKeyEvent("up:27",function(n){t.appContext.experiments.fullscreen.getMode()&&(n.preventDefault(),e.rapidTracker.beacon(t.name,"lightboxCloseEscKeyPress"),t.appContext.flapp.navigate(t.getLightboxURL()))})),this}})},"@VERSION@",{requires:["flickr-view","hermes-template-photo-sidebar-toggle","promise","photo-sidebar-toggle-css"],optional:[]});
